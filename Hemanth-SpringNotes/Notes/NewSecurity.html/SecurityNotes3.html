<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Spring Security Notes for Beginners and Intermediate Learners</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 20px;
        background-color: #f1f1f1;
        line-height: 1.6;
        transition: background-color 0.3s, color 0.3s;
      }
      .white-bg {
        background-color: #ffffff;
        color: #333;
      }
      .grey-bg {
        background-color: #e0e0e0;
        color: #333;
      }
      .black-bg {
        background-color: #1a1a1a;
        color: #ffffff;
      }
      .bg-switcher {
        position: fixed;
        top: 10px;
        right: 10px;
        z-index: 1000;
        font-size: 16px;
      }
      .bg-switcher label {
        margin-right: 10px;
        color: inherit;
      }
      .bg-switcher select {
        padding: 5px;
        border-radius: 5px;
        background-color: #04aa6d;
        color: white;
        border: none;
        cursor: pointer;
      }
      .bg-switcher select:focus {
        outline: 2px solid #059862;
      }
      .sidebar {
        width: 250px;
        background-color: #04aa6d;
        position: fixed;
        top: 0;
        left: 0;
        height: 100%;
        padding-top: 20px;
        color: white;
        overflow-y: auto;
      }
      .sidebar-title {
        font-size: 24px;
        text-align: center;
        margin-bottom: 30px;
      }
      .sidebar-link {
        display: block;
        padding: 12px 20px;
        color: white;
        text-decoration: none;
        font-size: 18px;
        transition: background-color 0.3s;
      }
      .sidebar-link:hover {
        background-color: #059862;
      }
      .sidebar-link:focus {
        outline: 2px solid white;
      }
      .main-content {
        margin-left: 270px;
        padding: 30px;
      }
      .header {
        background-color: #282a35;
        color: white;
        padding: 20px;
        text-align: center;
        border-radius: 8px;
        margin-bottom: 20px;
      }
      .header-title {
        font-size: 36px;
        margin: 0;
      }
      .header-subtitle {
        font-size: 18px;
        margin-top: 10px;
      }
      .section {
        margin: 20px 0;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      }
      .white-bg .section {
        background-color: #f9f9f9;
      }
      .grey-bg .section {
        background-color: #d0d0d0;
      }
      .black-bg .section {
        background-color: #2a2a2a;
      }
      .section-title {
        font-size: 28px;
        color: #04aa6d;
        margin-bottom: 15px;
      }
      .subsection-title {
        font-size: 22px;
        margin: 15px 0 10px;
        color: inherit;
      }
      table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 20px;
        background-color: #ffffff;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        overflow-x: auto;
      }
      th,
      td {
        padding: 12px 15px;
        text-align: left;
        border-bottom: 1px solid #ddd;
      }
      th {
        background-color: #04aa6d;
        color: white;
        font-weight: bold;
      }
      tr:nth-child(even) {
        background-color: #f9f9f9;
      }
      tr:hover {
        background-color: #f1f1f1;
      }
      .content-line {
        font-size: 16px;
        margin: 8px 0;
        padding: 10px;
        border-left: 4px solid #04aa6d;
      }
      .white-bg .content-line {
        background-color: #f0f0f0;
      }
      .grey-bg .content-line {
        background-color: #c0c0c0;
      }
      .black-bg .content-line {
        background-color: #333333;
      }
      .code-block {
        padding: 15px;
        border-radius: 5px;
        font-family: "Courier New", Courier, monospace;
        font-size: 18px;
        overflow-x: auto;
        margin: 10px 0;
      }
      .white-bg .code-block {
        background-color: #282a35;
        color: white;
      }
      .grey-bg .code-block {
        background-color: #3a3a3a;
        color: white;
      }
      .black-bg .code-block {
        background-color: #282a35;
        color: white;
      }
      .code-block::-webkit-scrollbar {
        height: 8px;
      }
      .code-block::-webkit-scrollbar-thumb {
        background-color: #04aa6d;
        border-radius: 4px;
      }
      .code-block::-webkit-scrollbar-track {
        background-color: #f1f1f1;
      }
      .code-block .java-keyword {
        color: #569cd6;
        font-weight: bold;
      }
      .code-block .java-type {
        color: #4ec9b0;
      }
      .code-block .java-string {
        color: #d69d85;
      }
      .code-block .java-comment {
        color: #6a9955;
        font-style: italic;
      }
      .code-block .java-annotation {
        color: #b5cea8;
      }
      .code-block .java-number {
        color: #b5cea8;
      }
      .code-block .java-method {
        color: #dcdcaa;
      }
      .code-block .java-interface {
        color: #b8d7a3;
        font-style: italic;
      }
      .code-block .java-parameter {
        color: #9cdcfe;
      }
      .code-block .java-operator {
        color: #d4d4d4;
      }
      .code-block .java-classname {
        color: #4ec9b0;
        font-weight: bold;
      }
      .code-block .java-package {
        color: #c586c0;
      }
      .code-block .java-import {
        color: #c586c0;
      }
      .code-block .java-brace {
        color: #d4d4d4;
      }
      .code-block .java-field {
        color: #9cdcfe;
      }
      .code-block .java-static {
        color: #b5cea8;
        font-style: italic;
      }
      .code-block .java-public {
        color: #569cd6;
      }
      .code-block .java-private {
        color: #569cd6;
      }
      .code-block .java-protected {
        color: #569cd6;
      }
      .code-block .java-final {
        color: #b5cea8;
      }
      .code-block .java-void {
        color: #4ec9b0;
      }
      .code-block .java-boolean {
        color: #4ec9b0;
      }
      .code-block .java-null {
        color: #b5cea8;
      }
      .code-block .java-true,
      .code-block .java-false {
        color: #b5cea8;
      }
      .image-container {
        margin: 20px 0;
        text-align: center;
      }
      .diagram {
        max-width: 100%;
        border: 1px solid #ddd;
        border-radius: 5px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      }
      .image-caption {
        font-size: 14px;
        color: inherit;
        margin-top: 5px;
      }
      .highlight {
        color: #ff4500;
        font-weight: bold;
      }
      strong {
        font-weight: bold;
      }
      @media (max-width: 768px) {
        .sidebar {
          width: 100%;
          height: auto;
          position: relative;
        }
        .main-content {
          margin-left: 0;
        }
      }
    </style>
  </head>
  <body class="white-bg">
    <div class="bg-switcher">
      <label for="bg-select">Background:</label>
      <select id="bg-select" onchange="changeBackground()">
        <option value="white-bg">White</option>
        <option value="grey-bg">Grey</option>
        <option value="black-bg">Dark</option>
      </select>
    </div>

    <div class="sidebar">
      <div class="sidebar-title">Spring Security</div>
      <a href="#section1" class="sidebar-link">1. Importance of Security</a>
      <a href="#section2" class="sidebar-link">2. OWASP Top 10</a>
      <a href="#section3" class="sidebar-link">3. Creating a Project</a>
      <a href="#section4" class="sidebar-link">4. Default Login Form</a>
      <a href="#section5" class="sidebar-link">5. Security Filters</a>
      <a href="#section6" class="sidebar-link">6. Session Management</a>
      <a href="#section7" class="sidebar-link">7. Setting Credentials</a>
      <a href="#section8" class="sidebar-link">8. Basic Authentication</a>
      <a href="#section9" class="sidebar-link">9. CSRF Protection</a>
      <a href="#section10" class="sidebar-link">10. Implementing CSRF</a>
      <a href="#section11" class="sidebar-link">11. SameSite & Stateless</a>
      <a href="#section12" class="sidebar-link">12. Custom Security</a>
      <a href="#section13" class="sidebar-link">13. Imperative Config</a>
      <a href="#section14" class="sidebar-link">14. In-Memory Users</a>
      <a href="#section15" class="sidebar-link">15. Database Auth</a>
      <a href="#section16" class="sidebar-link">16. User Registration</a>
      <a href="#section17" class="sidebar-link">17. Best Practices</a>
    </div>

    <div class="main-content">
      <div class="header">
        <h1 class="header-title">Spring Security Notes</h1>
        <p class="header-subtitle">For Beginners and Intermediate Learners</p>
      </div>

      <div id="section1" class="section">
        <h2 class="section-title">
          1. Importance of Security in Application Development
        </h2>
        <div class="subsection-title">Concept Overview</div>
        <p class="content-line">
          Security in application development is like locking the doors of your
          house to keep intruders out. Developers often focus on making an app
          work (functionality), run smoothly (stability), and load quickly
          (performance), but security is equally critical. It ensures only
          authorized users access specific features and protects sensitive
          data—like usernames, passwords, or credit card details—from hackers.
          For example, in a job portal, anyone can search jobs, but only admins
          should post them. Without security, a hacker could post fake jobs,
          causing chaos. Apps handling sensitive data (e.g., medical or banking
          apps) need strong security to avoid legal issues, financial losses, or
          reputational damage. Authentication (verifying who you are) and
          authorization (deciding what you can do) are the core pillars,
          ensuring only the right people access the right resources.
        </p>
        <div class="subsection-title">Key Points</div>
        <ul class="content-line">
          <li>
            <strong>Functionality:</strong> Makes the app work (e.g., job search
            in a portal).
          </li>
          <li>
            <strong>Stability:</strong> Handles errors gracefully (e.g., invalid
            inputs don’t crash the app).
          </li>
          <li>
            <strong>Performance:</strong> Ensures fast responses (e.g., quick
            job search results).
          </li>
          <li>
            <strong>Security:</strong> Protects data and restricts access (e.g.,
            only admins post jobs).
          </li>
          <li>
            <strong>Authentication:</strong> Verifies identity (e.g.,
            username/password login).
          </li>
          <li>
            <strong>Authorization:</strong> Controls permissions (e.g., admins
            can delete jobs, users cannot).
          </li>
          <li>
            <strong>Data Sensitivity:</strong> Apps with sensitive data (e.g.,
            medical records) need robust security to avoid penalties.
          </li>
        </ul>
        <div class="subsection-title">Example</div>
        <p class="content-line">
          In a job portal, anyone can view job listings, but only authenticated
          admins should create or delete jobs. Without security, a hacker could
          access the admin panel and post fraudulent jobs, misleading users.
          Spring Security ensures only verified admins with correct credentials
          can perform these actions.
        </p>
        <div class="subsection-title">Live Example</div>
        <p class="content-line">
          Without security, accessing
          <span class="highlight">localhost:8080/admin/createJob</span> allows
          anyone to post a job, which is dangerous. After adding Spring
          Security, this URL requires admin login, ensuring only authorized
          users can access it, protecting the portal from unauthorized actions.
        </p>
      </div>

      <div id="section2" class="section">
        <h2 class="section-title">2. OWASP Top 10 Security Risks</h2>
        <div class="subsection-title">Concept Overview</div>
        <p class="content-line">
          The OWASP Top 10 is like a “most wanted” list of the top security
          threats to web applications, published by the Open Web Application
          Security Project (OWASP). Think of it as a guide to the most common
          ways hackers break into apps, updated every four years (last in 2021).
          For beginners, understanding these risks is like learning the weak
          spots in a fortress—knowing them helps you strengthen your app. For
          example, broken access control is like leaving the back door unlocked,
          letting anyone sneak in. Spring Security addresses many of these risks
          with tools for secure authentication, authorization, and data
          protection, making it easier to build safe apps.
        </p>
        <div class="subsection-title">Key OWASP Top 10 Risks</div>
        <table>
          <tr>
            <th>Risk</th>
            <th>Description</th>
          </tr>
          <tr>
            <td>Broken Access Control</td>
            <td>
              Users access restricted resources (e.g., a user deleting
              admin-only data).
            </td>
          </tr>
          <tr>
            <td>Cryptographic Failures</td>
            <td>
              Weak encryption exposes data (e.g., storing passwords as plain
              text).
            </td>
          </tr>
          <tr>
            <td>Injection</td>
            <td>
              Malicious code is inserted into inputs (e.g., SQL injection to
              bypass login).
            </td>
          </tr>
          <tr>
            <td>Insecure Design</td>
            <td>Flawed app design creates vulnerabilities.</td>
          </tr>
          <tr>
            <td>Security Misconfiguration</td>
            <td>
              Default settings expose weaknesses (e.g., unchanged admin
              passwords).
            </td>
          </tr>
          <tr>
            <td>Vulnerable and Outdated Components</td>
            <td>Old libraries with known issues.</td>
          </tr>
          <tr>
            <td>Identification and Authentication Failures</td>
            <td>Weak passwords or no multi-factor authentication.</td>
          </tr>
          <tr>
            <td>Software and Data Integrity Failures</td>
            <td>Unverified data compromises the app.</td>
          </tr>
          <tr>
            <td>Security Logging and Monitoring Failures</td>
            <td>Missing logs to detect attacks.</td>
          </tr>
          <tr>
            <td>Server-Side Request Forgery (SSRF)</td>
            <td>Server makes unauthorized requests.</td>
          </tr>
        </table>
        <div class="subsection-title">Example</div>
        <p class="content-line">
          In a job portal, a SQL injection attack could let a hacker bypass
          login by entering <span class="highlight">admin' OR '1'='1</span> as a
          username, tricking the database into granting access. Spring
          Security’s prepared statements prevent this by treating inputs as
          data, not executable code.
        </p>
        <div class="subsection-title">Live Example</div>
        <p class="content-line">
          Without security, a login form accepting
          <span class="highlight">admin' OR '1'='1</span> grants unauthorized
          access. With Spring Security, such inputs are sanitized, and the login
          fails, protecting the system from injection attacks.
        </p>
      </div>

      <div id="section3" class="section">
        <h2 class="section-title">3. Creating a Spring Security Project</h2>
        <div class="subsection-title">Concept Overview</div>
        <p class="content-line">
          Creating a Spring Security project is like installing a security
          system in your house. Spring Security is a framework that adds locks
          (authentication) and access rules (authorization) to your Spring-based
          app. By adding the Spring Security dependency, your app gets a default
          login page that protects all URLs, like a guard at the entrance. For
          beginners, this is exciting because minimal setup provides strong
          security. Intermediate learners can customize this setup to meet
          specific needs, such as allowing public access to certain pages. The
          process involves setting up a Spring Boot project, adding
          dependencies, and creating a controller to test security.
        </p>
        <div class="subsection-title">Steps to Create a Project</div>
        <ol class="content-line">
          <li>
            Go to
            <a href="https://start.spring.io">Spring Initializr</a>
            (start.spring.io).
          </li>
          <li>
            Select Maven, Java 21, and add dependencies: Spring Web, Spring
            Security, Spring Boot DevTools.
          </li>
          <li>
            Set group ID <span class="highlight">com.co</span>, artifact ID
            <span class="highlight">spring-seq-demo</span>.
          </li>
          <li>Generate, unzip, and open in an IDE (e.g., IntelliJ IDEA).</li>
          <li>Create a REST controller to test endpoints.</li>
        </ol>
        <div class="subsection-title">Code Example: HelloController</div>
        <div class="code-block">
          <span class="java-package">package</span>
          <span class="java-classname">com.co</span>;
          <span class="java-comment"
            >// Defines the package for the controller class</span
          ><br />
          <br />
          <span class="java-import">import</span>
          <span class="java-classname"
            >org.springframework.web.bind.annotation.GetMapping</span
          >;
          <span class="java-comment"
            >// Imports annotation for mapping GET requests</span
          ><br />
          <span class="java-import">import</span>
          <span class="java-classname"
            >org.springframework.web.bind.annotation.RestController</span
          >;
          <span class="java-comment"
            >// Imports annotation for REST controller</span
          ><br />
          <br />
          <span class="java-annotation">@RestController</span>
          <span class="java-comment"
            >// Marks the class as a REST controller, returning JSON/text
            responses</span
          ><br />
          <span class="java-public">public</span>
          <span class="java-keyword">class</span>
          <span class="java-classname">HelloController</span> {
          <span class="java-comment">// Defines the controller class</span
          ><br />
          <br />
          <span class="java-comment"
            >// Maps GET request to /hello, returns "Hello World"</span
          ><br />
          <span class="java-annotation">@GetMapping</span>(<span
            class="java-string"
            >"/hello"</span
          >)
          <span class="java-comment"
            >// Maps HTTP GET requests to /hello URL</span
          ><br />
          <span class="java-public">public</span>
          <span class="java-type">String</span>
          <span class="java-method">greet</span>() {
          <span class="java-comment">// Method to handle /hello requests</span
          ><br />
          <span class="java-keyword">return</span>
          <span class="java-string">"Hello World"</span>;
          <span class="java-comment"
            >// Returns "Hello World" as the response</span
          ><br />
          }<br />
          <br />
          <span class="java-comment"
            >// Maps GET request to /about, returns "Telusko"</span
          ><br />
          <span class="java-annotation">@GetMapping</span>(<span
            class="java-string"
            >"/about"</span
          >)
          <span class="java-comment"
            >// Maps HTTP GET requests to /about URL</span
          ><br />
          <span class="java-public">public</span>
          <span class="java-type">String</span>
          <span class="java-method">about</span>() {
          <span class="java-comment">// Method to handle /about requests</span
          ><br />
          <span class="java-keyword">return</span>
          <span class="java-string">"Telusko"</span>;
          <span class="java-comment">// Returns "Telusko" as the response</span
          ><br />
          }<br />
          }
        </div>
        <div class="subsection-title">Explanation</div>
        <ul class="content-line">
          <li>
            The controller defines two endpoints:
            <span class="highlight">/hello</span> and
            <span class="highlight">/about</span>, returning simple text
            responses.
          </li>
          <li>Without Spring Security, anyone can access these URLs.</li>
          <li>
            Adding
            <span class="highlight">spring-boot-starter-security</span> enables
            a default login form, requiring authentication for all endpoints.
          </li>
        </ul>
        <div class="subsection-title">Live Example</div>
        <p class="content-line">
          Before Spring Security,
          <span class="highlight">localhost:8080/hello</span> shows "Hello
          World". After adding the dependency, the URL displays a login form
          with default credentials (username:
          <span class="highlight">user</span>, password in console). This shows
          how Spring Security instantly secures the app with minimal setup.
        </p>
      </div>

      <div id="section4" class="section">
        <h2 class="section-title">4. Default Login Form in Spring Security</h2>
        <div class="subsection-title">Concept Overview</div>
        <p class="content-line">
          Spring Security’s default login form is like a pre-installed
          gatekeeper for your app. When you add the Spring Security dependency,
          it automatically protects all URLs with a login page, no coding
          required. Think of it as a temporary password lock on your phone—you
          can use it right away but will customize it later. The default
          username is <span class="highlight">user</span>, and a random password
          is generated each time the app starts, shown in the console. This form
          supports logout and session management, making it beginner-friendly
          yet powerful for securing apps.
        </p>
        <div class="subsection-title">Key Features</div>
        <ul class="content-line">
          <li>
            <strong>Default Credentials:</strong> Username
            <span class="highlight">user</span>, password in console.
          </li>
          <li>
            <strong>Session Management:</strong> A session ID is created after
            login, allowing access to multiple URLs without re-entering
            credentials.
          </li>
          <li>
            <strong>Logout:</strong> A
            <span class="highlight">/logout</span> URL logs out the user, ending
            the session.
          </li>
        </ul>
        <div class="subsection-title">Live Example</div>
        <p class="content-line">
          After adding Spring Security, accessing
          <span class="highlight">localhost:8080/hello</span> shows a login
          form. Entering <span class="highlight">user</span> and the console
          password (e.g., <span class="highlight">a1b2c3</span>) grants access
          to "Hello World". Incorrect credentials show a “Bad Credentials”
          error. Accessing
          <span class="highlight">localhost:8080/logout</span> logs out the
          user, requiring login again, demonstrating the default form’s
          functionality.
        </p>
      </div>

      <div id="section5" class="section">
        <h2 class="section-title">5. Spring Security Filters</h2>
        <div class="subsection-title">Concept Overview</div>
        <p class="content-line">
          Spring Security filters are like checkpoints at an airport. Each
          filter checks something about an incoming request (e.g., is the user
          logged in? Is the request safe?) before passing it to your app’s code.
          These filters form a filter chain, applied automatically by Spring
          Security. For beginners, think of filters as security guards checking
          your ID, ticket, and bags in sequence. Intermediate learners can
          customize the filter chain to control request processing, such as
          enabling CSRF protection or handling logout.
        </p>
        <div class="subsection-title">Key Filters</div>
        <ul class="content-line">
          <li>
            <strong>SecurityContextPersistenceFilter:</strong> Stores user
            details between requests.
          </li>
          <li>
            <strong>UsernamePasswordAuthenticationFilter:</strong> Checks
            username/password for login.
          </li>
          <li>
            <strong>CsrfFilter:</strong> Ensures POST requests include a CSRF
            token.
          </li>
          <li><strong>LogoutFilter:</strong> Handles logout requests.</li>
        </ul>
        <div class="subsection-title">Live Example</div>
        <p class="content-line">
          When the app starts, the console logs the filter chain, including
          <span class="highlight">CsrfFilter</span> and
          <span class="highlight">UsernamePasswordAuthenticationFilter</span>.
          Accessing <span class="highlight">localhost:8080/hello</span> triggers
          these filters, which check for authentication and redirect to the
          login page if needed. A POST request without a CSRF token fails,
          showing the <span class="highlight">CsrfFilter</span> in action.
        </p>
      </div>

      <div id="section6" class="section">
        <h2 class="section-title">6. Session Management and Session ID</h2>
        <div class="subsection-title">Concept Overview</div>
        <p class="content-line">
          A session in Spring Security is like a temporary visitor pass at a
          building. After logging in, the server gives your browser a unique
          session ID (stored in a cookie), acting as proof you’re authorized.
          You show this pass for each request, so you don’t need to log in
          repeatedly. For beginners, think of it as a wristband at a
          concert—once you’re in, you can move around until you leave.
          Intermediate learners should note that sessions improve performance
          but require careful management to prevent risks like session
          hijacking.
        </p>
        <div class="subsection-title">Code Example: Printing Session ID</div>
        <div class="code-block">
          <span class="java-package">package</span>
          <span class="java-classname">com.co</span>;
          <span class="java-comment"
            >// Defines the package for the controller class</span
          ><br />
          <br />
          <span class="java-import">import</span>
          <span class="java-classname"
            >jakarta.servlet.http.HttpServletRequest</span
          >;
          <span class="java-comment"
            >// Imports class for accessing request details</span
          ><br />
          <span class="java-import">import</span>
          <span class="java-classname"
            >org.springframework.web.bind.annotation.GetMapping</span
          >;
          <span class="java-comment"
            >// Imports annotation for mapping GET requests</span
          ><br />
          <span class="java-import">import</span>
          <span class="java-classname"
            >org.springframework.web.bind.annotation.RestController</span
          >;
          <span class="java-comment"
            >// Imports annotation for REST controller</span
          ><br />
          <br />
          <span class="java-annotation">@RestController</span>
          <span class="java-comment"
            >// Marks the class as a REST controller, returning JSON/text
            responses</span
          ><br />
          <span class="java-public">public</span>
          <span class="java-keyword">class</span>
          <span class="java-classname">HelloController</span> {
          <span class="java-comment">// Defines the controller class</span
          ><br />
          <br />
          <span class="java-comment"
            >// Maps GET request to /hello, returns "Hello World" with session
            ID</span
          ><br />
          <span class="java-annotation">@GetMapping</span>(<span
            class="java-string"
            >"/hello"</span
          >)
          <span class="java-comment"
            >// Maps HTTP GET requests to /hello URL</span
          ><br />
          <span class="java-public">public</span>
          <span class="java-type">String</span>
          <span class="java-method">greet</span>(<span class="java-type"
            >HttpServletRequest</span
          >
          <span class="java-parameter">request</span>) {
          <span class="java-comment"
            >// Method to handle /hello, takes request object</span
          ><br />
          <span class="java-keyword">return</span>
          <span class="java-string">"Hello World "</span> +
          <span class="java-parameter">request</span>.<span class="java-method"
            >getSession</span
          >().<span class="java-method">getId</span>();
          <span class="java-comment"
            >// Returns "Hello World" plus session ID</span
          ><br />
          }<br />
          <br />
          <span class="java-comment"
            >// Maps GET request to /about, returns "Telusko" with session
            ID</span
          ><br />
          <span class="java-annotation">@GetMapping</span>(<span
            class="java-string"
            >"/about"</span
          >)
          <span class="java-comment"
            >// Maps HTTP GET requests to /about URL</span
          ><br />
          <span class="java-public">public</span>
          <span class="java-type">String</span>
          <span class="java-method">about</span>(<span class="java-type"
            >HttpServletRequest</span
          >
          <span class="java-parameter">request</span>) {
          <span class="java-comment"
            >// Method to handle /about, takes request object</span
          ><br />
          <span class="java-keyword">return</span>
          <span class="java-string">"Telusko "</span> +
          <span class="java-parameter">request</span>.<span class="java-method"
            >getSession</span
          >().<span class="java-method">getId</span>();
          <span class="java-comment">// Returns "Telusko" plus session ID</span
          ><br />
          }<br />
          }
        </div>
        <div class="subsection-title">Explanation</div>
        <ul class="content-line">
          <li>
            The controller appends the session ID to responses to demonstrate
            session persistence.
          </li>
          <li>
            <span class="highlight">HttpServletRequest</span> provides access to
            the session via <span class="highlight">getSession().getId()</span>.
          </li>
          <li>
            The same session ID appears for
            <span class="highlight">/hello</span> and
            <span class="highlight">/about</span> until logout, showing session
            continuity.
          </li>
        </ul>
        <div class="subsection-title">Live Example</div>
        <p class="content-line">
          After logging in,
          <span class="highlight">localhost:8080/hello</span> shows “Hello World
          <span class="highlight">1234</span>” (where
          <span class="highlight">1234</span> is the session ID). Accessing
          <span class="highlight">localhost:8080/about</span> shows “Telusko
          <span class="highlight">1234</span>”, confirming the same session.
          Logging out via <span class="highlight">/logout</span> and logging in
          again generates a new session ID (e.g.,
          <span class="highlight">5678</span>), demonstrating session
          management.
        </p>
      </div>

      <div id="section7" class="section">
        <h2 class="section-title">7. Setting Username and Password</h2>
        <div class="subsection-title">Concept Overview</div>
        <p class="content-line">
          The default <span class="highlight">user</span> and random password
          are like a temporary key to your app, useful for testing but
          impractical for real use. Spring Security lets you set a custom
          username and password in the
          <span class="highlight">application.properties</span> file, like
          changing the default lock on a new house. This is a simple way to
          secure your app, but it’s limited to one user and stores passwords in
          plain text, which is unsafe for production. Beginners can think of
          this as a basic lock; intermediate learners should recognize the need
          for secure storage (e.g., Bcrypt) and multiple users.
        </p>
        <div class="subsection-title">Code Example: application.properties</div>
        <div class="code-block">
          <span class="java-comment"
            ># Configures custom username and password</span
          ><br />
          <span class="java-field">spring.security.user.name</span>=<span
            class="java-string"
            >telusko</span
          >
          <span class="java-comment"># Sets the username to telusko</span><br />
          <span class="java-field">spring.security.user.password</span>=<span
            class="java-string"
            >1234</span
          >
          <span class="java-comment"># Sets the password to 1234</span>
        </div>
        <div class="subsection-title">Explanation</div>
        <ul class="content-line">
          <li>
            The properties override the default
            <span class="highlight">user</span> and console-generated password.
          </li>
          <li>
            This approach is simple but limited to a single user and insecure
            due to plain-text storage.
          </li>
        </ul>
        <div class="subsection-title">Live Example</div>
        <p class="content-line">
          After adding these properties,
          <span class="highlight">localhost:8080/hello</span> prompts a login
          form. Entering <span class="highlight">telusko</span> and
          <span class="highlight">1234</span> grants access to “Hello World”.
          The default <span class="highlight">user</span> and console password
          no longer work, showing the new credentials are active. However,
          hardcoding one user limits scalability.
        </p>
        <div class="subsection-title">Drawbacks</div>
        <ul class="content-line">
          <li>Hardcoding credentials restricts the app to one user.</li>
          <li>
            Plain-text passwords are insecure and unsuitable for production.
          </li>
        </ul>
      </div>

      <div id="section8" class="section">
        <h2 class="section-title">8. Basic Authentication Using Postman</h2>
        <div class="subsection-title">Concept Overview</div>
        <p class="content-line">
          Basic Authentication is like showing an ID card to access a restricted
          area. Instead of a login form, the client (e.g., Postman or a mobile
          app) sends a username and password in the request’s Authorization
          header. For beginners, think of it as a secret handshake to enter a
          club. It’s ideal for REST APIs where a form isn’t practical, but
          passwords are sent in plain text, so HTTPS is needed for security.
          Intermediate learners should note that Spring Security supports Basic
          Auth automatically, making it easy to test APIs.
        </p>
        <div class="subsection-title">Live Example</div>
        <p class="content-line">
          In Postman, a GET request to
          <span class="highlight">localhost:8080/hello</span> without
          credentials returns a
          <span class="highlight">401 Unauthorized</span> error. Under the
          Authorization tab, selecting Basic Auth and entering
          <span class="highlight">telusko</span> and
          <span class="highlight">1234</span> results in a
          <span class="highlight">200 OK</span> response with “Hello World”. The
          same credentials work for <span class="highlight">/about</span>,
          showing session reuse, demonstrating Basic Auth’s simplicity for API
          testing.
        </p>
      </div>

      <div id="section9" class="section">
        <h2 class="section-title">9. Cross-Site Request Forgery (CSRF)</h2>
        <div class="subsection-title">Concept Overview</div>
        <p class="content-line">
          CSRF (Cross-Site Request Forgery) is like a prankster tricking you
          into doing something unintended. Imagine you’re logged into your
          bank’s website, and a malicious site you visit secretly sends a
          request to transfer money using your session cookie. CSRF attacks
          exploit the trust a site has in your browser. Spring Security prevents
          this by requiring a CSRF token for non-GET requests (e.g., POST, PUT),
          like a secret code only the real site knows. For beginners, think of
          the token as a special ticket you must show for sensitive actions.
          Intermediate learners should note that CSRF protection is enabled by
          default for POST requests, ensuring security without extra effort.
        </p>
        <div class="subsection-title">Key Points</div>
        <ul class="content-line">
          <li>
            <strong>CSRF Token:</strong> A unique code sent with POST, PUT,
            DELETE requests.
          </li>
          <li>
            <strong>Default Protection:</strong> Enabled for non-GET requests,
            not GET.
          </li>
          <li>
            <strong>Mitigation:</strong> Use CSRF tokens or set cookies to
            <span class="highlight">SameSite=Strict</span>.
          </li>
        </ul>
        <div class="subsection-title">Live Example</div>
        <p class="content-line">
          A POST request to <span class="highlight">/students</span> in Postman
          without a CSRF token fails with a
          <span class="highlight">401</span> error, as Spring Security’s
          <span class="highlight">CsrfFilter</span> blocks it. After fetching
          the token from <span class="highlight">/csrf-token</span> and
          including it in the header, the request succeeds, adding a student,
          showing how CSRF protection safeguards sensitive actions.
        </p>
      </div>

      <div id="section10" class="section">
        <h2 class="section-title">10. Implementing CSRF Protection</h2>
        <div class="subsection-title">Concept Overview</div>
        <p class="content-line">
          Implementing CSRF protection is like adding a security code to your
          credit card transactions. Spring Security generates a CSRF token for
          each session, which must be included in non-GET requests. You can
          create an endpoint to fetch this token, which clients (e.g., a web
          app) include in their requests. Alternatively, setting cookies to
          <span class="highlight">SameSite=Strict</span> is like telling your
          browser to only send cookies to the original site, blocking malicious
          sites. Beginners can think of this as a double-check to ensure
          requests come from the right place; intermediate learners should
          appreciate the balance between security and usability.
        </p>
        <div class="subsection-title">Code Example: StudentController</div>
        <div class="code-block">
          <span class="java-package">package</span>
          <span class="java-classname">com.co</span>;
          <span class="java-comment"
            >// Defines the package for the controller class</span
          ><br />
          <br />
          <span class="java-import">import</span>
          <span class="java-classname">lombok.Data</span>;
          <span class="java-comment"
            >// Imports Lombok’s Data annotation for auto-generating
            getters/setters</span
          ><br />
          <span class="java-import">import</span>
          <span class="java-classname"
            >org.springframework.web.bind.annotation.*</span
          >;
          <span class="java-comment"
            >// Imports annotations for REST endpoints</span
          ><br />
          <span class="java-import">import</span>
          <span class="java-classname">java.util.ArrayList</span>;
          <span class="java-comment"
            >// Imports ArrayList for storing students</span
          ><br />
          <span class="java-import">import</span>
          <span class="java-classname">java.util.List</span>;
          <span class="java-comment"
            >// Imports List interface for student collection</span
          ><br />
          <br />
          <span class="java-annotation">@RestController</span>
          <span class="java-comment"
            >// Marks the class as a REST controller, returning JSON/text
            responses</span
          ><br />
          <span class="java-public">public</span>
          <span class="java-keyword">class</span>
          <span class="java-classname">StudentController</span> {
          <span class="java-comment">// Defines the controller class</span
          ><br />
          <br />
          <span class="java-comment">// Static list to store students</span
          ><br />
          <span class="java-private">private</span>
          <span class="java-static">static</span>
          <span class="java-keyword">final</span>
          <span class="java-type">List</span>&lt;<span class="java-classname"
            >Student</span
          >&gt; <span class="java-field">students</span> =
          <span class="java-keyword">new</span>
          <span class="java-classname">ArrayList</span>&lt;&gt;(<span
            class="java-classname"
            >List</span
          >.<span class="java-method">of</span>(
          <span class="java-comment"
            >// Initializes a static list with initial students</span
          ><br />
          <span class="java-keyword">new</span>
          <span class="java-classname">Student</span>(<span class="java-number"
            >1</span
          >, <span class="java-string">"Naveen"</span>,
          <span class="java-string">"Java"</span>),
          <span class="java-comment"
            >// Adds student with ID 1, name Naveen, technology Java</span
          ><br />
          <span class="java-keyword">new</span>
          <span class="java-classname">Student</span>(<span class="java-number"
            >2</span
          >, <span class="java-string">"Kiran"</span>,
          <span class="java-string">"Blockchain"</span>)
          <span class="java-comment"
            >// Adds student with ID 2, name Kiran, technology Blockchain</span
          ><br />
          )));<br />
          <br />
          <span class="java-comment"
            >// Maps GET request to /students, returns all students</span
          ><br />
          <span class="java-annotation">@GetMapping</span>(<span
            class="java-string"
            >"/students"</span
          >)
          <span class="java-comment"
            >// Maps HTTP GET requests to /students URL</span
          ><br />
          <span class="java-public">public</span>
          <span class="java-type">List</span>&lt;<span class="java-classname"
            >Student</span
          >&gt; <span class="java-method">getStudents</span>() {
          <span class="java-comment"
            >// Method to handle /students GET requests</span
          ><br />
          <span class="java-keyword">return</span>
          <span class="java-field">students</span>;
          <span class="java-comment">// Returns the list of students</span
          ><br />
          }<br />
          <br />
          <span class="java-comment"
            >// Maps POST request to /students, adds a new student</span
          ><br />
          <span class="java-annotation">@PostMapping</span>(<span
            class="java-string"
            >"/students"</span
          >)
          <span class="java-comment"
            >// Maps HTTP POST requests to /students URL</span
          ><br />
          <span class="java-public">public</span>
          <span class="java-void">void</span>
          <span class="java-method">addStudent</span>(<span
            class="java-annotation"
            >@RequestBody</span
          >
          <span class="java-classname">Student</span>
          <span class="java-parameter">student</span>) {
          <span class="java-comment"
            >// Method to handle /students POST, accepts student JSON</span
          ><br />
          <span class="java-field">students</span>.<span class="java-method"
            >add</span
          >(<span class="java-parameter">student</span>);
          <span class="java-comment">// Adds the new student to the list</span
          ><br />
          }<br />
          <br />
          <span class="java-comment"
            >// Maps GET request to /csrf-token, returns CSRF token</span
          ><br />
          <span class="java-annotation">@GetMapping</span>(<span
            class="java-string"
            >"/csrf-token"</span
          >)
          <span class="java-comment"
            >// Maps HTTP GET requests to /csrf-token URL</span
          ><br />
          <span class="java-public">public</span>
          <span class="java-classname">CsrfToken</span>
          <span class="java-method">getCsrfToken</span>(<span
            class="java-classname"
            >HttpServletRequest</span
          >
          <span class="java-parameter">request</span>) {
          <span class="java-comment"
            >// Method to handle /csrf-token, takes request object</span
          ><br />
          <span class="java-keyword">return</span> (<span class="java-classname"
            >CsrfToken</span
          >) <span class="java-parameter">request</span>.<span
            class="java-method"
            >getAttribute</span
          >(<span class="java-string">"_csrf"</span>);
          <span class="java-comment"
            >// Returns the CSRF token from request attributes</span
          ><br />
          }<br />
          }<br />
          <br />
          <span class="java-comment"
            >// Student model class using Lombok for getters, setters, and
            constructors</span
          ><br />
          <span class="java-annotation">@Data</span>
          <span class="java-comment"
            >// Lombok annotation to auto-generate getters, setters, toString,
            etc.</span
          ><br />
          <span class="java-public">public</span>
          <span class="java-keyword">class</span>
          <span class="java-classname">Student</span> {
          <span class="java-comment">// Defines the Student class</span><br />
          <span class="java-private">private</span>
          <span class="java-type">int</span> <span class="java-field">id</span>;
          <span class="java-comment">// Field for student ID</span><br />
          <span class="java-private">private</span>
          <span class="java-type">String</span>
          <span class="java-field">name</span>;
          <span class="java-comment">// Field for student name</span><br />
          <span class="java-private">private</span>
          <span class="java-type">String</span>
          <span class="java-field">technology</span>;
          <span class="java-comment">// Field for student’s technology</span
          ><br />
          <br />
          <span class="java-public">public</span>
          <span class="java-classname">Student</span>(<span class="java-type"
            >int</span
          >
          <span class="java-parameter">id</span>,
          <span class="java-type">String</span>
          <span class="java-parameter">name</span>,
          <span class="java-type">String</span>
          <span class="java-parameter">technology</span>) {
          <span class="java-comment"
            >// Constructor for initializing student objects</span
          ><br />
          <span class="java-keyword">this</span>.<span class="java-field"
            >id</span
          >
          = <span class="java-parameter">id</span>;
          <span class="java-comment">// Sets the ID field</span><br />
          <span class="java-keyword">this</span>.<span class="java-field"
            >name</span
          >
          = <span class="java-parameter">name</span>;
          <span class="java-comment">// Sets the name field</span><br />
          <span class="java-keyword">this</span>.<span class="java-field"
            >technology</span
          >
          = <span class="java-parameter">technology</span>;
          <span class="java-comment">// Sets the technology field</span><br />
          }<br />
          }
        </div>
        <div class="subsection-title">Explanation</div>
        <ul class="content-line">
          <li>
            The controller manages a list of students, with endpoints to
            retrieve (GET <span class="highlight">/students</span>), add (POST
            <span class="highlight">/students</span>), and fetch CSRF tokens
            (GET <span class="highlight">/csrf-token</span>).
          </li>
          <li>
            The <span class="highlight">Student</span> class uses Lombok’s
            <span class="highlight">@Data</span> to reduce boilerplate code.
          </li>
          <li>
            The POST <span class="highlight">/students</span> endpoint requires
            a CSRF token, enforced by Spring Security.
          </li>
        </ul>
        <div class="subsection-title">Live Example</div>
        <p class="content-line">
          In Postman, a POST to <span class="highlight">/students</span> without
          a CSRF token fails (<span class="highlight">401</span>). Sending a GET
          to <span class="highlight">/csrf-token</span> returns a token (e.g.,
          <span class="highlight">abc123</span>), which is added to the POST
          request’s <span class="highlight">X-CSRF-TOKEN</span> header. The
          request succeeds, adding a student (e.g.,
          <span class="highlight"
            >{id: 3, name: "Avni", technology: "Python"}</span
          >), showing how CSRF tokens protect POST requests.
        </p>
      </div>

      <div id="section11" class="section">
        <h2 class="section-title">11. SameSite Strict and Stateless APIs</h2>
        <div class="subsection-title">Concept Overview</div>
        <p class="content-line">
          The <span class="highlight">SameSite</span> cookie attribute is like a
          rule telling your browser which websites can use your session cookie.
          Setting it to <span class="highlight">Strict</span> ensures only the
          original site (e.g., your app) can send the cookie, preventing CSRF
          attacks from other sites. For stateless APIs, each request is like a
          one-time visitor showing their ID—no session is saved, so CSRF tokens
          aren’t needed. Beginners can imagine stateless APIs as a ticket booth
          where you buy a new ticket for each ride; intermediate learners should
          note that statelessness simplifies scaling but requires credentials in
          every request.
        </p>
        <div class="subsection-title">Code Example: application.properties</div>
        <div class="code-block">
          <span class="java-comment"># Restricts cookies to the same site</span
          ><br />
          <span class="java-field">server.servlet.session.cookie.same-site</span
          >=<span class="java-string">strict</span>
          <span class="java-comment"
            ># Sets SameSite attribute to Strict for session cookies</span
          >
        </div>
        <div class="subsection-title">Explanation</div>
        <ul class="content-line">
          <li>
            The property sets the
            <span class="highlight">SameSite</span> attribute to
            <span class="highlight">Strict</span>, blocking cross-site cookie
            access.
          </li>
          <li>
            This mitigates CSRF attacks by ensuring cookies are only sent to the
            originating site.
          </li>
        </ul>
        <div class="subsection-title">Live Example</div>
        <p class="content-line">
          With <span class="highlight">SameSite=Strict</span>, a malicious site
          can’t use your app’s session cookie, blocking CSRF attacks. For a
          stateless API, a POST to <span class="highlight">/students</span> in
          Postman with Basic Auth (<span class="highlight">telusko</span>,
          <span class="highlight">1234</span>) succeeds without a CSRF token, as
          no session is maintained, showing how stateless APIs simplify security
          for REST clients.
        </p>
      </div>

      <div id="section12" class="section">
        <h2 class="section-title">12. Custom Security Configuration</h2>
        <div class="subsection-title">Concept Overview</div>
        <p class="content-line">
          Customizing Spring Security is like designing your own security system
          instead of using the default one. By creating a configuration class,
          you can control authentication, authorization, and session behavior.
          For beginners, think of it as setting rules for who can enter your
          house and what they can do. You might disable CSRF for APIs, enable
          form login for web apps, or make the app stateless. Intermediate
          learners can fine-tune security, such as allowing public access to
          certain URLs or requiring specific roles.
        </p>
        <div class="subsection-title">
          Code Example: SecurityConfig (Lambda Style)
        </div>
        <div class="code-block">
          <span class="java-package">package</span>
          <span class="java-classname">com.co.config</span>;
          <span class="java-comment"
            >// Defines the package for the configuration class</span
          ><br />
          <br />
          <span class="java-import">import</span>
          <span class="java-classname"
            >org.springframework.context.annotation.Bean</span
          >;
          <span class="java-comment"
            >// Imports annotation for defining Spring beans</span
          ><br />
          <span class="java-import">import</span>
          <span class="java-classname"
            >org.springframework.context.annotation.Configuration</span
          >;
          <span class="java-comment"
            >// Imports annotation for configuration classes</span
          ><br />
          <span class="java-import">import</span>
          <span class="java-classname"
            >org.springframework.security.config.annotation.web.configuration.EnableWebSecurity</span
          >;
          <span class="java-comment"
            >// Imports annotation to enable security</span
          ><br />
          <span class="java-import">import</span>
          <span class="java-classname"
            >org.springframework.security.config.http.SessionCreationPolicy</span
          >;
          <span class="java-comment">// Imports enum for session policies</span
          ><br />
          <span class="java-import">import</span>
          <span class="java-classname"
            >org.springframework.security.web.SecurityFilterChain</span
          >;
          <span class="java-comment"
            >// Imports class for defining filter chain</span
          ><br />
          <span class="java-import">import static</span>
          <span class="java-classname"
            >org.springframework.security.config.Customizer.withDefaults</span
          >;
          <span class="java-comment"
            >// Imports static method for default configurations</span
          ><br />
          <br />
          <span class="java-annotation">@Configuration</span>
          <span class="java-comment"
            >// Marks the class as a Spring configuration class</span
          ><br />
          <span class="java-annotation">@EnableWebSecurity</span>
          <span class="java-comment"
            >// Enables Spring Security customization</span
          ><br />
          <span class="java-public">public</span>
          <span class="java-keyword">class</span>
          <span class="java-classname">SecurityConfig</span> {
          <span class="java-comment"
            >// Defines the security configuration class</span
          ><br />
          <br />
          <span class="java-comment"
            >// Defines custom security configuration</span
          ><br />
          <span class="java-annotation">@Bean</span>
          <span class="java-comment"
            >// Marks the method as a bean producer</span
          ><br />
          <span class="java-public">public</span>
          <span class="java-classname">SecurityFilterChain</span>
          <span class="java-method">securityFilterChain</span>(<span
            class="java-classname"
            >HttpSecurity</span
          >
          <span class="java-parameter">http</span>)
          <span class="java-keyword">throws</span>
          <span class="java-classname">Exception</span> {
          <span class="java-comment"
            >// Method to configure security filter chain</span
          ><br />
          <span class="java-parameter">http</span>
          <span class="java-comment"
            >// Starts configuring the HttpSecurity object</span
          ><br />
          .<span class="java-method">csrf</span>(<span class="java-parameter"
            >csrf</span
          >
          -> <span class="java-parameter">csrf</span>.<span class="java-method"
            >disable</span
          >())
          <span class="java-comment"
            >// Disables CSRF protection for stateless APIs</span
          ><br />
          .<span class="java-method">authorizeHttpRequests</span>(<span
            class="java-parameter"
            >auth</span
          >
          -> <span class="java-parameter">auth</span>.<span class="java-method"
            >anyRequest</span
          >().<span class="java-method">authenticated</span>())
          <span class="java-comment"
            >// Requires authentication for all requests</span
          ><br />
          .<span class="java-method">formLogin</span>(<span
            class="java-classname"
            >withDefaults</span
          >())
          <span class="java-comment">// Enables default form-based login</span
          ><br />
          .<span class="java-method">httpBasic</span>(<span
            class="java-classname"
            >withDefaults</span
          >())
          <span class="java-comment"
            >// Enables Basic Authentication for REST clients</span
          ><br />
          .<span class="java-method">sessionManagement</span>(<span
            class="java-parameter"
            >session</span
          >
          -> <span class="java-parameter">session</span>.<span
            class="java-method"
            >sessionCreationPolicy</span
          >(<span class="java-classname">SessionCreationPolicy</span>.<span
            class="java-field"
            >STATELESS</span
          >)); <span class="java-comment">// Sets stateless session policy</span
          ><br />
          <span class="java-keyword">return</span>
          <span class="java-parameter">http</span>.<span class="java-method"
            >build</span
          >();
          <span class="java-comment"
            >// Builds and returns the configured filter chain</span
          ><br />
          }<br />
          }
        </div>
        <div class="subsection-title">Explanation</div>
        <ul class="content-line">
          <li>
            The configuration disables CSRF, requires authentication for all
            requests, enables form and Basic Authentication, and sets a
            stateless session policy.
          </li>
          <li>Lambda expressions make the configuration concise and modern.</li>
          <li>
            <span class="highlight">@EnableWebSecurity</span> activates custom
            security settings.
          </li>
        </ul>
        <div class="subsection-title">Live Example</div>
        <p class="content-line">
          With this configuration,
          <span class="highlight">localhost:8080/hello</span> prompts a Basic
          Auth pop-up due to <span class="highlight">httpBasic</span>. In
          Postman, a GET to <span class="highlight">/hello</span> with Basic
          Auth (<span class="highlight">telusko</span>,
          <span class="highlight">1234</span>) succeeds without a CSRF token, as
          the app is stateless, showing how custom configurations tailor
          security.
        </p>
      </div>

      <div id="section13" class="section">
        <h2 class="section-title">13. Imperative Security Configuration</h2>
        <div class="subsection-title">Concept Overview</div>
        <p class="content-line">
          The imperative configuration style is like writing detailed
          instructions for your security system, step by step. It’s more verbose
          than the lambda style but clearer for beginners because it explicitly
          shows each setting. Think of it as filling out a form where you check
          boxes for each security feature (e.g., disable CSRF, enable login).
          Intermediate learners may prefer the lambda style for brevity but
          should understand both, as imperative is common in older codebases.
        </p>
        <div class="subsection-title">
          Code Example: SecurityConfig (Imperative Style)
        </div>
        <pre class="code-block">
<span class="java-package">package</span> <span class="java-classname">com.telusko</span>;

<span class="java-import">import</span> <span class="java-classname">jakarta.persistence.Entity</span>;
<span class="java-import">import</span> <span class="java-classname">jakarta.persistence.Id</span>;

<span class="java-comment">// @Entity: Marks this class as a Hibernate entity, mapping it to a database table (default name: student)</span>
<span class="java-annotation">@Entity</span>
<span class="java-keyword">public</span> <span class="java-classname">Student</span> {
    <span class="java-comment">// @Id: Designates rollNo as the primary key for the student table</span>
    <span class="java-annotation">@Id</span>
    <span class="java-keyword">private</span> <span class="java-classname">int</span> <span class="java-field">rollNo</span>;
    <span class="java-keyword">private</span> <span class="java-classname">String</span> <span class="java-field">sName</span>;
    <span class="java-keyword">private</span> <span class="java-classname">int</span> <span class="java-field">sAge</span>;

    <span class="java-comment">// Getters and setters</span>
    <span class="java-keyword">public</span> <span class="java-classname">int</span> <span class="java-method">getRollNo</span>() {
        <span class="java-keyword">return</span> <span class="java-field">rollNo</span>;
    }

    <span class="java-keyword">public</span> <span class="java-keyword">void</span> <span class="java-method">setRollNo</span>(<span class="java-classname">int</span> <span class="java-parameter">rollNo</span>) {
        <span class="java-keyword">this</span>.<span class="java-field">rollNo</span> = <span class="java-parameter">rollNo</span>;
    }

    <span class="java-keyword">public</span> <span class="java-classname">String</span> <span class="java-method">getSname</span>() {
        <span class="java-keyword">return</span> <span class="java-field">sName</span>;
    }

    <span class="java-keyword">public</span> <span class="java-keyword">void</span> <span class="java-method">setSname</span>(<span class="java-classname">String</span> <span class="java-parameter">sName</span>) {
        <span class="java-keyword">this</span>.<span class="java-field">sName</span> = <span class="java-parameter">sName</span>;
    }

    <span class="java-keyword">public</span> <span class="java-classname">int</span> <span class="java-method">getSage</span>() {
        <span class="java-keyword">return</span> <span class="java-field">sAge</span>;
    }

    <span class="java-keyword">public</span> <span class="java-keyword">void</span> <span class="java-method">setSage</span>(<span class="java-classname">int</span> <span class="java-parameter">sAge</span>) {
        <span class="java-keyword">this</span>.<span class="java-field">sAge</span> = <span class="java-parameter">sAge</span>;
    }

    <span class="java-comment">// toString for readable output</span>
    <span class="java-annotation">@Override</span>
    <span class="java-keyword">public</span> <span class="java-classname">String</span> <span class="java-method">toString</span>() {
        <span class="java-keyword">return</span> <span class="java-string">"Student{"</span> +
                <span class="java-string">"rollNo="</span> + <span class="java-field">rollNo</span> +
                <span class="java-string">", sName='"</span> + <span class="java-field">sName</span> + <span class="java-string">"'"</span> +
                <span class="java-string">", sAge="</span> + <span class="java-field">sAge</span> +
                <span class="java-string">"}"</span>;
    }
}
</pre>

        <div class="subsection-title">Explanation</div>
        <ul class="content-line">
          <li>
            The imperative style uses explicit
            <span class="highlight">Customizer</span> objects for each
            configuration step.
          </li>
          <li>
            The result is identical to the lambda style but more verbose, making
            it easier to understand for beginners.
          </li>
          <li>
            It disables CSRF, requires authentication, enables form and Basic
            Authentication, and sets a stateless policy.
          </li>
        </ul>
        <div class="subsection-title">Live Example</div>
        <p class="content-line">
          The imperative configuration produces the same result as the lambda
          style. A GET to <span class="highlight">localhost:8080/hello</span> in
          Postman with Basic Auth (<span class="highlight">telusko</span>,
          <span class="highlight">1234</span>) succeeds without a CSRF token,
          confirming the stateless setup, showing both styles achieve identical
          security outcomes.
        </p>
      </div>

      <div id="section14" class="section">
        <h2 class="section-title">
          14. Multiple Users with In-Memory Authentication
        </h2>
        <div class="subsection-title">Concept Overview</div>
        <p class="content-line">
          In-memory authentication stores multiple users in memory, like a
          temporary list, ideal for testing.
        </p>
        <div class="subsection-title">Code Example: SecurityConfig</div>
        <pre class="code-block">
<span class="java-package">package</span> <span class="java-classname">com.co.config</span>;

<span class="java-import">import</span> <span class="java-classname">org.springframework.context.annotation.Bean</span>;
<span class="java-import">import</span> <span class="java-classname">org.springframework.context.annotation.Configuration</span>;
<span class="java-import">import</span> <span class="java-classname">org.springframework.security.config.annotation.web.configuration.EnableWebSecurity</span>;
<span class="java-import">import</span> <span class="java-classname">org.springframework.security.core.userdetails.User</span>;
<span class="java-import">import</span> <span class="java-classname">org.springframework.security.core.userdetails.UserDetailsService</span>;
<span class="java-import">import</span> <span class="java-classname">org.springframework.security.provisioning.InMemoryUserDetailsManager</span>;
<span class="java-import">import</span> <span class="java-classname">org.springframework.security.web.SecurityFilterChain</span>;
<span class="java-import">import</span> <span class="java-classname">org.springframework.security.config.http.SessionCreationPolicy</span>;
<span class="java-import">import</span> <span class="java-classname">org.springframework.security.config.annotation.web.builders.HttpSecurity</span>;
<span class="java-import">import</span> <span class="java-classname">static org.springframework.security.config.Customizer.withDefaults</span>;

<span class="java-annotation">@Configuration</span>
<span class="java-annotation">@EnableWebSecurity</span>
<span class="java-keyword">public</span> <span class="java-classname">SecurityConfig</span> {

    <span class="java-annotation">@Bean</span>
    <span class="java-keyword">public</span> <span class="java-classname">UserDetailsService</span> <span class="java-method">userDetailsService</span>() {
        <span class="java-keyword">var</span> <span class="java-parameter">user</span> = <span class="java-classname">User</span>
            .<span class="java-method">withDefaultPasswordEncoder</span>()
            .<span class="java-method">username</span>(<span class="java-string">"naveen"</span>)
            .<span class="java-method">password</span>(<span class="java-string">"n@123"</span>)
            .<span class="java-method">roles</span>(<span class="java-string">"USER"</span>)
            .<span class="java-method">build</span>();

        <span class="java-keyword">var</span> <span class="java-parameter">admin</span> = <span class="java-classname">User</span>
            .<span class="java-method">withDefaultPasswordEncoder</span>()
            .<span class="java-method">username</span>(<span class="java-string">"admin"</span>)
            .<span class="java-method">password</span>(<span class="java-string">"admin@789"</span>)
            .<span class="java-method">roles</span>(<span class="java-string">"ADMIN"</span>)
            .<span class="java-method">build</span>();

        <span class="java-keyword">return</span> <span class="java-keyword">new</span> <span class="java-classname">InMemoryUserDetailsManager</span>(<span class="java-parameter">user</span>, <span class="java-parameter">admin</span>);
    }

    <span class="java-annotation">@Bean</span>
    <span class="java-keyword">public</span> <span class="java-classname">SecurityFilterChain</span> <span class="java-method">securityFilterChain</span>(<span class="java-classname">HttpSecurity</span> <span class="java-parameter">http</span>) <span class="java-keyword">throws</span> <span class="java-classname">Exception</span> {
        <span class="java-parameter">http</span>
            .<span class="java-method">csrf</span>(<span class="java-parameter">csrf</span> -> <span class="java-parameter">csrf</span>.<span class="java-method">disable</span>())
            .<span class="java-method">authorizeHttpRequests</span>(<span class="java-parameter">auth</span> -> <span class="java-parameter">auth</span>
                .<span class="java-method">anyRequest</span>()
                .<span class="java-method">authenticated</span>())
            .<span class="java-method">formLogin</span>(<span class="java-classname">withDefaults</span>())
            .<span class="java-method">httpBasic</span>(<span class="java-classname">withDefaults</span>())
            .<span class="java-method">sessionManagement</span>(<span class="java-parameter">session</span> ->
                <span class="java-parameter">session</span>.<span class="java-method">sessionCreationPolicy</span>(<span class="java-classname">SessionCreationPolicy</span>.<span class="java-field">STATELESS</span>)
            );

        <span class="java-keyword">return</span> <span class="java-parameter">http</span>.<span class="java-method">build</span>();
    }
}
</pre>

        <div class="subsection-title">Live Example</div>
        <p class="content-line">
          Login with <span class="highlight">naveen</span>/<span
            class="highlight"
            >n@123</span
          >
          or <span class="highlight">admin</span>/<span class="highlight"
            >admin@789</span
          >
          succeeds.
        </p>
      </div>

      <div id="section15" class="section">
        <h2 class="section-title">15. Database-Driven Authentication</h2>
        <div class="subsection-title">Concept Overview</div>
        <p class="content-line">
          Database authentication stores users in a database for scalability,
          using a custom UserDetailsService.
        </p>
        <div class="subsection-title">Code Example: User Entity</div>
        <pre class="code-block">
<span class="java-package">package</span> <span class="java-classname">com.co.model</span>;

<span class="java-import">import</span> <span class="java-classname">jakarta.persistence.Entity</span>;
<span class="java-import">import</span> <span class="java-classname">jakarta.persistence.Id</span>;
<span class="java-import">import</span> <span class="java-classname">jakarta.persistence.Table</span>;
<span class="java-import">import</span> <span class="java-classname">lombok.Data</span>;

<span class="java-annotation">@Data</span>
<span class="java-annotation">@Entity</span>
<span class="java-annotation">@Table</span>(<span class="java-string">name = "users"</span>)
<span class="java-keyword">public</span> <span class="java-classname">class</span> <span class="java-classname">User</span> {

    <span class="java-annotation">@Id</span>
    <span class="java-keyword">private</span> <span class="java-classname">int</span> <span class="java-field">id</span>;
    <span class="java-keyword">private</span> <span class="java-classname">String</span> <span class="java-field">username</span>;
    <span class="java-keyword">private</span> <span class="java-classname">String</span> <span class="java-field">password</span>;

}
</pre>

        <div class="subsection-title">Code Example: SecurityConfig</div>
        <pre class="code-block">
<span class="java-package">package</span> <span class="java-classname">com.co.config</span>;

<span class="java-import">import</span> <span class="java-classname">org.springframework.context.annotation.Bean</span>;
<span class="java-import">import</span> <span class="java-classname">org.springframework.context.annotation.Configuration</span>;
<span class="java-import">import</span> <span class="java-classname">org.springframework.security.authentication.AuthenticationProvider</span>;
<span class="java-import">import</span> <span class="java-classname">org.springframework.security.authentication.dao.DaoAuthenticationProvider</span>;
<span class="java-import">import</span> <span class="java-classname">org.springframework.security.config.annotation.web.configuration.EnableWebSecurity</span>;
<span class="java-import">import</span> <span class="java-classname">org.springframework.security.core.userdetails.UserDetailsService</span>;
<span class="java-import">import</span> <span class="java-classname">org.springframework.security.web.SecurityFilterChain</span>;
<span class="java-import">import</span> <span class="java-classname">org.springframework.security.config.http.SessionCreationPolicy</span>;
<span class="java-import">import</span> <span class="java-classname">org.springframework.security.config.annotation.web.builders.HttpSecurity</span>;
<span class="java-import">import</span> <span class="java-classname">org.springframework.security.crypto.password.NoOpPasswordEncoder</span>;
<span class="java-import">import</span> <span class="java-classname">static org.springframework.security.config.Customizer.withDefaults</span>;

<span class="java-annotation">@Configuration</span>
<span class="java-annotation">@EnableWebSecurity</span>
<span class="java-keyword">public</span> <span class="java-classname">class</span> <span class="java-classname">SecurityConfig</span> {

    <span class="java-annotation">@Bean</span>
    <span class="java-keyword">public</span> <span class="java-classname">AuthenticationProvider</span> <span class="java-method">authProvider</span>(
        <span class="java-classname">UserDetailsService</span> <span class="java-parameter">userDetailsService</span>) {
        
        <span class="java-classname">DaoAuthenticationProvider</span> <span class="java-field">provider</span> = <span class="java-keyword">new</span> <span class="java-classname">DaoAuthenticationProvider</span>();
        <span class="java-field">provider</span>.<span class="java-method">setUserDetailsService</span>(<span class="java-parameter">userDetailsService</span>);
        <span class="java-field">provider</span>.<span class="java-method">setPasswordEncoder</span>(<span class="java-classname">NoOpPasswordEncoder</span>.<span class="java-method">getInstance</span>());

        <span class="java-keyword">return</span> <span class="java-field">provider</span>;
    }

    <span class="java-annotation">@Bean</span>
    <span class="java-keyword">public</span> <span class="java-classname">SecurityFilterChain</span> <span class="java-method">securityFilterChain</span>(
        <span class="java-classname">HttpSecurity</span> <span class="java-parameter">http</span>) <span class="java-keyword">throws</span> <span class="java-classname">Exception</span> {
        
        <span class="java-parameter">http</span>
            .<span class="java-method">csrf</span>(<span class="java-parameter">csrf</span> -> <span class="java-parameter">csrf</span>.<span class="java-method">disable</span>())
            .<span class="java-method">authorizeHttpRequests</span>(<span class="java-parameter">auth</span> -> <span class="java-parameter">auth</span>.<span class="java-method">anyRequest</span>().<span class="java-method">authenticated</span>())
            .<span class="java-method">httpBasic</span>(<span class="java-classname">withDefaults</span>())
            .<span class="java-method">sessionManagement</span>(<span class="java-parameter">session</span> -> <span class="java-parameter">session</span>.<span class="java-method">sessionCreationPolicy</span>(<span class="java-classname">SessionCreationPolicy</span>.<span class="java-field">STATELESS</span>));

        <span class="java-keyword">return</span> <span class="java-parameter">http</span>.<span class="java-method">build</span>();
    }
}
</pre>

        <div class="subsection-title">Live Example</div>
        <p class="content-line">
          GET to <span class="highlight">localhost:8080/hello</span> with
          database user credentials succeeds.
        </p>
      </div>

      <div id="section16" class="section">
        <h2 class="section-title">16. User Registration and Bcrypt Encoding</h2>
        <div class="subsection-title">Concept Overview</div>
        <p class="content-line">
          User registration allows sign-ups; Bcrypt hashes passwords securely,
          like locking them in a safe.
        </p>
        <div class="subsection-title">Code Example: UserService</div>
        <pre class="code-block">
<span class="java-package">package</span> <span class="java-classname">com.co.service</span>;

<span class="java-import">import</span> <span class="java-classname">com.co.dao.UserRepo</span>;
<span class="java-import">import</span> <span class="java-classname">com.co.model.User</span>;
<span class="java-import">import</span> <span class="java-classname">org.springframework.beans.factory.annotation.Autowired</span>;
<span class="java-import">import</span> <span class="java-classname">org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder</span>;
<span class="java-import">import</span> <span class="java-classname">org.springframework.stereotype.Service</span>;

<span class="java-annotation">@Service</span>
<span class="java-keyword">public class</span> <span class="java-classname">UserService</span> {

    <span class="java-annotation">@Autowired</span>
    <span class="java-keyword">private</span> <span class="java-classname">UserRepo</span> <span class="java-field">userRepo</span>;

    <span class="java-keyword">public</span> <span class="java-classname">User</span> <span class="java-method">saveUser</span>(<span class="java-classname">User</span> <span class="java-parameter">user</span>) {
        <span class="java-classname">BCryptPasswordEncoder</span> <span class="java-field">encoder</span> = <span class="java-keyword">new</span> <span class="java-classname">BCryptPasswordEncoder</span>(<span class="java-number">12</span>);
        <span class="java-classname">String</span> <span class="java-field">encodedPassword</span> = <span class="java-field">encoder</span>.<span class="java-method">encode</span>(<span class="java-parameter">user</span>.<span class="java-method">getPassword</span>());
        <span class="java-parameter">user</span>.<span class="java-method">setPassword</span>(<span class="java-field">encodedPassword</span>);
        <span class="java-keyword">return</span> <span class="java-field">userRepo</span>.<span class="java-method">save</span>(<span class="java-parameter">user</span>);
    }
}
</pre>

        <div class="subsection-title">
          Code Example: SecurityConfig (Bcrypt)
        </div>
        <pre class="code-block">
<span class="java-package">package</span> <span class="java-classname">com.co.config</span>;

<span class="java-import">import</span> <span class="java-classname">org.springframework.context.annotation.Bean</span>;
<span class="java-import">import</span> <span class="java-classname">org.springframework.context.annotation.Configuration</span>;
<span class="java-import">import</span> <span class="java-classname">org.springframework.security.authentication.AuthenticationProvider</span>;
<span class="java-import">import</span> <span class="java-classname">org.springframework.security.authentication.dao.DaoAuthenticationProvider</span>;
<span class="java-import">import</span> <span class="java-classname">org.springframework.security.config.annotation.web.configuration.EnableWebSecurity</span>;
<span class="java-import">import</span> <span class="java-classname">org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder</span>;
<span class="java-import">import</span> <span class="java-classname">org.springframework.security.web.SecurityFilterChain</span>;
<span class="java-import">import</span> <span class="java-classname">org.springframework.security.core.userdetails.UserDetailsService</span>;
<span class="java-import">import</span> <span class="java-classname">org.springframework.security.config.http.SessionCreationPolicy</span>;
<span class="java-import">import</span> <span class="java-classname">org.springframework.security.config.annotation.web.builders.HttpSecurity</span>;
<span class="java-import">import</span> <span class="java-classname">static org.springframework.security.config.Customizer.withDefaults</span>;

<span class="java-annotation">@Configuration</span>
<span class="java-annotation">@EnableWebSecurity</span>
<span class="java-keyword">public class</span> <span class="java-classname">SecurityConfig</span> {

    <span class="java-annotation">@Bean</span>
    <span class="java-keyword">public</span> <span class="java-classname">AuthenticationProvider</span> <span class="java-method">authProvider</span>(
        <span class="java-classname">UserDetailsService</span> <span class="java-parameter">userDetailsService</span>) {
        
        <span class="java-classname">DaoAuthenticationProvider</span> <span class="java-field">provider</span> = <span class="java-keyword">new</span> <span class="java-classname">DaoAuthenticationProvider</span>();
        <span class="java-field">provider</span>.<span class="java-method">setUserDetailsService</span>(<span class="java-parameter">userDetailsService</span>);
        <span class="java-field">provider</span>.<span class="java-method">setPasswordEncoder</span>(<span class="java-keyword">new</span> <span class="java-classname">BCryptPasswordEncoder</span>(<span class="java-number">12</span>));

        <span class="java-keyword">return</span> <span class="java-field">provider</span>;
    }

    <span class="java-annotation">@Bean</span>
    <span class="java-keyword">public</span> <span class="java-classname">SecurityFilterChain</span> <span class="java-method">securityFilterChain</span>(
        <span class="java-classname">HttpSecurity</span> <span class="java-parameter">http</span>) <span class="java-keyword">throws</span> <span class="java-classname">Exception</span> {
        
        <span class="java-parameter">http</span>
            .<span class="java-method">csrf</span>(<span class="java-parameter">csrf</span> -> <span class="java-parameter">csrf</span>.<span class="java-method">disable</span>())
            .<span class="java-method">authorizeHttpRequests</span>(<span class="java-parameter">auth</span> -> <span class="java-parameter">auth</span>.<span class="java-method">anyRequest</span>().<span class="java-method">authenticated</span>())
            .<span class="java-method">httpBasic</span>(<span class="java-classname">withDefaults</span>())
            .<span class="java-method">sessionManagement</span>(<span class="java-parameter">session</span> -> <span class="java-parameter">session</span>.<span class="java-method">sessionCreationPolicy</span>(<span class="java-classname">SessionCreationPolicy</span>.<span class="java-field">STATELESS</span>));

        <span class="java-keyword">return</span> <span class="java-parameter">http</span>.<span class="java-method">build</span>();
    }
}
</pre>

        <div class="subsection-title">Live Example</div>
        <p class="content-line">
          POST to <span class="highlight">/register</span> saves a user with
          Bcrypt hash; login with new credentials succeeds.
        </p>
      </div>

      <div id="section17" class="section">
        <h2 class="section-title">
          17. Best Practices and Future Enhancements
        </h2>
        <div class="subsection-title">Concept Overview</div>
        <p class="content-line">
          Building a secure app requires HTTPS, database roles, and account
          status checks, with future enhancements like OAuth.
        </p>
        <div class="subsection-title">Live Example</div>
        <p class="content-line">
          Manually updating database with Bcrypt hashes ensures compatibility.
        </p>
        <div class="subsection-title">References</div>
        <ul class="content-line">
          <li>
            <a href="https://www.youtube.com/@Telusko"
              >Telusko YouTube Channel</a
            >
          </li>
          <li>
            <a
              href="https://github.com/navinreddy20/spring6-course/tree/c6690e4f2c70d8f530d70623f13d14ff0ffd7e7d/12%20Spring%20security"
              >GitHub Repository</a
            >
          </li>
          <li>
            <a href="https://owasp.org/www-project-top-ten/">OWASP Top 10</a>
          </li>
        </ul>
      </div>
    </div>

    <script>
      function changeBackground() {
        const select = document.getElementById("bg-select");
        const body = document.body;
        body.className = select.value;
      }
    </script>
  </body>
</html>
