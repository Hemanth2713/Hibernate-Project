<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spring Security Notes for Beginners and Intermediate Learners</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f1f1f1;
            line-height: 1.6;
            transition: background-color 0.3s, color 0.3s;
        }
        .white-bg { background-color: #ffffff; color: #333; }
        .grey-bg { background-color: #e0e0e0; color: #333; }
        .black-bg { background-color: #1a1a1a; color: #ffffff; }
        .bg-switcher {
            position: fixed;
            top: 10px;
            right: 10px;
            z-index: 1000;
            font-size: 16px;
        }
        .bg-switcher label { 
            margin-right: 10px; 
            color: inherit;
        }
        .bg-switcher select {
            padding: 5px;
            border-radius: 5px;
            background-color: #04AA6D;
            color: white;
            border: none;
            cursor: pointer;
        }
        .bg-switcher select:focus {
            outline: 2px solid #059862;
        }
        .sidebar {
            width: 250px;
            background-color: #04AA6D;
            position: fixed;
            top: 0;
            left: 0;
            height: 100%;
            padding-top: 20px;
            color: white;
            overflow-y: auto;
        }
        .sidebar-title {
            font-size: 24px;
            text-align: center;
            margin-bottom: 30px;
        }
        .sidebar-link {
            display: block;
            padding: 12px 20px;
            color: white;
            text-decoration: none;
            font-size: 18px;
            transition: background-color 0.3s;
        }
        .sidebar-link:hover { background-color: #059862; }
        .sidebar-link:focus {
            outline: 2px solid white;
        }
        .main-content { 
            margin-left: 270px; 
            padding: 30px; 
        }
        .header {
            background-color: #282A35;
            color: white;
            padding: 20px;
            text-align: center;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .header-title { font-size: 36px; margin: 0; }
        .header-subtitle { font-size: 18px; margin-top: 10px; }
        .section {
            margin: 20px 0;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .white-bg .section { background-color: #f9f9f9; }
        .grey-bg .section { background-color: #d0d0d0; }
        .black-bg .section { background-color: #2a2a2a; }
        .section-title { font-size: 28px; color: #04AA6D; margin-bottom: 15px; }
        .subsection-title { font-size: 22px; margin: 15px 0 10px; color: inherit; }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            background-color: #ffffff;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            overflow-x: auto;
        }
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #04AA6D;
            color: white;
            font-weight: bold;
        }
        tr:nth-child(even) { background-color: #f9f9f9; }
        tr:hover { background-color: #f1f1f1; }
        .content-line {
            font-size: 16px;
            margin: 8px 0;
            padding: 10px;
            border-left: 4px solid #04AA6D;
        }
        .white-bg .content-line { background-color: #f0f0f0; }
        .grey-bg .content-line { background-color: #c0c0c0; }
        .black-bg .content-line { background-color: #333333; }
        .code-block {
            padding: 15px;
            border-radius: 5px;
            font-family: 'Courier New', Courier, monospace;
            font-size: 14px;
            overflow-x: auto;
            margin: 10px 0;
        }
        .white-bg .code-block { background-color: #282A35; color: white; }
        .grey-bg .code-block { background-color: #3a3a3a; color: white; }
        .black-bg .code-block { background-color: #ffffff; color: #333; }
        .code-block::-webkit-scrollbar {
            height: 8px;
        }
        .code-block::-webkit-scrollbar-thumb {
            background-color: #04AA6D;
            border-radius: 4px;
        }
        .code-block::-webkit-scrollbar-track {
            background-color: #f1f1f1;
        }
        .highlight { color: #FF4500; font-weight: bold; }
        strong { font-weight: bold; }
        a { color: #04AA6D; text-decoration: none; }
        a:hover { text-decoration: underline; }
        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
                height: auto;
                position: relative;
            }
            .main-content {
                margin-left: 0;
            }
        }
    </style>
</head>
<body class="white-bg">
    <div class="bg-switcher">
        <label for="bg-select">Background:</label>
        <select id="bg-select" onchange="changeBackground()">
            <option value="white-bg">White</option>
            <option value="grey-bg">Grey</option>
            <option value="black-bg">Dark</option>
        </select>
    </div>

    <div class="sidebar">
        <div class="sidebar-title">Spring Security</div>
        <a href="#section1" class="sidebar-link">1. Importance of Security</a>
        <a href="#section2" class="sidebar-link">2. OWASP Top 10</a>
        <a href="#section3" class="sidebar-link">3. Creating a Project</a>
        <a href="#section4" class="sidebar-link">4. Default Login Form</a>
        <a href="#section5" class="sidebar-link">5. Security Filters</a>
        <a href="#section6" class="sidebar-link">6. Session Management</a>
        <a href="#section7" class="sidebar-link">7. Setting Credentials</a>
        <a href="#section8" class="sidebar-link">8. Basic Authentication</a>
        <a href="#section9" class="sidebar-link">9. CSRF Protection</a>
        <a href="#section10" class="sidebar-link">10. Implementing CSRF</a>
        <a href="#section11" class="sidebar-link">11. SameSite & Stateless</a>
        <a href="#section12" class="sidebar-link">12. Custom Security</a>
        <a href="#section13" class="sidebar-link">13. Imperative Config</a>
        <a href="#section14" class="sidebar-link">14. In-Memory Users</a>
        <a href="#section15" class="sidebar-link">15. Database Auth</a>
        <a href="#section16" class="sidebar-link">16. User Registration</a>
        <a href="#section17" class="sidebar-link">17. Best Practices</a>
    </div>

    <div class="main-content">
        <div class="header">
            <h1 class="header-title">Spring Security Notes</h1>
            <p class="header-subtitle">For Beginners and Intermediate Learners</p>
        </div>

        <div id="section1" class="section">
            <h2 class="section-title">1. Importance of Security in Application Development</h2>
            <div class="subsection-title">Concept Overview</div>
            <p class="content-line">Security in application development is like locking the doors of your house to keep intruders out. While developers focus on making an application work (functionality), run smoothly (stability), and load quickly (performance), security ensures that only the right people can access the app’s features and data. Authentication (checking who you are) and authorization (deciding what you can do) are the core pillars of security.</p>
            <div class="subsection-title">Key Points</div>
            <ul class="content-line">
                <li><strong>Functionality:</strong> Makes the app work (e.g., job search in a portal).</li>
                <li><strong>Stability:</strong> Handles errors gracefully.</li>
                <li><strong>Performance:</strong> Ensures fast responses.</li>
                <li><strong>Security:</strong> Protects data and restricts access.</li>
                <li><strong>Authentication:</strong> Verifies identity.</li>
                <li><strong>Authorization:</strong> Controls permissions.</li>
                <li><strong>Data Sensitivity:</strong> Critical for apps with sensitive data.</li>
            </ul>
            <div class="subsection-title">Example</div>
            <p class="content-line">In a job portal, anyone can view job listings, but only authenticated admins should create or delete jobs. Spring Security ensures only verified admins can perform these actions.</p>
            <div class="subsection-title">Live Example</div>
            <p class="content-line">Accessing <span class="highlight">localhost:8080/admin/createJob</span> without security allows anyone to post a job. With Spring Security, this URL requires admin login.</p>
        </div>

        <div id="section2" class="section">
            <h2 class="section-title">2. OWASP Top 10 Security Risks</h2>
            <div class="subsection-title">Concept Overview</div>
            <p class="content-line">The OWASP Top 10 is a list of the top security threats to web applications, like a guide to common hacker tactics. Spring Security helps address these risks with secure authentication and authorization.</p>
            <div class="subsection-title">Key Risks</div>
            <table>
                <tr><th>Risk</th><th>Description</th></tr>
                <tr><td>Broken Access Control</td><td>Users access restricted resources.</td></tr>
                <tr><td>Cryptographic Failures</td><td>Weak encryption exposes data.</td></tr>
                <tr><td>Injection</td><td>Malicious code in inputs.</td></tr>
                <tr><td>Insecure Design</td><td>Flawed app design creates vulnerabilities.</td></tr>
                <tr><td>Security Misconfiguration</td><td>Default settings expose weaknesses.</td></tr>
                <tr><td>Vulnerable Components</td><td>Old libraries with issues.</td></tr>
                <tr><td>Authentication Failures</td><td>Weak passwords or no MFA.</td></tr>
                <tr><td>Data Integrity Failures</td><td>Unverified data compromises app.</td></tr>
                <tr><td>Logging Failures</td><td>Missing logs to detect attacks.</td></tr>
                <tr><td>SSRF</td><td>Server makes unauthorized requests.</td></tr>
            </table>
            <div class="subsection-title">Example</div>
            <p class="content-line">A SQL injection attack (e.g., <span class="highlight">admin' OR '1'='1</span>) could bypass login. Spring Security’s prepared statements prevent this.</p>
        </div>

        <div id="section3" class="section">
            <h2 class="section-title">3. Creating a Spring Security Project</h2>
            <div class="subsection-title">Concept Overview</div>
            <p class="content-line">Creating a Spring Security project is like installing a security system. Adding the Spring Security dependency provides a default login page to protect all URLs.</p>
            <div class="subsection-title">Steps</div>
            <ol class="content-line">
                <li>Go to <a href="https://start.spring.io">Spring Initializr</a>.</li>
                <li>Select Maven, Java 21, and add Spring Web, Security, DevTools.</li>
                <li>Set group ID <span class="highlight">com.co</span>, artifact ID <span class="highlight">spring-seq-demo</span>.</li>
                <li>Generate, unzip, and open in an IDE.</li>
                <li>Create a REST controller.</li>
            </ol>
            <div class="subsection-title">Code Example: HelloController</div>
            <div class="code-block">
package com.co;

import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController
public class HelloController {
    @GetMapping("/hello")
    public String greet() {
        return "Hello World";
    }

    @GetMapping("/about")
    public String about() {
        return "Telusko";
    }
}
            </div>
            <div class="subsection-title">Live Example</div>
            <p class="content-line">Before Spring Security, <span class="highlight">localhost:8080/hello</span> shows "Hello World". After adding the dependency, it shows a login form.</p>
        </div>

        <div id="section4" class="section">
            <h2 class="section-title">4. Default Login Form in Spring Security</h2>
            <div class="subsection-title">Concept Overview</div>
            <p class="content-line">Spring Security’s default login form is like a pre-installed gatekeeper, protecting all URLs with a login page using default credentials.</p>
            <div class="subsection-title">Key Features</div>
            <ul class="content-line">
                <li><strong>Default Credentials:</strong> Username <span class="highlight">user</span>, password in console.</li>
                <li><strong>Session Management:</strong> Session ID created after login.</li>
                <li><strong>Logout:</strong> <span class="highlight">/logout</span> URL ends session.</li>
            </ul>
            <div class="subsection-title">Live Example</div>
            <p class="content-line">Accessing <span class="highlight">localhost:8080/hello</span> shows a login form. Correct credentials grant access; <span class="highlight">/logout</span> requires re-login.</p>
        </div>

        <div id="section5" class="section">
            <h2 class="section-title">5. Spring Security Filters</h2>
            <div class="subsection-title">Concept Overview</div>
            <p class="content-line">Spring Security filters are like airport checkpoints, checking requests before reaching the app’s code.</p>
            <div class="subsection-title">Key Filters</div>
            <ul class="content-line">
                <li><strong>SecurityContextPersistenceFilter:</strong> Stores user details.</li>
                <li><strong>UsernamePasswordAuthenticationFilter:</strong> Checks login credentials.</li>
                <li><strong>CsrfFilter:</strong> Ensures CSRF token for POST requests.</li>
                <li><strong>LogoutFilter:</strong> Handles logout.</li>
            </ul>
            <div class="subsection-title">Live Example</div>
            <p class="content-line">A POST request without a CSRF token fails, showing <span class="highlight">CsrfFilter</span> in action.</p>
        </div>

        <div id="section6" class="section">
            <h2 class="section-title">6. Session Management and Session ID</h2>
            <div class="subsection-title">Concept Overview</div>
            <p class="content-line">A session is like a visitor pass, with a unique session ID stored in a cookie for authentication.</p>
            <div class="subsection-title">Code Example: Printing Session ID</div>
            <div class="code-block">
package com.co;

import jakarta.servlet.http.HttpServletRequest;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController
public class HelloController {
    @GetMapping("/hello")
    public String greet(HttpServletRequest request) {
        return "Hello World " + request.getSession().getId();
    }

    @GetMapping("/about")
    public String about(HttpServletRequest request) {
        return "Telusko " + request.getSession().getId();
    }
}
            </div>
            <div class="subsection-title">Live Example</div>
            <p class="content-line"><span class="highlight">localhost:8080/hello</span> shows “Hello World 1234”. Logging out and back in generates a new ID.</p>
        </div>

        <div id="section7" class="section">
            <h2 class="section-title">7. Setting Username and Password</h2>
            <div class="subsection-title">Concept Overview</div>
            <p class="content-line">Setting custom credentials in <span class="highlight">application.properties</span> replaces default ones, but plain text is unsafe for production.</p>
            <div class="subsection-title">Code Example: application.properties</div>
            <div class="code-block">
spring.security.user.name=telusko
spring.security.user.password=1234
            </div>
            <div class="subsection-title">Live Example</div>
            <p class="content-line">Login with <span class="highlight">telusko</span> and <span class="highlight">1234</span> grants access; default credentials fail.</p>
        </div>

        <div id="section8" class="section">
            <h2 class="section-title">8. Basic Authentication Using Postman</h2>
            <div class="subsection-title">Concept Overview</div>
            <p class="content-line">Basic Authentication sends credentials in the Authorization header, ideal for REST APIs but requires HTTPS.</p>
            <div class="subsection-title">Live Example</div>
            <p class="content-line">In Postman, a GET to <span class="highlight">localhost:8080/hello</span> with Basic Auth (<span class="highlight">telusko</span>, <span class="highlight">1234</span>) succeeds.</p>
        </div>

        <div id="section9" class="section">
            <h2 class="section-title">9. Cross-Site Request Forgery (CSRF)</h2>
            <div class="subsection-title">Concept Overview</div>
            <p class="content-line">CSRF tricks users into performing unintended actions. Spring Security requires a CSRF token for non-GET requests.</p>
            <div class="subsection-title">Key Points</div>
            <ul class="content-line">
                <li><strong>CSRF Token:</strong> Unique code for POST, PUT, DELETE.</li>
                <li><strong>Default Protection:</strong> Enabled for non-GET requests.</li>
                <li><strong>Mitigation:</strong> Use tokens or SameSite=Strict cookies.</li>
            </ul>
            <div class="subsection-title">Live Example</div>
            <p class="content-line">A POST to <span class="highlight">/students</span> without a CSRF token fails (401).</p>
        </div>

        <div id="section10" class="section">
            <h2 class="section-title">10. Implementing CSRF Protection</h2>
            <div class="subsection-title">Concept Overview</div>
            <p class="content-line">CSRF protection uses tokens or SameSite cookies to ensure requests come from the right site.</p>
            <div class="subsection-title">Code Example: StudentController</div>
            <div class="code-block">
package com.co;

import lombok.Data;
import org.springframework.web.bind.annotation.*;

import java.util.ArrayList;
import java.util.List;

@RestController
public class StudentController {
    private static final List<Student> students = new ArrayList<>(List.of(
            new Student(1, "Naveen", "Java"),
            new Student(2, "Kiran", "Blockchain")
    ));

    @GetMapping("/students")
    public List<Student> getStudents() {
        return students;
    }

    @PostMapping("/students")
    public void addStudent(@RequestBody Student student) {
        students.add(student);
    }

    @GetMapping("/csrf-token")
    public CsrfToken getCsrfToken(HttpServletRequest request) {
        return (CsrfToken) request.getAttribute("_csrf");
    }
}

@Data
public class Student {
    private int id;
    private String name;
    private String technology;

    public Student(int id, String name, String technology) {
        this.id = id;
        this.name = name;
        this.technology = technology;
    }
}
            </div>
            <div class="subsection-title">Live Example</div>
            <p class="content-line">POST to <span class="highlight">/students</span> with a CSRF token from <span class="highlight">/csrf-token</span> succeeds.</p>
        </div>

        <div id="section11" class="section">
            <h2 class="section-title">11. SameSite Strict and Stateless APIs</h2>
            <div class="subsection-title">Concept Overview</div>
            <p class="content-line">SameSite=Strict cookies block CSRF attacks; stateless APIs require credentials per request, no sessions.</p>
            <div class="subsection-title">Code Example: application.properties</div>
            <div class="code-block">
server.servlet.session.cookie.same-site=strict
            </div>
            <div class="subsection-title">Live Example</div>
            <p class="content-line">Stateless POST to <span class="highlight">/students</span> with Basic Auth succeeds without CSRF token.</p>
        </div>

        <div id="section12" class="section">
            <h2 class="section-title">12. Custom Security Configuration</h2>
            <div class="subsection-title">Concept Overview</div>
            <p class="content-line">Custom configurations allow control over authentication, authorization, and sessions, like designing a security system.</p>
            <div class="subsection-title">Code Example: SecurityConfig (Lambda)</div>
            <div class="code-block">
package com.co.config;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
import org.springframework.security.config.http.SessionCreationPolicy;
import org.springframework.security.web.SecurityFilterChain;

import static org.springframework.security.config.Customizer.withDefaults;

@Configuration
@EnableWebSecurity
public class SecurityConfig {
    @Bean
    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {
        http
                .csrf(csrf -> csrf.disable())
                .authorizeHttpRequests(auth -> auth.anyRequest().authenticated())
                .formLogin(withDefaults())
                .httpBasic(withDefaults())
                .sessionManagement(session -> session.sessionCreationPolicy(SessionCreationPolicy.STATELESS));
        return http.build();
    }
}
            </div>
            <div class="subsection-title">Live Example</div>
            <p class="content-line">GET to <span class="highlight">localhost:8080/hello</span> with Basic Auth succeeds without CSRF token.</p>
        </div>

        <div id="section13" class="section">
            <h2 class="section-title">13. Imperative Security Configuration</h2>
            <div class="subsection-title">Concept Overview</div>
            <p class="content-line">Imperative style explicitly configures security settings, clearer for beginners but more verbose.</p>
            <div class="subsection-title">Code Example: SecurityConfig (Imperative)</div>
            <div class="code-block">
package com.co.config;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
import org.springframework.security.config.http.SessionCreationPolicy;
import org.springframework.security.web.SecurityFilterChain;

@Configuration
@EnableWebSecurity
public class SecurityConfig {
    @Bean
    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {
        Customizer<CsrfConfigurer<HttpSecurity>> custCsrf = new Customizer<>() {
            @Override
            public void customize(CsrfConfigurer<HttpSecurity> configurer) {
                configurer.disable();
            }
        };
        http.csrf(custCsrf);

        Customizer<AuthorizeHttpRequestsConfigurer<HttpSecurity>.AuthorizationManagerRequestMatcherRegistry> custAuth =
                new Customizer<>() {
                    @Override
                    public void customize(AuthorizeHttpRequestsConfigurer<HttpSecurity>.AuthorizationManagerRequestMatcherRegistry registry) {
                        registry.anyRequest().authenticated();
                    }
                };
        http.authorizeHttpRequests(custAuth);

        http.formLogin(withDefaults()).httpBasic(withDefaults());

        Customizer<SessionManagementConfigurer<HttpSecurity>> custSession = new Customizer<>() {
            @Override
            public void customize(SessionManagementConfigurer<HttpSecurity> session) {
                session.sessionCreationPolicy(SessionCreationPolicy.STATELESS);
            }
        };
        http.sessionManagement(custSession);

        return http.build();
    }
}
            </div>
            <div class="subsection-title">Live Example</div>
            <p class="content-line">Same result as lambda style; GET to <span class="highlight">localhost:8080/hello</span> succeeds with Basic Auth.</p>
        </div>

        <div id="section14" class="section">
            <h2 class="section-title">14. Multiple Users with In-Memory Authentication</h2>
            <div class="subsection-title">Concept Overview</div>
            <p class="content-line">In-memory authentication stores multiple users in memory, like a temporary list, ideal for testing.</p>
            <div class="subsection-title">Code Example: SecurityConfig</div>
            <div class="code-block">
package com.co.config;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
import org.springframework.security.core.userdetails.User;
import org.springframework.security.core.userdetails.UserDetailsService;
import org.springframework.security.provisioning.InMemoryUserDetailsManager;
import org.springframework.security.web.SecurityFilterChain;

@Configuration
@EnableWebSecurity
public class SecurityConfig {
    @Bean
    public UserDetailsService userDetailsService() {
        var user = User
                .withDefaultPasswordEncoder()
                .username("naveen")
                .password("n@123")
                .roles("USER")
                .build();

        var admin = User
                .withDefaultPasswordEncoder()
                .username("admin")
                .password("admin@789")
                .roles("ADMIN")
                .build();

        return new InMemoryUserDetailsManager(user, admin);
    }

    @Bean
    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {
        http
                .csrf(csrf -> csrf.disable())
                .authorizeHttpRequests(auth -> auth.anyRequest().authenticated())
                .formLogin(withDefaults())
                .httpBasic(withDefaults())
                .sessionManagement(session -> session.sessionCreationPolicy(SessionCreationPolicy.STATELESS));
        return http.build();
    }
}
            </div>
            <div class="subsection-title">Live Example</div>
            <p class="content-line">Login with <span class="highlight">naveen</span>/<span class="highlight">n@123</span> or <span class="highlight">admin</span>/<span class="highlight">admin@789</span> succeeds.</p>
        </div>

        <div id="section15" class="section">
            <h2 class="section-title">15. Database-Driven Authentication</h2>
            <div class="subsection-title">Concept Overview</div>
            <p class="content-line">Database authentication stores users in a database for scalability, using a custom UserDetailsService.</p>
            <div class="subsection-title">Code Example: User Entity</div>
            <div class="code-block">
package com.co.model;

import jakarta.persistence.Entity;
import jakarta.persistence.Id;
import jakarta.persistence.Table;
import lombok.Data;

@Data
@Entity
@Table(name = "users")
public class User {
    @Id
    private int id;
    private String username;
    private String password;
}
            </div>
            <div class="subsection-title">Code Example: SecurityConfig</div>
            <div class="code-block">
package com.co.config;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.authentication.AuthenticationProvider;
import org.springframework.security.authentication.dao.DaoAuthenticationProvider;
import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
import org.springframework.security.core.userdetails.UserDetailsService;
import org.springframework.security.web.SecurityFilterChain;

@Configuration
@EnableWebSecurity
public class SecurityConfig {
    @Bean
    public AuthenticationProvider authProvider(UserDetailsService userDetailsService) {
        DaoAuthenticationProvider provider = new DaoAuthenticationProvider();
        provider.setUserDetailsService(userDetailsService);
        provider.setPasswordEncoder(NoOpPasswordEncoder.getInstance());
        return provider;
    }

    @Bean
    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {
        http
                .csrf(csrf -> csrf.disable())
                .authorizeHttpRequests(auth -> auth.anyRequest().authenticated())
                .httpBasic(withDefaults())
                .sessionManagement(session -> session.sessionCreationPolicy(SessionCreationPolicy.STATELESS));
        return http.build();
    }
}
            </div>
            <div class="subsection-title">Live Example</div>
            <p class="content-line">GET to <span class="highlight">localhost:8080/hello</span> with database user credentials succeeds.</p>
        </div>

        <div id="section16" class="section">
            <h2 class="section-title">16. User Registration and Bcrypt Encoding</h2>
            <div class="subsection-title">Concept Overview</div>
            <p class="content-line">User registration allows sign-ups; Bcrypt hashes passwords securely, like locking them in a safe.</p>
            <div class="subsection-title">Code Example: UserService</div>
            <div class="code-block">
package com.co.service;

import com.co.dao.UserRepo;
import com.co.model.User;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;
import org.springframework.stereotype.Service;

@Service
public class UserService {
    @Autowired
    private UserRepo userRepo;

    public User saveUser(User user) {
        BCryptPasswordEncoder encoder = new BCryptPasswordEncoder(12);
        String encodedPassword = encoder.encode(user.getPassword());
        user.setPassword(encodedPassword);
        return userRepo.save(user);
    }
}
            </div>
            <div class="subsection-title">Code Example: SecurityConfig (Bcrypt)</div>
            <div class="code-block">
package com.co.config;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.authentication.AuthenticationProvider;
import org.springframework.security.authentication.dao.DaoAuthenticationProvider;
import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;
import org.springframework.security.web.SecurityFilterChain;

@Configuration
@EnableWebSecurity
public class SecurityConfig {
    @Bean
    public AuthenticationProvider authProvider(UserDetailsService userDetailsService) {
        DaoAuthenticationProvider provider = new DaoAuthenticationProvider();
        provider.setUserDetailsService(userDetailsService);
        provider.setPasswordEncoder(new BCryptPasswordEncoder(12));
        return provider;
    }

    @Bean
    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {
        http
                .csrf(csrf -> csrf.disable())
                .authorizeHttpRequests(auth -> auth.anyRequest().authenticated())
                .httpBasic(withDefaults())
                .sessionManagement(session -> session.sessionCreationPolicy(SessionCreationPolicy.STATELESS));
        return http.build();
    }
}
            </div>
            <div class="subsection-title">Live Example</div>
            <p class="content-line">POST to <span class="highlight">/register</span> saves a user with Bcrypt hash; login with new credentials succeeds.</p>
        </div>

        <div id="section17" class="section">
            <h2 class="section-title">17. Best Practices and Future Enhancements</h2>
            <div class="subsection-title">Concept Overview</div>
            <p class="content-line">Building a secure app requires HTTPS, database roles, and account status checks, with future enhancements like OAuth.</p>
            <div class="subsection-title">Live Example</div>
            <p class="content-line">Manually updating database with Bcrypt hashes ensures compatibility.</p>
            <div class="subsection-title">References</div>
            <ul class="content-line">
                <li><a href="https://www.youtube.com/@Telusko">Telusko YouTube Channel</a></li>
                <li><a href="https://github.com/navinreddy20/spring6-course/tree/c6690e4f2c70d8f530d70623f13d14ff0ffd7e7d/12%20Spring%20security">GitHub Repository</a></li>
                <li><a href="https://owasp.org/www-project-top-ten/">OWASP Top 10</a></li>
            </ul>
        </div>
    </div>

    <script>
        function changeBackground() {
            const select = document.getElementById('bg-select');
            const body = document.body;
            body.className = select.value;
        }
    </script>
</body>
</html>