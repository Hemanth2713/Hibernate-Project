<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spring Security Comprehensive Notes</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f1f1f1;
            line-height: 1.6;
            transition: background-color 0.3s, color 0.3s;
        }
        .white-bg { background-color: #ffffff; color: #333; }
        .grey-bg { background-color: #e0e0e0; color: #333; }
        .black-bg { background-color: #1a1a1a; color: #ffffff; }
        .bg-switcher {
            position: fixed;
            top: 10px;
            right: 10px;
            z-index: 1000;
            font-size: 16px;
        }
        .bg-switcher label { 
            margin-right: 10px; 
            color: inherit;
            font-weight: bold;
        }
        .bg-switcher select {
            padding: 5px;
            border-radius: 5px;
            background-color: #04AA6D;
            color: white;
            border: none;
            cursor: pointer;
        }
        .bg-switcher select:focus {
            outline: 2px solid #059862;
        }
        .sidebar {
            width: 250px;
            background-color: #04AA6D;
            position: fixed;
            top: 0;
            left: 0;
            height: 100%;
            padding-top: 20px;
            color: white;
            overflow-y: auto;
        }
        .sidebar-title {
            font-size: 24px;
            text-align: center;
            margin-bottom: 30px;
        }
        .sidebar-link {
            display: block;
            padding: 12px 20px;
            color: white;
            text-decoration: none;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        .sidebar-link.sub-link {
            padding-left: 35px;
            font-size: 14px;
        }
        .sidebar-link:hover { background-color: #059862; }
        .sidebar-link:focus {
            outline: 2px solid white;
        }
        .main-content { 
            margin-left: 270px; 
            padding: 30px; 
        }
        .header {
            background-color: #282A35;
            color: white;
            padding: 20px;
            text-align: center;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .header-title { font-size: 36px; margin: 0; }
        .header-subtitle { font-size: 18px; margin-top: 10px; }
        .section {
            margin: 20px 0;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .white-bg .section { background-color: #f9f9f9; }
        .grey-bg .section { background-color: #d0d0d0; }
        .black-bg .section { background-color: #2a2a2a; }
        .section-title { font-size: 28px; color: #04AA6D; margin-bottom: 15px; }
        .subsection-title { font-size: 22px; margin: 15px 0 10px; color: inherit; }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            background-color: #ffffff;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            overflow-x: auto;
        }
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #04AA6D;
            color: white;
            font-weight: bold;
        }
        tr:nth-child(even) { background-color: #f9f9f9; }
        tr:hover { background-color: #f1f1f1; }
        .content-line {
            font-size: 16px;
            margin: 8px 0;
            padding: 10px;
            border-left: 4px solid #04AA6D;
        }
        .white-bg .content-line { background-color: #f0f0f0; }
        .grey-bg .content-line { background-color: #c0c0c0; }
        .black-bg .content-line { background-color: #333333; }
        .code-block {
            padding: 15px;
            border-radius: 5px;
            font-family: 'Courier New', Courier, monospace;
            font-size: 14px;
            overflow-x: auto;
            margin: 10px 0;
            line-height: 1.4;
        }
        .white-bg .code-block { background-color: #282A35; color: #ffffff; }
        .grey-bg .code-block { background-color: #3a3a3a; color: #ffffff; }
        .black-bg .code-block { background-color: #ffffff; color: #333333; }
        .code-block::-webkit-scrollbar {
            height: 8px;
        }
        .code-block::-webkit-scrollbar-thumb {
            background-color: #04AA6D;
            border-radius: 4px;
        }
        .code-block::-webkit-scrollbar-track {
            background-color: #f1f1f1;
        }
        .highlight { color: #000000; font-weight: bold; }
        strong { font-weight: bold; }
        a { color: #04AA6D; text-decoration: none; }
        a:hover { text-decoration: underline; }
        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
                height: auto;
                position: relative;
            }
            .main-content {
                margin-left: 0;
            }
            .header-title { font-size: 28px; }
            .section-title { font-size: 24px; }
            .subsection-title { font-size: 20px; }
            .content-line { font-size: 14px; }
            table { font-size: 14px; }
        }
        /* Additional CSS provided by user */
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f1f1f1;
            line-height: 1.6;
            transition: background-color 0.3s, color 0.3s;
        }
        .white-bg { background-color: #ffffff; color: #333; }
        .grey-bg { background-color: #e0e0e0; color: #333; }
        .black-bg { background-color: #1a1a1a; color: #ffffff; }
        .bg-switcher {
            position: fixed;
            top: 10px;
            right: 10px;
            z-index: 1000;
            font-size: 16px;
        }
        .bg-switcher label { 
            margin-right: 10px; 
            color: inherit;
        }
        .bg-switcher select {
            padding: 5px;
            border-radius: 5px;
            background-color: #04AA6D;
            color: white;
            border: none;
            cursor: pointer;
        }
        .bg-switcher select:focus {
            outline: 2px solid #059862;
        }
        .sidebar {
            width: 250px;
            background-color: #04AA6D;
            position: fixed;
            top: 0;
            left: 0;
            height: 100%;
            padding-top: 20px;
            color: white;
            overflow-y: auto;
        }
        .sidebar-title {
            font-size: 24px;
            text-align: center;
            margin-bottom: 30px;
        }
        .sidebar-link {
            display: block;
            padding: 12px 20px;
            color: white;
            text-decoration: none;
            font-size: 18px;
            transition: background-color 0.3s;
        }
        .sidebar-link:hover { background-color: #059862; }
        .sidebar-link:focus {
            outline: 2px solid white;
        }
        .main-content { 
            margin-left: 270px; 
            padding: 30px; 
        }
        .header {
            background-color: #282A35;
            color: white;
            padding: 20px;
            text-align: center;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .header-title { font-size: 36px; margin: 0; }
        .header-subtitle { font-size: 18px; margin-top: 10px; }
        .section {
            margin: 20px 0;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .white-bg .section { background-color: #f9f9f9; }
        .grey-bg .section { background-color: #d0d0d0; }
        .black-bg .section { background-color: #2a2a2a; }
        .section-title { font-size: 28px; color: #04AA6D; margin-bottom: 15px; }
        .subsection-title { font-size: 22px; margin: 15px 0 10px; color: inherit; }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            background-color: #ffffff;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            overflow-x: auto;
        }
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #04AA6D;
            color: white;
            font-weight: bold;
        }
        tr:nth-child(even) { background-color: #f9f9f9; }
        tr:hover { background-color: #f1f1f1; }
        .content-line {
            font-size: 16px;
            margin: 8px 0;
            padding: 10px;
            border-left: 4px solid #04AA6D;
        }
        .white-bg .content-line { background-color: #f0f0f0; }
        .grey-bg .content-line { background-color: #c0c0c0; }
        .black-bg .content-line { background-color: #333333; }
        .code-block {
            padding: 15px;
            border-radius: 5px;
            font-family: 'Courier New', Courier, monospace;
            font-size: 14px;
            overflow-x: auto;
            margin: 10px 0;
        }
        .white-bg .code-block { background-color: #282A35; color: white; }
        .grey-bg .code-block { background-color: #3a3a3a; color: white; }
        .black-bg .code-block { background-color: #ffffff; color: #333; }
        .code-block::-webkit-scrollbar {
            height: 8px;
        }
        .code-block::-webkit-scrollbar-thumb {
            background-color: #04AA6D;
            border-radius: 4px;
        }
        .code-block::-webkit-scrollbar-track {
            background-color: #f1f1f1;
        }
        .highlight { color: #000000; font-weight: bold; }
        strong { font-weight: bold; }
        a { color: #04AA6D; text-decoration: none; }
        a:hover { text-decoration: underline; }
        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
                height: auto;
                position: relative;
            }
            .main-content {
                margin-left: 0;
            }
        }
    </style>
</head>
<body class="white-bg">
    <div class="bg-switcher">
        <label for="bg-select">Background:</label>
        <select id="bg-select" onchange="changeBackground()">
            <option value="white-bg">White</option>
            <option value="grey-bg">Grey</option>
            <option value="black-bg">Black</option>
        </select>
    </div>

    <div class="sidebar">
        <div class="sidebar-title">Spring Security Notes</div>
        <a href="#section-1" class="sidebar-link">1. Importance of Security</a>
        <a href="#section-2" class="sidebar-link">2. OWASP Top 10</a>
        <a href="#section-3" class="sidebar-link">3. Creating a Project</a>
        <a href="#section-4" class="sidebar-link">4. Default Login Form</a>
        <a href="#section-5" class="sidebar-link">5. Security Filters</a>
        <a href="#section-6" class="sidebar-link">6. Session Management</a>
        <a href="#section-7" class="sidebar-link">7. Setting Credentials</a>
        <a href="#section-8" class="sidebar-link">8. Basic Authentication</a>
        <a href="#section-9" class="sidebar-link">9. CSRF</a>
        <a href="#section-10" class="sidebar-link">10. CSRF Protection</a>
        <a href="#section-11" class="sidebar-link">11. SameSite & Stateless</a>
        <a href="#section-12" class="sidebar-link">12. Custom Configuration</a>
        <a href="#section-13" class="sidebar-link">13. Imperative Config</a>
        <a href="#section-14" class="sidebar-link">14. In-Memory Auth</a>
        <a href="#section-15" class="sidebar-link">15. Database Auth</a>
        <a href="#section-16" class="sidebar-link">16. Registration & Bcrypt</a>
        <a href="#section-17" class="sidebar-link">17. Best Practices</a>
        <a href="#references" class="sidebar-link">References</a>
    </div>

    <div class="main-content">
        <div class="header">
            <h1 class="header-title">Spring Security Comprehensive Notes</h1>
            <p class="header-subtitle">For Beginners and Intermediate Learners</p>
        </div>

        <div class="section" id="intro">
            <p class="content-line">This document consolidates comprehensive notes on <span class="highlight">Spring Security</span>, tailored for fresher and intermediate-level developers. It covers all concepts, including fundamentals, <span class="highlight">OWASP Top 10</span>, <span class="highlight">CSRF</span>, <span class="highlight">session management</span>, <span class="highlight">authentication</span>, and password encoding with <span class="highlight">Bcrypt</span>. The notes include live examples, code snippets from the GitHub repository (<a href="https://github.com/navinreddy20/spring6-course">https://github.com/navinreddy20/spring6-course</a>), and explanations in comments for clarity. Each topic is explained in simple terms, with examples aligned to the concepts, ensuring accessibility for beginners while providing depth for intermediate learners. References to Telusko’s YouTube channel are incorporated for additional context.</p>
        </div>

        <div class="section" id="section-1">
            <h2 class="section-title">1. Importance of Security in Application Development</h2>
            <h3 class="subsection-title">Concept Overview</h3>
            <p class="content-line"><span class="highlight">Security</span> in application development is like locking the doors of your house to keep intruders out. Developers often prioritize <span class="highlight">functionality</span> (making the app work), <span class="highlight">stability</span> (handling errors), and <span class="highlight">performance</span> (ensuring speed), but <span class="highlight">security</span> is equally critical. It ensures only <span class="highlight">authorized users</span> access specific features and protects <span class="highlight">sensitive data</span>—like usernames, passwords, credit card details, or medical records—from hackers. Without security, a single vulnerability can lead to data breaches, financial loss, or legal consequences. For example, in a job portal, anyone can search jobs, but only admins should post or delete them. <span class="highlight">Authentication</span> (verifying who you are) and <span class="highlight">authorization</span> (deciding what you can do) are the core pillars, ensuring only the right people access the right resources. Enterprise applications may have dedicated security teams, but developers must understand security basics to build robust systems.</p>
            <h3 class="subsection-title">Key Points</h3>
            <p class="content-line"><span class="highlight">Functionality</span>: Ensures the app works (e.g., job search in a portal).</p>
            <p class="content-line"><span class="highlight">Stability</span>: Handles errors gracefully (e.g., invalid inputs don’t crash the app).</p>
            <p class="content-line"><span class="highlight">Performance</span>: Ensures fast responses (e.g., quick job search results).</p>
            <p class="content-line"><span class="highlight">Security</span>: Protects data and restricts access (e.g., only admins post jobs).</p>
            <p class="content-line"><span class="highlight">Authentication</span>: Verifies identity (e.g., username/password login).</p>
            <p class="content-line"><span class="highlight">Authorization</span>: Controls permissions (e.g., admins can delete jobs, users cannot).</p>
            <p class="content-line"><span class="highlight">Data Sensitivity</span>: Apps with sensitive data (e.g., medical records, credit cards) need robust security to avoid penalties or legal issues.</p>
            <h3 class="subsection-title">Example</h3>
            <p class="content-line">In a job portal, anyone can view job listings, but only authenticated admins should create or delete jobs. Without <span class="highlight">security</span>, a hacker could access the admin panel and post fraudulent jobs, misleading users. <span class="highlight">Spring Security</span> ensures only verified admins with correct credentials can perform these actions.</p>
            <h3 class="subsection-title">Live Example</h3>
            <p class="content-line">Without <span class="highlight">security</span>, accessing localhost:8080/admin/createJob allows anyone to post a job, which is dangerous. After adding <span class="highlight">Spring Security</span>, this URL requires admin login, ensuring only <span class="highlight">authorized users</span> can access it, protecting the portal from unauthorized actions.</p>
        </div>

        <div class="section" id="section-2">
            <h2 class="section-title">2. OWASP Top 10 Security Risks</h2>
            <h3 class="subsection-title">Concept Overview</h3>
            <p class="content-line">The <span class="highlight">OWASP Top 10</span> is a “most wanted” list of the top security threats to web applications, published by the Open Web Application Security Project (OWASP), updated every four years (last in 2021). It’s a guide to the most common ways hackers exploit apps, helping developers strengthen their systems. For beginners, it’s like learning the weak spots in a fortress; for intermediate learners, it’s a checklist to secure apps. <span class="highlight">Spring Security</span> addresses many risks, such as <span class="highlight">broken access control</span> and <span class="highlight">authentication failures</span>, with tools for secure authentication, authorization, and data protection.</p>
            <h3 class="subsection-title">Key OWASP Top 10 Risks</h3>
            <table>
                <tr><th>Risk</th><th>Description</th></tr>
                <tr><td><span class="highlight">Broken Access Control</span></td><td>Users access restricted resources (e.g., a user deleting admin-only data).</td></tr>
                <tr><td><span class="highlight">Cryptographic Failures</span></td><td>Weak encryption exposes data (e.g., storing passwords as plain text or using MD5).</td></tr>
                <tr><td><span class="highlight">Injection</span></td><td>Malicious code is inserted into inputs (e.g., SQL injection to bypass login).</td></tr>
                <tr><td>Insecure Design</td><td>Flawed app design creates vulnerabilities.</td></tr>
                <tr><td>Security Misconfiguration</td><td>Default settings expose weaknesses (e.g., unchanged admin passwords).</td></tr>
                <tr><td>Vulnerable and Outdated Components</td><td>Old libraries with known issues.</td></tr>
                <tr><td><span class="highlight">Identification and Authentication Failures</span></td><td>Weak passwords or no multi-factor authentication.</td></tr>
                <tr><td>Software and Data Integrity Failures</td><td>Unverified data compromises the app.</td></tr>
                <tr><td>Security Logging and Monitoring Failures</td><td>Missing logs to detect attacks.</td></tr>
                <tr><td>Server-Side Request Forgery (SSRF)</td><td>Server makes unauthorized requests.</td></tr>
            </table>
            <h3 class="subsection-title">Example</h3>
            <p class="content-line">In a job portal, a <span class="highlight">SQL injection</span> attack could let a hacker bypass login by entering admin' OR '1'='1 as a username, tricking the database into granting access. <span class="highlight">Spring Security</span>’s prepared statements prevent this by treating inputs as data, not executable code.</p>
            <h3 class="subsection-title">Live Example</h3>
            <p class="content-line">Without <span class="highlight">security</span>, a login form accepting admin' OR '1'='1 grants unauthorized access. With <span class="highlight">Spring Security</span>, such inputs are sanitized, and the login fails, protecting the system from <span class="highlight">injection</span> attacks.</p>
        </div>

        <div class="section" id="section-3">
            <h2 class="section-title">3. Creating a Spring Security Project</h2>
            <h3 class="subsection-title">Concept Overview</h3>
            <p class="content-line">Creating a <span class="highlight">Spring Security</span> project is like installing a security system in your house. <span class="highlight">Spring Security</span> is a powerful framework that adds <span class="highlight">authentication</span> (locks) and <span class="highlight">authorization</span> (access rules) to Spring-based apps. By adding the <span class="highlight">Spring Security</span> dependency, your app gets a default login page that protects all URLs, like a guard at the entrance. For beginners, this is exciting because minimal setup provides strong security. Intermediate learners can customize this setup to allow public access to certain pages or add role-based access.</p>
            <h3 class="subsection-title">Steps to Create a Project</h3>
            <p class="content-line">Go to <span class="highlight">Spring Initializr</span> (start.spring.io).</p>
            <p class="content-line">Select Maven, Java 21, and add dependencies: <span class="highlight">Spring Web</span>, <span class="highlight">Spring Security</span>, Spring Boot DevTools.</p>
            <p class="content-line">Set group ID com.co, artifact ID spring-seq-demo.</p>
            <p class="content-line">Generate, unzip, and open in an IDE (e.g., IntelliJ IDEA).</p>
            <p class="content-line">Create a REST controller to test endpoints.</p>
            <h3 class="subsection-title">Code Example: HelloController</h3>
            <pre class="code-block">package com.co;

import org.springframework.web.bind.annotation.<span class="highlight">GetMapping</span>;
import org.springframework.web.bind.annotation.<span class="highlight">RestController</span>;

@RestController
public class HelloController {

    // Maps GET request to /hello, returns "Hello World"
    @GetMapping("/hello")
    public String greet() {
        return "Hello World";
    }

    // Maps GET request to /about, returns "Telusko"
    @GetMapping("/about")
    public String about() {
        return "Telusko";
    }
}</pre>
            <h3 class="subsection-title">Explanation</h3>
            <p class="content-line"><span class="highlight">@RestController</span>: Marks the class as a REST controller, returning JSON/text responses.</p>
            <p class="content-line"><span class="highlight">@GetMapping</span>: Maps HTTP GET requests to specific endpoints (/hello and /about).</p>
            <p class="content-line">Without <span class="highlight">Spring Security</span>, anyone can access these endpoints.</p>
            <p class="content-line">Adding <span class="highlight">spring-boot-starter-security</span> enables a default login form, requiring <span class="highlight">authentication</span>.</p>
            <h3 class="subsection-title">Live Example</h3>
            <p class="content-line">Before <span class="highlight">Spring Security</span>, localhost:8080/hello shows "Hello World". After adding the dependency, the URL displays a login form with default credentials (username: user, password in console). This shows how <span class="highlight">Spring Security</span> instantly secures the app with minimal setup.</p>
        </div>

        <div class="section" id="section-4">
            <h2 class="section-title">4. Default Login Form in Spring Security</h2>
            <h3 class="subsection-title">Concept Overview</h3>
            <p class="content-line"><span class="highlight">Spring Security</span>’s default login form is a pre-installed gatekeeper for your app. When you add the <span class="highlight">Spring Security</span> dependency, it automatically protects all URLs with a login page, no coding required. Think of it as a temporary password lock on your phone—you can use it right away but will customize it later. The default username is user, and a random password is generated each time the app starts, shown in the console. This form supports <span class="highlight">logout</span> and <span class="highlight">session management</span>, making it beginner-friendly yet powerful.</p>
            <h3 class="subsection-title">Key Features</h3>
            <p class="content-line">Default Credentials: Username user, password in console.</p>
            <p class="content-line"><span class="highlight">Session Management</span>: A session ID is created after login, allowing access to multiple URLs without re-entering credentials.</p>
            <p class="content-line"><span class="highlight">Logout</span>: A /logout URL logs out the user, ending the session.</p>
            <h3 class="subsection-title">Live Example</h3>
            <p class="content-line">After adding <span class="highlight">Spring Security</span>, localhost:8080/hello shows a login form. Entering user and the console password (e.g., a1b2c3) grants access to "Hello World". Incorrect credentials show a “Bad Credentials” error. Accessing localhost:8080/<span class="highlight">logout</span> logs out the user, requiring login again, demonstrating the default form’s functionality.</p>
        </div>

        <div class="section" id="section-5">
            <h2 class="section-title">5. Spring Security Filters</h2>
            <h3 class="subsection-title">Concept Overview</h3>
            <p class="content-line"><span class="highlight">Spring Security filters</span> are checkpoints that process incoming requests before they reach your app’s controllers, like security guards at an airport checking IDs and bags. These filters form a <span class="highlight">filter chain</span>, applied automatically by <span class="highlight">Spring Security</span>. For beginners, think of filters as a sequence of checks (e.g., is the user logged in? Is the request safe?). Intermediate learners can customize the filter chain to control request processing, such as enabling <span class="highlight">CSRF protection</span> or handling <span class="highlight">logout</span>.</p>
            <h3 class="subsection-title">Key Filters</h3>
            <p class="content-line"><span class="highlight">SecurityContextPersistenceFilter</span>: Stores user details between requests.</p>
            <p class="content-line"><span class="highlight">UsernamePasswordAuthenticationFilter</span>: Checks username/password for login.</p>
            <p class="content-line"><span class="highlight">CsrfFilter</span>: Ensures POST requests include a CSRF token.</p>
            <p class="content-line"><span class="highlight">LogoutFilter</span>: Handles logout requests.</p>
            <h3 class="subsection-title">Live Example</h3>
            <p class="content-line">When the app starts, the console logs the <span class="highlight">filter chain</span>, including <span class="highlight">CsrfFilter</span> and <span class="highlight">UsernamePasswordAuthenticationFilter</span>. Accessing localhost:8080/hello triggers these filters, which check for <span class="highlight">authentication</span> and redirect to the login page if needed. A POST request without a <span class="highlight">CSRF token</span> fails, showing the <span class="highlight">CsrfFilter</span> in action.</p>
        </div>

        <div class="section" id="section-6">
            <h2 class="section-title">6. Session Management and Session ID</h2>
            <h3 class="subsection-title">Concept Overview</h3>
            <p class="content-line">A <span class="highlight">session</span> in <span class="highlight">Spring Security</span> is a temporary visitor pass. After logging in, the server gives your browser a unique <span class="highlight">session ID</span> (stored in a cookie), acting as proof you’re authorized. You show this pass for each request, so you don’t need to log in repeatedly. For beginners, think of it as a wristband at a concert—once you’re in, you can move around until you leave. Intermediate learners should note that sessions improve performance but require careful management to prevent risks like <span class="highlight">session hijacking</span>.</p>
            <h3 class="subsection-title">Code Example: Printing Session ID</h3>
            <pre class="code-block">package com.co;

import jakarta.servlet.http.HttpServletRequest;
import org.springframework.web.bind.annotation.<span class="highlight">GetMapping</span>;
import org.springframework.web.bind.annotation.<span class="highlight">RestController</span>;

@RestController
public class HelloController {

    // Maps GET request to /hello, returns "Hello World" with session ID
    @GetMapping("/hello")
    public String greet(HttpServletRequest request) {
        return "Hello World " + request.getSession().<span class="highlight">getId()</span>;
    }

    // Maps GET request to /about, returns "Telusko" with session ID
    @GetMapping("/about")
    public String about(HttpServletRequest request) {
        return "Telusko " + request.getSession().<span class="highlight">getId()</span>;
    }
}</pre>
            <h3 class="subsection-title">Explanation</h3>
            <p class="content-line"><span class="highlight">HttpServletRequest</span>: Provides access to the session via getSession().getId().</p>
            <p class="content-line"><span class="highlight">Session ID</span>: Appended to responses to demonstrate session persistence.</p>
            <p class="content-line">The same <span class="highlight">session ID</span> appears for /hello and /about until logout, showing session continuity.</p>
            <h3 class="subsection-title">Live Example</h3>
            <p class="content-line">After logging in, localhost:8080/hello shows “Hello World 1234” (where 1234 is the <span class="highlight">session ID</span>). Accessing localhost:8080/about shows “Telusko 1234”, confirming the same <span class="highlight">session</span>. Logging out via /<span class="highlight">logout</span> and logging in again generates a new <span class="highlight">session ID</span> (e.g., 5678), demonstrating <span class="highlight">session management</span>.</p>
        </div>

        <div class="section" id="section-7">
            <h2 class="section-title">7. Setting Username and Password</h2>
            <h3 class="subsection-title">Concept Overview</h3>
            <p class="content-line">The default user and random password are like a temporary key, useful for testing but impractical for real use. <span class="highlight">Spring Security</span> lets you set a custom <span class="highlight">username</span> and <span class="highlight">password</span> in the application.properties file, like changing the default lock on a house. This is a simple way to secure your app, but it’s limited to one user and stores passwords in plain text, which is unsafe for production. Beginners can think of this as a basic lock; intermediate learners should recognize the need for secure storage (e.g., <span class="highlight">Bcrypt</span>) and multiple users.</p>
            <h3 class="subsection-title">Code Example: application.properties</h3>
            <pre class="code-block"># Configures custom username and password
spring.security.user.<span class="highlight">name</span>=telusko
spring.security.user.<span class="highlight">password</span>=1234</pre>
            <h3 class="subsection-title">Explanation</h3>
            <p class="content-line">spring.security.user.<span class="highlight">name</span>: Sets the username to telusko.</p>
            <p class="content-line">spring.security.user.<span class="highlight">password</span>: Sets the password to 1234.</p>
            <p class="content-line">These properties override the default user and console-generated password.</p>
            <h3 class="subsection-title">Live Example</h3>
            <p class="content-line">After adding these properties, localhost:8080/hello prompts a login form. Entering <span class="highlight">telusko</span> and <span class="highlight">1234</span> grants access to “Hello World”. The default user and console password no longer work, showing the new credentials are active.</p>
            <h3 class="subsection-title">Drawbacks</h3>
            <p class="content-line">Hardcoding credentials restricts the app to one user.</p>
            <p class="content-line">Plain-text passwords are insecure and unsuitable for production.</p>
        </div>

        <div class="section" id="section-8">
            <h2 class="section-title">8. Basic Authentication Using Postman</h2>
            <h3 class="subsection-title">Concept Overview</h3>
            <p class="content-line"><span class="highlight">Basic Authentication</span> is like showing an ID card to access a restricted area. Instead of a login form, the client (e.g., Postman or a mobile app) sends a <span class="highlight">username</span> and <span class="highlight">password</span> in the request’s <span class="highlight">Authorization header</span>. For beginners, think of it as a secret handshake to enter a club. It’s ideal for REST APIs where a form isn’t practical, but passwords are sent in plain text, so <span class="highlight">HTTPS</span> is needed for security. <span class="highlight">Spring Security</span> supports <span class="highlight">Basic Auth</span> automatically, making it easy to test APIs.</p>
            <h3 class="subsection-title">Live Example</h3>
            <p class="content-line">In Postman, a GET request to localhost:8080/hello without credentials returns a <span class="highlight">401 Unauthorized</span> error. Under the Authorization tab, selecting <span class="highlight">Basic Auth</span> and entering <span class="highlight">telusko</span> and <span class="highlight">1234</span> results in a 200 OK response with “Hello World”. The same credentials work for /about, showing session reuse, demonstrating <span class="highlight">Basic Auth</span>’s simplicity for API testing.</p>
        </div>

        <div class="section" id="section-9">
            <h2 class="section-title">9. Cross-Site Request Forgery (CSRF)</h2>
            <h3 class="subsection-title">Concept Overview</h3>
            <p class="content-line"><span class="highlight">CSRF</span> (Cross-Site Request Forgery) is a prankster tricking you into doing something unintended. Imagine you’re logged into your bank’s website, and a malicious site you visit secretly sends a request to transfer money using your <span class="highlight">session cookie</span>. <span class="highlight">CSRF attacks</span> exploit the trust a site has in your browser. <span class="highlight">Spring Security</span> prevents this by requiring a <span class="highlight">CSRF token</span> for non-GET requests (e.g., POST, PUT), like a secret code only the real site knows. For beginners, the token is a special ticket for sensitive actions; intermediate learners should note that <span class="highlight">CSRF protection</span> is enabled by default for POST requests.</p>
            <h3 class="subsection-title">Key Points</h3>
            <p class="content-line"><span class="highlight">CSRF Token</span>: A unique code sent with POST, PUT, DELETE requests.</p>
            <p class="content-line">Default Protection: Enabled for non-GET requests, not GET.</p>
            <p class="content-line">Mitigation: Use <span class="highlight">CSRF tokens</span> or set cookies to <span class="highlight">SameSite=Strict</span>.</p>
            <h3 class="subsection-title">Live Example</h3>
            <p class="content-line">A POST request to /students in Postman without a <span class="highlight">CSRF token</span> fails with a <span class="highlight">401 error</span>, as <span class="highlight">Spring Security</span>’s <span class="highlight">CsrfFilter</span> blocks it. After fetching the token from /csrf-token and including it in the header, the request succeeds, adding a student, showing how <span class="highlight">CSRF protection</span> safeguards sensitive actions.</p>
        </div>

        <div class="section" id="section-10">
            <h2 class="section-title">10. Implementing CSRF Protection</h2>
            <h3 class="subsection-title">Concept Overview</h3>
            <p class="content-line">Implementing <span class="highlight">CSRF protection</span> is like adding a security code to credit card transactions. <span class="highlight">Spring Security</span> generates a <span class="highlight">CSRF token</span> for each session, which must be included in non-GET requests. You can create an endpoint to fetch this token, which clients (e.g., a web app) include in their requests. Alternatively, setting cookies to <span class="highlight">SameSite=Strict</span> ensures only the original site can send cookies, blocking malicious sites. Beginners can think of this as a double-check for request legitimacy; intermediate learners should balance security and usability.</p>
            <h3 class="subsection-title">Code Example: StudentController</h3>
            <pre class="code-block">package com.co;

import lombok.Data;
import org.springframework.web.bind.annotation.<span class="highlight">GetMapping</span>;
import org.springframework.web.bind.annotation.<span class="highlight">PostMapping</span>;
import org.springframework.web.bind.annotation.<span class="highlight">RestController</span>;
import java.util.ArrayList;
import java.util.List;

@RestController
public class StudentController {

    // Static list to store students
    private static final List<Student> students = new ArrayList<>(List.of(
            new Student(1, "Naveen", "Java"),
            new Student(2, "Kiran", "Blockchain")
    ));

    // Maps GET request to /students, returns all students
    @GetMapping("/students")
    public List<Student> getStudents() {
        return students;
    }

    // Maps POST request to /students, adds a new student
    @PostMapping("/students")
    public void addStudent(@RequestBody Student student) {
        students.add(student);
    }

    // Maps GET request to /csrf-token, returns CSRF token
    @GetMapping("/csrf-token")
    public <span class="highlight">CsrfToken</span> getCsrfToken(HttpServletRequest request) {
        return (CsrfToken) request.getAttribute("_csrf");
    }
}

// Student model class using Lombok for getters, setters, and constructors
@Data
public class Student {
    private int id;
    private String name;
    private String technology;

    public Student(int id, String name, String technology) {
        this.id = id;
        this.name = name;
        this.technology = technology;
    }
}</pre>
            <h3 class="subsection-title">Explanation</h3>
            <p class="content-line"><span class="highlight">@PostMapping("/students")</span>: Adds a student, requiring a <span class="highlight">CSRF token</span> for POST requests.</p>
            <p class="content-line"><span class="highlight">@GetMapping("/csrf-token")</span>: Retrieves the <span class="highlight">CSRF token</span> from the request attribute _csrf.</p>
            <p class="content-line"><span class="highlight">Lombok @Data</span>: Generates boilerplate code for the Student class.</p>
            <p class="content-line">The controller manages a list of students, with endpoints for retrieval, addition, and token fetching.</p>
            <h3 class="subsection-title">Live Example</h3>
            <p class="content-line">In Postman, a POST to /students without a <span class="highlight">CSRF token</span> fails (<span class="highlight">401</span>). Sending a GET to /csrf-token returns a token (e.g., abc123), which is added to the POST request’s <span class="highlight">X-CSRF-TOKEN</span> header. The request succeeds, adding a student (e.g., {id: 3, name: "Avni", technology: "Python"}), showing how <span class="highlight">CSRF tokens</span> protect POST requests.</p>
        </div>

        <div class="section" id="section-11">
            <h2 class="section-title">11. SameSite Strict and Stateless APIs</h2>
            <h3 class="subsection-title">Concept Overview</h3>
            <p class="content-line">The <span class="highlight">SameSite</span> cookie attribute is a rule telling your browser which websites can use your <span class="highlight">session cookie</span>. Setting it to <span class="highlight">Strict</span> ensures only the original site can send the cookie, preventing <span class="highlight">CSRF attacks</span> from other sites. For <span class="highlight">stateless APIs</span>, each request is a one-time visitor showing their ID—no session is saved, so <span class="highlight">CSRF tokens</span> aren’t needed. Beginners can imagine stateless APIs as a ticket booth requiring a new ticket for each ride; intermediate learners should note that statelessness simplifies scaling but requires credentials in every request.</p>
            <h3 class="subsection-title">Code Example: application.properties</h3>
            <pre class="code-block"># Restricts cookies to the same site
server.servlet.session.cookie.<span class="highlight">same-site</span>=strict</pre>
            <h3 class="subsection-title">Explanation</h3>
            <p class="content-line">The property sets the <span class="highlight">SameSite</span> attribute to Strict, blocking cross-site cookie access.</p>
            <p class="content-line">This mitigates <span class="highlight">CSRF attacks</span> by ensuring cookies are only sent to the originating site.</p>
            <h3 class="subsection-title">Live Example</h3>
            <p class="content-line">With <span class="highlight">SameSite=Strict</span>, a malicious site can’t use your app’s <span class="highlight">session cookie</span>, blocking <span class="highlight">CSRF attacks</span>. For a <span class="highlight">stateless API</span>, a POST to /students in Postman with <span class="highlight">Basic Auth</span> (telusko, 1234) succeeds without a <span class="highlight">CSRF token</span>, as no session is maintained, showing how <span class="highlight">stateless APIs</span> simplify security for REST clients.</p>
        </div>

        <div class="section" id="section-12">
            <h2 class="section-title">12. Custom Security Configuration</h2>
            <h3 class="subsection-title">Concept Overview</h3>
            <p class="content-line">Customizing <span class="highlight">Spring Security</span> is like designing your own security system instead of using the default one. By creating a configuration class with <span class="highlight">@EnableWebSecurity</span>, you can control <span class="highlight">authentication</span>, <span class="highlight">authorization</span>, and <span class="highlight">session</span> behavior. For beginners, think of it as setting rules for who can enter your house and what they can do. You might disable <span class="highlight">CSRF</span> for APIs, enable form login for web apps, or make the app <span class="highlight">stateless</span>. Intermediate learners can fine-tune settings, such as allowing public access to certain URLs or requiring specific roles.</p>
            <h3 class="subsection-title">Code Example: SecurityConfig (Lambda Style)</h3>
            <pre class="code-block">package com.co.config;

import org.springframework.context.annotation.<span class="highlight">Bean</span>;
import org.springframework.context.annotation.<span class="highlight">Configuration</span>;
import org.springframework.security.config.annotation.web.configuration.<span class="highlight">EnableWebSecurity</span>;
import org.springframework.security.config.http.<span class="highlight">SessionCreationPolicy</span>;
import org.springframework.security.web.<span class="highlight">SecurityFilterChain</span>;
import static org.springframework.security.config.Customizer.withDefaults;

@Configuration
@EnableWebSecurity
public class SecurityConfig {

    // Defines custom security configuration
    @Bean
    public SecurityFilterChain <span class="highlight">securityFilterChain</span>(HttpSecurity http) throws Exception {
        http
                .csrf(csrf -> csrf.<span class="highlight">disable()</span>) // Disables CSRF protection for stateless APIs
                .authorizeHttpRequests(auth -> auth.anyRequest().authenticated()) // Requires authentication for all requests
                .formLogin(withDefaults()) // Enables default form-based login
                .httpBasic(withDefaults()) // Enables Basic Authentication for REST clients
                .sessionManagement(session -> session.sessionCreationPolicy(SessionCreationPolicy.<span class="highlight">STATELESS</span>)); // Sets stateless session policy
        return http.build();
    }
}</pre>
            <h3 class="subsection-title">Explanation</h3>
            <p class="content-line"><span class="highlight">@EnableWebSecurity</span>: Activates Spring Security customization.</p>
            <p class="content-line"><span class="highlight">SecurityFilterChain</span>: Defines the filter chain configuration.</p>
            <p class="content-line">csrf.<span class="highlight">disable()</span>: Disables CSRF for stateless APIs.</p>
            <p class="content-line">authorizeHttpRequests: Requires <span class="highlight">authentication</span> for all requests.</p>
            <p class="content-line">formLogin: Enables the default login form.</p>
            <p class="content-line">httpBasic: Supports <span class="highlight">Basic Authentication</span> for REST clients.</p>
            <p class="content-line">sessionCreationPolicy: Sets the app to <span class="highlight">stateless</span>, creating a new session per request.</p>
            <h3 class="subsection-title">Live Example</h3>
            <p class="content-line">With this configuration, localhost:8080/hello prompts a <span class="highlight">Basic Auth</span> pop-up due to httpBasic. In Postman, a GET to /hello with <span class="highlight">Basic Auth</span> (telusko, 1234) succeeds without a <span class="highlight">CSRF token</span>, as the app is <span class="highlight">stateless</span>, showing how custom configurations tailor security.</p>
        </div>

        <div class="section" id="section-13">
            <h2 class="section-title">13. Imperative Security Configuration</h2>
            <h3 class="subsection-title">Concept Overview</h3>
            <p class="content-line">The <span class="highlight">imperative configuration</span> style is like writing detailed instructions for your security system, step by step. It’s more verbose than the lambda style but clearer for beginners because it explicitly shows each setting. Think of it as filling out a form where you check boxes for each security feature (e.g., disable <span class="highlight">CSRF</span>, enable login). Intermediate learners may prefer the lambda style for brevity but should understand both, as <span class="highlight">imperative</span> is common in older codebases.</p>
            <h3 class="subsection-title">Code Example: SecurityConfig (Imperative Style)</h3>
            <pre class="code-block">package com.co.config;

import org.springframework.context.annotation.<span class="highlight">Bean</span>;
import org.springframework.context.annotation.<span class="highlight">Configuration</span>;
import org.springframework.security.config.annotation.web.configuration.<span class="highlight">EnableWebSecurity</span>;
import org.springframework.security.config.http.<span class="highlight">SessionCreationPolicy</span>;
import org.springframework.security.web.<span class="highlight">SecurityFilterChain</span>;

@Configuration
@EnableWebSecurity
public class SecurityConfig {

    // Defines custom security configuration using imperative style
    @Bean
    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {
        // Disable CSRF
        Customizer<CsrfConfigurer<HttpSecurity>> custCsrf = new Customizer<>() {
            @Override
            public void customize(CsrfConfigurer<HttpSecurity> configurer) {
                configurer.<span class="highlight">disable()</span>;
            }
        };
        http.csrf(custCsrf);

        // Require authentication for all requests
        Customizer<AuthorizeHttpRequestsConfigurer<HttpSecurity>.AuthorizationManagerRequestMatcherRegistry> custAuth =
                new Customizer<>() {
                    @Override
                    public void customize(AuthorizeHttpRequestsConfigurer<HttpSecurity>.AuthorizationManagerRequestMatcherRegistry registry) {
                        registry.anyRequest().authenticated();
                    }
                };
        http.authorizeHttpRequests(custAuth);

        // Enable form login and Basic Authentication
        http.formLogin(withDefaults()).httpBasic(withDefaults());

        // Configure stateless session
        Customizer<SessionManagementConfigurer<HttpSecurity>> custSession = new Customizer<>() {
            @Override
            public void customize(SessionManagementConfigurer<HttpSecurity> session) {
                session.sessionCreationPolicy(SessionCreationPolicy.<span class="highlight">STATELESS</span>);
            }
        };
        http.sessionManagement(custSession);

        return http.build();
    }
}</pre>
            <h3 class="subsection-title">Explanation</h3>
            <p class="content-line"><span class="highlight">Customizer</span>: Defines configuration for CSRF, authorization, and session management using anonymous inner classes.</p>
            <p class="content-line">csrf.<span class="highlight">disable()</span>: Disables CSRF protection.</p>
            <p class="content-line">anyRequest().authenticated(): Ensures all requests require <span class="highlight">authentication</span>.</p>
            <p class="content-line">formLogin and httpBasic: Enable default form and <span class="highlight">Basic Authentication</span>.</p>
            <p class="content-line">sessionCreationPolicy: Sets <span class="highlight">stateless</span> session management.</p>
            <p class="content-line">The result is identical to the lambda style but more verbose.</p>
            <h3 class="subsection-title">Live Example</h3>
            <p class="content-line">The <span class="highlight">imperative configuration</span> produces the same result as the lambda style. A GET to localhost:8080/hello in Postman with <span class="highlight">Basic Auth</span> (telusko, 1234) succeeds without a <span class="highlight">CSRF token</span>, confirming the <span class="highlight">stateless</span> setup, showing both styles achieve identical security outcomes.</p>
        </div>

        <div class="section" id="section-14">
            <h2 class="section-title">14. Multiple Users with In-Memory Authentication</h2>
            <h3 class="subsection-title">Concept Overview</h3>
            <p class="content-line">Supporting multiple users is like issuing ID cards to different employees, each with specific access rights. Instead of one hardcoded user in application.properties, <span class="highlight">Spring Security</span>’s <span class="highlight">InMemoryUserDetailsManager</span> stores multiple users in memory, like a temporary list of authorized people. For beginners, this is a simple way to test <span class="highlight">authentication</span> without a database. Intermediate learners should note that in-memory storage is not scalable for production but useful for prototyping or small apps.</p>
            <h3 class="subsection-title">Code Example: Security glfw:1.0.2
            <pre class="code-block">package com.co.config;

import org.springframework.context.annotation.<span class="highlight">Bean</span>;
import org.springframework.context.annotation.<span class="highlight">Configuration</span>;
import org.springframework.security.config.annotation.web.configuration.<span class="highlight">EnableWebSecurity</span>;
import org.springframework.security.core.userdetails.<span class="highlight">User</span>;
import org.springframework.security.core.userdetails.<span class="highlight">UserDetailsService</span>;
import org.springframework.security.provisioning.<span class="highlight">InMemoryUserDetailsManager</span>;
import org.springframework.security.web.<span class="highlight">SecurityFilterChain</span>;

@Configuration
@EnableWebSecurity
public class SecurityConfig {

    // Defines in-memory user details service
    @Bean
    public UserDetailsService userDetailsService() {
        // Create user "naveen" with password "n@123" and role "USER"
        var user = User
                .withDefaultPasswordEncoder()
                .username("naveen")
                .password("n@123")
                .roles("USER")
                .build();

        // Create user "admin" with password "admin@789" and role "ADMIN"
        var admin = User
                .withDefaultPasswordEncoder()
                .username("admin")
                .password("admin@789")
                .roles("ADMIN")
                .build();

        // Return InMemoryUserDetailsManager with multiple users
        return new InMemoryUserDetailsManager(user, admin);
    }

    @Bean
    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {
        http
                .csrf(csrf -> csrf.<span class="highlight">disable()</span>)
                .authorizeHttpRequests(auth -> auth.anyRequest().authenticated())
                .formLogin(withDefaults())
                .httpBasic(withDefaults())
                .sessionManagement(session -> session.sessionCreationPolicy(SessionCreationPolicy.<span class="highlight">STATELESS</span>));
        return http.build();
    }
}</pre>
            <h3 class="subsection-title">Explanation</h3>
            <p class="content-line"><span class="highlight">UserDetailsService</span>: Returns an <span class="highlight">InMemoryUserDetailsManager</span> with multiple users.</p>
            <p class="content-line"><span class="highlight">User.builder()</span>: Creates UserDetails objects with usernames, passwords, and roles.</p>
            <p class="content-line">withDefaultPasswordEncoder(): Uses a deprecated encoder for learning purposes (not for production).</p>
            <p class="content-line"><span class="highlight">InMemoryUserDetailsManager</span>: Stores user data in memory, supporting multiple users.</p>
            <h3 class="subsection-title">Live Example</h3>
            <p class="content-line">Accessing localhost:8080/hello with <span class="highlight">naveen</span> and n@123 or <span class="highlight">admin</span> and admin@789 succeeds, showing “Hello World”. The old telusko and 1234 credentials fail, confirming the in-memory users are active, demonstrating multiple-user support without a database.</p>
        </div>

        <div class="section" id="section-15">
            <h2 class="section-title">15. Database-Driven Authentication</h2>
            <h3 class="subsection-title">Concept Overview</h3>
            <p class="content-line">Storing users in a database is like keeping employee records in a secure filing cabinet instead of a temporary list. Real apps need scalable, persistent storage, so <span class="highlight">Spring Security</span> uses a <span class="highlight">UserDetailsService</span> to fetch users from a database via a repository. A <span class="highlight">UserPrincipal</span> class connects your custom User entity to <span class="highlight">Spring Security</span>’s <span class="highlight">authentication</span> system. For beginners, think of this as a library system where you look up a user’s details by their ID. Intermediate learners should understand that this approach supports dynamic user management and integrates with <span class="highlight">JPA</span> for database operations.</p>
            <h3 class="subsection-title">Code Example: User Entity</h3>
            <pre class="code-block">package com.co.model;

import jakarta.persistence.<span class="highlight">Entity</span>;
import jakarta.persistence.<span class="highlight">Id</span>;
import jakarta.persistence.<span class="highlight">Table</span>;
import lombok.Data;

@Data
@Entity
@Table(name = "users")
public class User {
    @Id
    private int id; // Primary key
    private String username; // User's username
    private String password; // User's password
}</pre>
            <h3 class="subsection-title">Code Example: UserRepo</h3>
            <pre class="code-block">package com.co.dao;

import com.co.model.User;
import org.springframework.data.jpa.repository.<span class="highlight">JpaRepository</span>;

public interface UserRepo extends JpaRepository<User, Integer> {
    // Finds a user by username
    User findByUsername(String username);
}</pre>
            <h3 class="subsection-title">Code Example: MyUserDetailsService</h3>
            <pre class="code-block">package com.co.service;

import com.co.dao.UserRepo;
import com.co.model.User;
import org.springframework.beans.factory.annotation.<span class="highlight">Autowired</span>;
import org.springframework.security.core.userdetails.<span class="highlight">UserDetails</span>;
import org.springframework.security.core.userdetails.<span class="highlight">UserDetailsService</span>;
import org.springframework.security.core.userdetails.<span class="highlight">UsernameNotFoundException</span>;
import org.springframework.stereotype.<span class="highlight">Service</span>;

@Service
public class MyUserDetailsService implements UserDetailsService {

    @Autowired
    private UserRepo userRepo; // Repository to query the database

    // Loads user by username from the database
    @Override
    public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {
        User user = userRepo.findByUsername(username);
        if (user == null) {
            throw new UsernameNotFoundException("User Not Found: " + username);
        }
        return new <span class="highlight">UserPrincipal</span>(user); // Wraps User in UserPrincipal
    }
}</pre>
            <h3 class="subsection-title">Code Example: UserPrincipal</h3>
            <pre class="code-block">package com.co.model;

import org.springframework.security.core.<span class="highlight">GrantedAuthority</span>;
import org.springframework.security.core.authority.<span class="highlight">SimpleGrantedAuthority</span>;
import org.springframework.security.core.userdetails.<span class="highlight">UserDetails</span>;
import java.util.Collection;
import java.util.Collections;

public class UserPrincipal implements UserDetails {

    private final User user; // Custom User entity

    // Constructor to initialize with User entity
    public UserPrincipal(User user) {
        this.user = user;
    }

    // Returns hardcoded "USER" role
    @Override
    public Collection<? extends GrantedAuthority> getAuthorities() {
        return Collections.singleton(new SimpleGrantedAuthority("USER"));
    }

    // Returns user's password
    @Override
    public String getPassword() {
        return user.getPassword();
    }

    // Returns user's username
    @Override
    public String getUsername() {
        return user.getUsername();
    }

    // Hardcoded account status checks (true for simplicity)
    @Override
    public boolean isAccountNonExpired() {
        return true;
    }

    @Override
    public boolean isAccountNonLocked() {
        return true;
    }

    @Override
    public boolean isCredentialsNonExpired() {
        return true;
    }

    @Override
    public boolean isEnabled() {
        return true;
    }
}</pre>
            <h3 class="subsection-title">Code Example: SecurityConfig (DaoAuthenticationProvider)</h3>
            <pre class="code-block">package com.co.config;

import org.springframework.context.annotation.<span class="highlight">Bean</span>;
import org.springframework.context.annotation.<span class="highlight">Configuration</span>;
import org.springframework.security.authentication.<span class="highlight">AuthenticationProvider</span>;
import org.springframework.security.authentication.dao.<span class="highlight">DaoAuthenticationProvider</span>;
import org.springframework.security.config.annotation.web.configuration.<span class="highlight">EnableWebSecurity</span>;
import org.springframework.security.core.userdetails.<span class="highlight">UserDetailsService</span>;
import org.springframework.security.web.<span class="highlight">SecurityFilterChain</span>;

@Configuration
@EnableWebSecurity
public class SecurityConfig {

    // Configures DaoAuthenticationProvider with custom UserDetailsService
    @Bean
    public AuthenticationProvider authProvider(UserDetailsService userDetailsService) {
        DaoAuthenticationProvider provider = new DaoAuthenticationProvider();
        provider.setUserDetailsService(userDetailsService); // Sets custom UserDetailsService
        provider.setPasswordEncoder(<span class="highlight">NoOpPasswordEncoder</span>.getInstance()); // Uses NoOpPasswordEncoder (insecure)
        return provider;
    }

    @Bean
    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {
        http
                .csrf(csrf -> csrf.<span class="highlight">disable()</span>)
                .authorizeHttpRequests(auth -> auth.anyRequest().authenticated())
                .httpBasic(withDefaults())
                .sessionManagement(session -> session.sessionCreationPolicy(SessionCreationPolicy.<span class="highlight">STATELESS</span>));
        return http.build();
    }
}</pre>
            <h3 class="subsection-title">Explanation</h3>
            <p class="content-line"><span class="highlight">User</span>: Entity mapping to the users table with id, username, and password.</p>
            <p class="content-line"><span class="highlight">UserRepo</span>: Extends JpaRepository to query users by username.</p>
            <p class="content-line"><span class="highlight">MyUserDetailsService</span>: Implements UserDetailsService, fetching users via UserRepo and returning UserPrincipal.</p>
            <p class="content-line"><span class="highlight">UserPrincipal</span>: Implements UserDetails, wrapping the User entity and providing authentication details.</p>
            <p class="content-line"><span class="highlight">DaoAuthenticationProvider</span>: Uses MyUserDetailsService and NoOpPasswordEncoder for authentication (insecure).</p>
            <h3 class="subsection-title">Live Example</h3>
            <p class="content-line">With database users <span class="highlight">naveen</span> (password: n@789) and <span class="highlight">hirsch</span> (password: h@123), a GET to localhost:8080/hello with these credentials in Postman succeeds, showing “Hello World”. Invalid users return a <span class="highlight">401 error</span>, demonstrating <span class="highlight">database-driven authentication</span>.</p>
        </div>

        <div class="section" id="section-16">
            <h2 class="section-title">16. User Registration and Bcrypt Encoding</h2>
            <h3 class="subsection-title">Concept Overview</h3>
            <p class="content-line"><span class="highlight">User registration</span> is like letting new people sign up for your app, similar to creating an account on a website. To keep passwords safe, <span class="highlight">Spring Security</span> uses <span class="highlight">Bcrypt</span>, a hashing algorithm that’s like locking passwords in a safe. <span class="highlight">Bcrypt</span> “hashes” passwords by scrambling them with multiple rounds (e.g., 2^12), making brute-force attacks slow. It adds a random “salt” to each password, ensuring unique hashes even for identical passwords. For beginners, <span class="highlight">Bcrypt</span> is a one-way shredder—only the right key can verify the password. Intermediate learners should ensure consistent <span class="highlight">Bcrypt</span> strength across registration and authentication.</p>
            <h3 class="subsection-title">Code Example: UserService</h3>
            <pre class="code-block">package com.co.service;

import com.co.dao.UserRepo;
import com.co.model.User;
import org.springframework.beans.factory.annotation.<span class="highlight">Autowired</span>;
import org.springframework.security.crypto.bcrypt.<span class="highlight">BCryptPasswordEncoder</span>;
import org.springframework.stereotype.<span class="highlight">Service</span>;

@Service
public class UserService {

    @Autowired
    private UserRepo userRepo; // Repository to save users

    // Saves a user with Bcrypt-encoded password
    public User saveUser(User user) {
        BCryptPasswordEncoder encoder = new BCryptPasswordEncoder(12); // 2^12 rounds
        String encodedPassword = encoder.<span class="highlight">encode</span>(user.getPassword()); // Encodes password
        System.out.println(encodedPassword); // Debug output (not for production)
        user.setPassword(encodedPassword); // Sets encoded password
        return userRepo.save(user); // Saves user to database
    }
}</pre>
            <h3 class="subsection-title">Code Example: UserController</h3>
            <pre class="code-block">package com.co.controllers;

import com.co.model.User;
import com.co.service.UserService;
import org.springframework.beans.factory.annotation.<span class="highlight">Autowired</span>;
import org.springframework.web.bind.annotation.<span class="highlight">PostMapping</span>;
import org.springframework.web.bind.annotation.<span class="highlight">RequestBody</span>;
import org.springframework.web.bind.annotation.<span class="highlight">RestController</span>;

@RestController
public class UserController {

    @Autowired
    private UserService userService; // Service to handle user registration

    // Maps POST request to /register, saves a new user
    @PostMapping("/register")
    public User saveUser(@RequestBody User user) {
        return userService.saveUser(user);
    }
}</pre>
            <h3 class="subsection-title">Code Example: SecurityConfig (Bcrypt)</h3>
            <pre class="code-block">package com.co.config;

import org.springframework.context.annotation.<span class="highlight">Bean</span>;
import org.springframework.context.annotation.<span class="highlight">Configuration</span>;
import org.springframework.security.authentication.<span class="highlight">AuthenticationProvider</span>;
import org.springframework.security.authentication.dao.<span class="highlight">DaoAuthenticationProvider</span>;
import org.springframework.security.config.annotation.web.configuration.<span class="highlight">EnableWebSecurity</span>;
import org.springframework.security.crypto.bcrypt.<span class="highlight">BCryptPasswordEncoder</span>;
import org.springframework.security.web.<span class="highlight">SecurityFilterChain</span>;

@Configuration
@EnableWebSecurity
public class SecurityConfig {

    // Configures DaoAuthenticationProvider with Bcrypt
    @Bean
    public AuthenticationProvider authProvider(UserDetailsService userDetailsService) {
        DaoAuthenticationProvider provider = new DaoAuthenticationProvider();
        provider.setUserDetailsService(userDetailsService);
        provider.setPasswordEncoder(new BCryptPasswordEncoder(12)); // Uses Bcrypt with 2^12 rounds
        return provider;
    }

    @Bean
    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {
        http
                .csrf(csrf -> csrf.<span class="highlight">disable()</span>)
                .authorizeHttpRequests(auth -> auth.anyRequest().authenticated())
                .httpBasic(withDefaults())
                .sessionManagement(session -> session.sessionCreationPolicy(SessionCreationPolicy.<span class="highlight">STATELESS</span>));
        return http.build();
    }
}</pre>
            <h3 class="subsection-title">Explanation</h3>
            <p class="content-line"><span class="highlight">UserService</span>: Encodes passwords with <span class="highlight">BCryptPasswordEncoder</span> before saving users.</p>
            <p class="content-line"><span class="highlight">UserController</span>: Handles /register POST requests, delegating to UserService.</p>
            <p class="content-line"><span class="highlight">BCryptPasswordEncoder</span>: Hashes passwords with 12 rounds for security.</p>
            <p class="content-line"><span class="highlight">DaoAuthenticationProvider</span>: Uses Bcrypt for authentication, replacing NoOpPasswordEncoder.</p>
            <h3 class="subsection-title">Live Example</h3>
            <p class="content-line">In Postman, a POST to /<span class="highlight">register</span> with user <span class="highlight">avni</span> (password: a@123) succeeds, storing the <span class="highlight">Bcrypt</span>-encoded password in the database. Authenticating with <span class="highlight">avni</span> and a@123 at /hello works, while plain-text password users fail due to <span class="highlight">Bcrypt</span> verification.</p>
        </div>

        <div class="section" id="section-17">
            <h2 class="section-title">17. Best Practices and Future Enhancements</h2>
            <h3 class="subsection-title">Concept Overview</h3>
            <p class="content-line">The project demonstrates a secure <span class="highlight">authentication</span> system with <span class="highlight">Bcrypt</span>, but production apps need further enhancements. Beginners should focus on secure basics; intermediate learners should implement advanced features like <span class="highlight">role management</span> and <span class="highlight">HTTPS</span>. Best practices ensure scalability, security, and compliance with standards like <span class="highlight">OWASP</span>.</p>
            <h3 class="subsection-title">Best Practices</h3>
            <p class="content-line">Use <span class="highlight">HTTPS</span>: Secure data transmission to protect credentials.</p>
            <p class="content-line"><span class="highlight">Dynamic Roles</span>: Store roles in the database and retrieve them in UserPrincipal.</p>
            <p class="content-line"><span class="highlight">Account Status</span>: Implement checks for expiration, locking, and enabling in UserPrincipal.</p>
            <p class="content-line">Consistent Bcrypt: Use the same strength (e.g., 12 rounds) for registration and authentication.</p>
            <p class="content-line">Multi-Factor Authentication: Add MFA for stronger security.</p>
            <p class="content-line">Logging and Monitoring: Enable logging to detect and respond to attacks.</p>
            <p class="content-line">Regular Updates: Keep dependencies updated to avoid vulnerable components.</p>
            <h3 class="subsection-title">Future Enhancements</h3>
            <p class="content-line">Add role-based access control (e.g., ROLE_ADMIN for /admin endpoints).</p>
            <p class="content-line">Implement password reset functionality with secure token generation.</p>
            <p class="content-line">Use OAuth2 or JWT for stateless authentication in microservices.</p>
            <p class="content-line">Add rate limiting to prevent brute-force attacks.</p>
            <h3 class="subsection-title">Live Example</h3>
            <p class="content-line">Manually updating the database with Bcrypt-encoded passwords for existing users (e.g., naveen) ensures compatibility with the new authentication setup, highlighting the importance of consistent encoding.</p>
        </div>

        <div class="section" id="references">
            <h2 class="section-title">References</h2>
            <p class="content-line">Telusko YouTube Channel: Detailed Spring Security tutorials (<a href="https://www.youtube.com/@Telusko">https://www.youtube.com/@Telusko</a>).</p>
            <p class="content-line">GitHub Repository: Code snippets sourced from <a href="https://github.com/navinreddy20/spring6-course">https://github.com/navinreddy20/spring6-course</a>.</p>
            <p class="content-line">OWASP Top 10: <a href="https://owasp.org/www-project-top-ten/">https://owasp.org/www-project-top-ten/</a>.</p>
        </div>
    </div>

    <script>
        function changeBackground() {
            const select = document.getElementById('bg-select');
            const body = document.body;
            body.className = select.value;
        }
    </script>
</body>
</html>