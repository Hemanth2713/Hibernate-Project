<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spring AI with Spring Boot and Ollama</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f1f1f1;
            line-height: 1.6;
            transition: background-color 0.3s, color 0.3s;
        }
        .white-bg { background-color: #ffffff; color: #333; }
        .grey-bg { background-color: #e0e0e0; color: #333; }
        .black-bg { background-color: #1a1a1a; color: #ffffff; }
        .bg-switcher {
            position: fixed;
            top: 10px;
            right: 10px;
            z-index: 1000;
            font-size: 16px;
        }
        .bg-switcher label { 
            margin-right: 10px; 
            color: inherit;
        }
        .bg-switcher select {
            padding: 5px;
            border-radius: 5px;
            background-color: #04AA6D;
            color: white;
            border: none;
            cursor: pointer;
        }
        .bg-switcher select:focus {
            outline: 2px solid #059862;
        }
        .sidebar {
            width: 250px;
            background-color: #04AA6D;
            position: fixed;
            top: 0;
            left: 0;
            height: 100%;
            padding-top: 20px;
            color: white;
            overflow-y: auto;
        }
        .sidebar-title {
            font-size: 24px;
            text-align: center;
            margin-bottom: 30px;
        }
        .sidebar-link {
            display: block;
            padding: 12px 20px;
            color: white;
            text-decoration: none;
            font-size: 18px;
            transition: background-color 0.3s;
        }
        .sidebar-link:hover { background-color: #059862; }
        .sidebar-link:focus {
            outline: 2px solid white;
        }
        .main-content { 
            margin-left: 270px; 
            padding: 30px; 
        }
        .header {
            background-color: #282A35;
            color: white;
            padding: 20px;
            text-align: center;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .header-title { font-size: 36px; margin: 0; }
        .header-subtitle { font-size: 18px; margin-top: 10px; }
        .section {
            margin: 20px 0;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .white-bg .section { background-color: #f9f9f9; }
        .grey-bg .section { background-color: #d0d0d0; }
        .black-bg .section { background-color: #2a2a2a; }
        .section-title { font-size: 28px; color: #04AA6D; margin-bottom: 15px; }
        .subsection-title { font-size: 22px; margin: 15px 0 10px; color: inherit; }
    table {
  width: 100%;
  border-collapse: collapse;
  margin-bottom: 20px;
  background-color: #000000 !important;
  color: #ffffff !important;
  border: 1px solid #444444;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
}

th, td {
  padding: 12px 15px;
  text-align: left;
  border-bottom: 1px solid #555555;
}

th {
  background-color: #111111 !important;
  color: #00ffcc !important;
  font-weight: bold;
}

tr:nth-child(even) {
  background-color: #1a1a1a !important;
}

tr:hover {
  background-color: #333333 !important;
}

        .content-line.black-highlight {
            border-left: 4px solid #000000;
        }
        .white-bg .content-line { background-color: #f0f0f0; }
        .grey-bg .content-line { background-color: #c0c0c0; }
        .black-bg .content-line { background-color: #333333; }
        .code-block {
  background-color: #000000 !important;
  color: #ffffff !important;

            padding: 15px;
            border-radius: 5px;
            font-family: 'Courier New', Courier, monospace;
            font-size: 16px;
            overflow-x: auto;
            margin: 10px 0;
        }
        .white-bg .code-block {
  background-color: #000000 !important;
  color: #ffffff !important;
 background-color: #282A35; color: white; }
        .grey-bg .code-block {
  background-color: #000000 !important;
  color: #ffffff !important;
 background-color: #3a3a3a; color: white; }
        .black-bg .code-block {
  background-color: #000000 !important;
  color: #ffffff !important;
 background-color: #ffffff; color: #333; }
        .code-block::-webkit-scrollbar {
            height: 8px;
        }
        .code-block::-webkit-scrollbar-thumb {
            background-color: #04AA6D;
            border-radius: 4px;
        }
        .code-block::-webkit-scrollbar-track {
            background-color: #f1f1f1;
        }
        /* Syntax highlighting styles */
        .keyword-highlight { color: #FFA500; font-size: 16px; } /* Orange for keywords */
        .string-highlight { color: #00FF00; } /* Green for strings */
        .comment-highlight { color: #808080; } /* Grey for comments */
        .class-highlight { color: #00CED1; } /* Cyan for class names */
        .annotation-highlight {
  background-color: rgba(199, 21, 133, 0.15) !important;
  color: #C71585;
 color: #C71585; } /* Purple for annotations */
        .highlight { color: #FF4500; font-weight: bold; }
        strong { font-weight: bold; }
        .code-heading {
            color: #000000;
            font-weight: bold;
            font-size: 16px;
        }
        a { color: #04AA6D; text-decoration: none; }
        a:hover { text-decoration: underline; }
        ul, ol { margin: 10px 0; padding-left: 20px; }
        li { margin: 5px 0; }
        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
                height: auto;
                position: relative;
            }
            .main-content {
                margin-left: 0;
            }
        }
    </style>
</head>
<body class="white-bg">
    <div class="bg-switcher">
        <label for="bg-select">Background:</label>
        <select id="bg-select" onchange="switchBackground()">
            <option value="white-bg">White</option>
            <option value="grey-bg">Grey</option>
            <option value="black-bg">Black</option>
        </select>
    </div>

    <div class="sidebar">
        <div class="sidebar-title">Spring AI Guide</div>
        <a href="#introduction" class="sidebar-link">1. Introduction to Spring AI</a>
        <a href="#why-spring-ai" class="sidebar-link">2. Why Use Spring AI?</a>
        <a href="#documentation" class="sidebar-link">3. Spring AI Documentation</a>
        <a href="#create-project" class="sidebar-link">4. Creating a Spring AI Project</a>
        <a href="#openai-key" class="sidebar-link">5. Creating an OpenAI API Key</a>
        <a href="#openai-questions" class="sidebar-link">6. Asking Questions to OpenAI</a>
        <a href="#chatclient" class="sidebar-link">7. Working with ChatClient</a>
        <a href="#chatresponse" class="sidebar-link">8. ChatResponse and Metadata</a>
        <a href="#chatclient-builder" class="sidebar-link">9. ChatClient Builder</a>
        <a href="#memory-advisor" class="sidebar-link">10. Spring AI Memory Advisor</a>
        <a href="#ollama-local" class="sidebar-link">11. Running Models with Ollama</a>
        <a href="#ollama-spring-ai" class="sidebar-link">12. Spring AI with Ollama</a>
        <a href="#tips" class="sidebar-link">13. Tips for Learners</a>
        <a href="#issues" class="sidebar-link">14. Common Issues and Fixes</a>
        <a href="#outputs" class="sidebar-link">15. Outputs Summary</a>
        <a href="#visual-aids" class="sidebar-link">16. Visual Aids Summary</a>
    </div>

    <div class="main-content">
        <div class="header">
            <h1 class="header-title">Spring AI with Spring Boot and Ollama</h1>
            <p class="header-subtitle">Notes for Beginners and Intermediate Learners</p>
        </div>

        <div class="section" id="introduction">
            <h2 class="section-title">1. Introduction to Spring AI</h2>
            <p class="content-line">These notes simplify the concepts of integrating Spring AI with Spring Boot and Ollama for building AI-powered applications.</p>
            <p class="content-line">They are designed for beginners and intermediate learners, with clear explanations, code snippets from the provided GitHub repository, inline comments, outputs, and images for better understanding.</p>
            <p class="content-line">The content is based on the provided document and the GitHub repository: <a href="https://github.com/navinreddy20/SpringAIUdemy">SpringAIUdemy</a>.</p>
            
            <h3 class="subsection-title">What is Spring AI?</h3>
            <ul>
                <li class="content-line">Spring AI is a Java-based framework that simplifies adding AI features (like chatbots, text generation, or image creation) to Spring Boot applications.</li>
                <li class="content-line">It acts as a middle layer to connect your app with large language models (LLMs) like OpenAI, Anthropic, or Ollama, without needing complex integrations.</li>
                <li class="content-line">Use cases: Chatbots, automated product descriptions, content moderation, and more.</li>
            </ul>

            <h3 class="subsection-title">Why Spring AI?</h3>
            <ul>
                <li class="content-line">Avoids the hassle of mixing Java (Spring Boot) with Python-based AI tools.</li>
                <li class="content-line">Provides a unified way to work with multiple AI providers (e.g., OpenAI, Ollama) using one codebase.</li>
                <li class="content-line">Makes your code flexible, so switching AI providers doesn’t require major changes.</li>
            </ul>

            <h3 class="subsection-title">Key Features</h3>
            <ul>
                <li class="content-line">Supports chat completion, text embedding, text-to-image, audio transcription, and more.</li>
                <li class="content-line">Runs AI models locally (via Ollama) or connects to cloud-based services (e.g., OpenAI).</li>
            </ul>
        </div>

        <div class="section" id="why-spring-ai">
            <h2 class="section-title">2. Why Use Spring AI?</h2>
            <ul>
                <li class="content-line"><strong>Problem with Direct Integration</strong>: Connecting directly to an AI provider (e.g., OpenAI) using their SDK locks you into their system. Switching to another provider (e.g., Anthropic) requires rewriting code.</li>
                <li class="content-line"><strong>Spring AI Solution</strong>: Offers an abstraction layer, so your code works with any supported AI model (OpenAI, Ollama, etc.) without changes.</li>
                <li class="content-line"><strong>Benefits</strong>:</li>
                <ul>
                    <li class="content-line">Cleaner, reusable code.</li>
                    <li class="content-line">Easy to scale and maintain.</li>
                    <li class="content-line">Supports local models (Ollama) for cost savings and privacy.</li>
                </ul>
            </ul>
        </div>

        <div class="section" id="documentation">
            <h2 class="section-title">3. Spring AI Documentation</h2>
            <ul>
                <li class="content-line"><strong>Where to Find</strong>: Visit <a href="https://spring.io/projects/spring-ai">spring.io/projects/spring-ai</a> and check the “Learn” section.</li>
                <li class="content-line"><strong>Status</strong>: Currently in SNAPSHOT (pre-release), with a stable version coming soon.</li>
                <li class="content-line"><strong>What It Covers</strong>:</li>
                <ul>
                    <li class="content-line">How to use chat models, Retrieval-Augmented Generation (RAG), and advisors.</li>
                    <li class="content-line">Supported providers: OpenAI, Anthropic, Ollama, and more.</li>
                    <li class="content-line">Regularly updated with new features.</li>
                </ul>
                <li class="content-line"><strong>Tip for Beginners</strong>: Start with the “Getting Started” guide for simple examples.</li>
            </ul>
        </div>

        <div class="section" id="create-project">
            <h2 class="section-title">4. Creating a Spring AI Project</h2>
            <h3 class="subsection-title">Steps to Set Up</h3>
            <ol>
                <li class="content-line">Go to <a href="https://start.spring.io">start.spring.io</a>.</li>
                <li class="content-line">Choose:</li>
                <ul>
                    <li class="content-line"><strong>Project</strong>: Maven</li>
                    <li class="content-line"><strong>Language</strong>: Java</li>
                    <li class="content-line"><strong>Group ID</strong>: com.telusko (example)</li>
                    <li class="content-line"><strong>Artifact ID</strong>: SpringAICode</li>
                    <li class="content-line"><strong>Dependencies</strong>: Spring Web, Spring AI OpenAI (or Ollama for local models)</li>
                </ul>
                <li class="content-line">Generate and download the project.</li>
                <li class="content-line">Open in an IDE (e.g., IntelliJ).</li>
                <li class="content-line">Check the <code>pom.xml</code> for dependencies.</li>
            </ol>

            <h3 class="subsection-title">Code Example: <span class="code-heading">pom.xml</span></h3>
            <pre class="code-block">
<span class="keyword-highlight">&lt;?xml</span> version=<span class="string-highlight">"1.0"</span> encoding=<span class="string-highlight">"UTF-8"</span><span class="keyword-highlight">?&gt;</span>
<span class="keyword-highlight">&lt;project</span> xmlns=<span class="string-highlight">"http://maven.apache.org/POM/4.0.0"</span> xmlns:xsi=<span class="string-highlight">"http://www.w3.org/2001/XMLSchema-instance"</span>
    xsi:schemaLocation=<span class="string-highlight">"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd"</span><span class="keyword-highlight">&gt;</span>
    <span class="keyword-highlight">&lt;modelVersion&gt;</span>4.0.0<span class="keyword-highlight">&lt;/modelVersion&gt;</span>
    <span class="keyword-highlight">&lt;parent&gt;</span>
        <span class="keyword-highlight">&lt;groupId&gt;</span>org.springframework.boot<span class="keyword-highlight">&lt;/groupId&gt;</span>
        <span class="keyword-highlight">&lt;artifactId&gt;</span>spring-boot-starter-parent<span class="keyword-highlight">&lt;/artifactId&gt;</span>
        <span class="keyword-highlight">&lt;version&gt;</span>3.3.4<span class="keyword-highlight">&lt;/version&gt;</span>
        <span class="keyword-highlight">&lt;relativePath/&gt;</span>
    <span class="keyword-highlight">&lt;/parent&gt;</span>
    <span class="keyword-highlight">&lt;groupId&gt;</span>com.telusko<span class="keyword-highlight">&lt;/groupId&gt;</span>
    <span class="keyword-highlight">&lt;artifactId&gt;</span>SpringAICode<span class="keyword-highlight">&lt;/artifactId&gt;</span>
    <span class="keyword-highlight">&lt;version&gt;</span>0.0.1-SNAPSHOT<span class="keyword-highlight">&lt;/version&gt;</span>
    <span class="keyword-highlight">&lt;name&gt;</span>SpringAICode<span class="keyword-highlight">&lt;/name&gt;</span>
    <span class="keyword-highlight">&lt;description&gt;</span>Spring AI Code<span class="keyword-highlight">&lt;/description&gt;</span>
    <span class="keyword-highlight">&lt;properties&gt;</span>
        <span class="keyword-highlight">&lt;java.version&gt;</span>17<span class="keyword-highlight">&lt;/java.version&gt;</span>
        <span class="keyword-highlight">&lt;spring-ai.version&gt;</span>1.0.0-SNAPSHOT<span class="keyword-highlight">&lt;/spring-ai.version&gt;</span>
    <span class="keyword-highlight">&lt;/properties&gt;</span>
    <span class="keyword-highlight">&lt;dependencies&gt;</span>
        <span class="comment-highlight">&lt;!-- Spring Web for REST APIs --&gt;</span>
        <span class="keyword-highlight">&lt;dependency&gt;</span>
            <span class="keyword-highlight">&lt;groupId&gt;</span>org.springframework.boot<span class="keyword-highlight">&lt;/groupId&gt;</span>
            <span class="keyword-highlight">&lt;artifactId&gt;</span>spring-boot-starter-web<span class="keyword-highlight">&lt;/artifactId&gt;</span>
        <span class="keyword-highlight">&lt;/dependency&gt;</span>
        <span class="comment-highlight">&lt;!-- Spring AI OpenAI for cloud-based AI --&gt;</span>
        <span class="keyword-highlight">&lt;dependency&gt;</span>
            <span class="keyword-highlight">&lt;groupId&gt;</span>org.springframework.ai<span class="keyword-highlight">&lt;/groupId&gt;</span>
            <span class="keyword-highlight">&lt;artifactId&gt;</span>spring-ai-openai-spring-boot-starter<span class="keyword-highlight">&lt;/artifactId&gt;</span>
        <span class="keyword-highlight">&lt;/dependency&gt;</span>
        <span class="comment-highlight">&lt;!-- Spring AI Ollama for local models --&gt;</span>
        <span class="keyword-highlight">&lt;dependency&gt;</span>
            <span class="keyword-highlight">&lt;groupId&gt;</span>org.springframework.ai<span class="keyword-highlight">&lt;/groupId&gt;</span>
            <span class="keyword-highlight">&lt;artifactId&gt;</span>spring-ai-ollama-spring-boot-starter<span class="keyword-highlight">&lt;/artifactId&gt;</span>
        <span class="keyword-highlight">&lt;/dependency&gt;</span>
        <span class="comment-highlight">&lt;!-- Test dependency --&gt;</span>
        <span class="keyword-highlight">&lt;dependency&gt;</span>
            <span class="keyword-highlight">&lt;groupId&gt;</span>org.springframework.boot<span class="keyword-highlight">&lt;/groupId&gt;</span>
            <span class="keyword-highlight">&lt;artifactId&gt;</span>spring-boot-starter-test<span class="keyword-highlight">&lt;/artifactId&gt;</span>
            <span class="keyword-highlight">&lt;scope&gt;</span>test<span class="keyword-highlight">&lt;/scope&gt;</span>
        <span class="keyword-highlight">&lt;/dependency&gt;</span>
    <span class="keyword-highlight">&lt;/dependencies&gt;</span>
    <span class="keyword-highlight">&lt;dependencyManagement&gt;</span>
        <span class="keyword-highlight">&lt;dependencies&gt;</span>
            <span class="keyword-highlight">&lt;dependency&gt;</span>
                <span class="keyword-highlight">&lt;groupId&gt;</span>org.springframework.ai<span class="keyword-highlight">&lt;/groupId&gt;</span>
                <span class="keyword-highlight">&lt;artifactId&gt;</span>spring-ai-bom<span class="keyword-highlight">&lt;/artifactId&gt;</span>
                <span class="keyword-highlight">&lt;version&gt;</span>${spring-ai.version}<span class="keyword-highlight">&lt;/version&gt;</span>
                <span class="keyword-highlight">&lt;type&gt;</span>pom<span class="keyword-highlight">&lt;/type&gt;</span>
                <span class="keyword-highlight">&lt;scope&gt;</span>import<span class="keyword-highlight">&lt;/scope&gt;</span>
            <span class="keyword-highlight">&lt;/dependency&gt;</span>
        <span class="keyword-highlight">&lt;/dependencies&gt;</span>
    <span class="keyword-highlight">&lt;/dependencyManagement&gt;</span>
    <span class="keyword-highlight">&lt;repositories&gt;</span>
        <span class="keyword-highlight">&lt;repository&gt;</span>
            <span class="keyword-highlight">&lt;id&gt;</span>spring-snapshots<span class="keyword-highlight">&lt;/id&gt;</span>
            <span class="keyword-highlight">&lt;name&gt;</span>Spring Snapshots<span class="keyword-highlight">&lt;/name&gt;</span>
            <span class="keyword-highlight">&lt;url&gt;</span>https://repo.spring.io/snapshot<span class="keyword-highlight">&lt;/url&gt;</span>
            <span class="keyword-highlight">&lt;snapshots&gt;</span>
                <span class="keyword-highlight">&lt;enabled&gt;</span>true<span class="keyword-highlight">&lt;/enabled&gt;</span>
            <span class="keyword-highlight">&lt;/snapshots&gt;</span>
        <span class="keyword-highlight">&lt;/repository&gt;</span>
    <span class="keyword-highlight">&lt;/repositories&gt;</span>
    <span class="keyword-highlight">&lt;build&gt;</span>
        <span class="keyword-highlight">&lt;plugins&gt;</span>
            <span class="keyword-highlight">&lt;plugin&gt;</span>
                <span class="keyword-highlight">&lt;groupId&gt;</span>org.springframework.boot<span class="keyword-highlight">&lt;/groupId&gt;</span>
                <span class="keyword-highlight">&lt;artifactId&gt;</span>spring-boot-maven-plugin<span class="keyword-highlight">&lt;/artifactId&gt;</span>
            <span class="keyword-highlight">&lt;/plugin&gt;</span>
        <span class="keyword-highlight">&lt;/plugins&gt;</span>
    <span class="keyword-highlight">&lt;/build&gt;</span>
<span class="keyword-highlight">&lt;/project&gt;</span>
            </pre>
            <p class="content-line"><strong>Explanation</strong>:</p>
            <ul>
                <li class="content-line"><code>spring-boot-starter-web</code>: Enables REST API creation.</li>
                <li class="content-line"><code>spring-ai-openai-spring-boot-starter</code>: Connects to OpenAI’s cloud service.</li>
                <li class="content-line"><code>spring-ai-ollama-spring-boot-starter</code>: Supports local LLMs via Ollama.</li>
                <li class="content-line"><code>spring-ai-bom</code>: Manages Spring AI dependency versions.</li>
                <li class="content-line">Snapshot repository: Required since Spring AI is in pre-release.</li>
            </ul>

            <p class="content-line"><strong>Output</strong>:</p>
            <p class="content-line">The project builds successfully but fails to run without an OpenAI API key (explained next).</p>

            <p class="content-line"><strong>Image</strong>:</p>
            <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABYSURBVGhD7cEBDQAAAMKg909tDjtwgIEBBmAgtr91dQECBARQIAFCBBAgQIAACRQgQIAACRQgQIAACRQgQIAACRQgQIAACRQgQIAACRQgQIAACRQgQIAAAW4B1QfUjZ7zAAAAAElFTkSuQmCC" alt="Spring Initializr Setup" style="max-width: 100%;">
            <p class="content-line"><em>Caption</em>: Setting up a Spring AI project with Spring Web and Ollama dependencies on Spring Initializr.</p>
        </div>

        <div class="section" id="openai-key">
            <h2 class="section-title">5. Creating an OpenAI API Key</h2>
            <h3 class="subsection-title">Steps</h3>
            <ol>
                <li class="content-line">Visit <a href="https://openai.com">openai.com</a> and log in.</li>
                <li class="content-line">Go to the API platform > Settings > Billing.</li>
                <li class="content-line">Add funds (OpenAI charges per token; start with the minimum).</li>
                <li class="content-line">Disable auto-recharge to control costs.</li>
                <li class="content-line">In “API Keys,” create a new key (e.g., “SpringAI-Demo”).</li>
                <li class="content-line">Copy the key (it’s shown only once) and store it securely.</li>
                <li class="content-line">Add it to <code>application.properties</code>.</li>
            </ol>

            <h3 class="subsection-title">Code Example: <span class="code-heading">application.properties</span></h3>
            <pre class="code-block">
<span class="comment-highlight"># OpenAI API key for authentication</span>
spring.ai.openai.api-key=<span class="string-highlight">your-openai-api-key</span>
            </pre>
            <p class="content-line"><strong>Explanation</strong>:</p>
            <ul>
                <li class="content-line">The <code>spring.ai.openai.api-key</code> property authenticates requests to OpenAI.</li>
                <li class="content-line">Without this, the app fails with an authentication error.</li>
            </ul>

            <p class="content-line"><strong>Output</strong>:</p>
            <p class="content-line">With the key added, the app starts without errors.</p>

            <p class="content-line"><strong>Image</strong>:</p>
            <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABYSURBVGhD7cEBDQAAAMKg909tDjtwgIEBBmAgtr91dQECBARQIAFCBBAgQIAACRQgQIAACRQgQIAACRQgQIAACRQgQIAACRQgQIAACRQgQIAACRQgQIAAAW4B1QfUjZ7zAAAAAElFTkSuQmCC" alt="OpenAI API Key" style="max-width: 100%;">
            <p class="content-line"><em>Caption</em>: Creating an API key in the OpenAI dashboard.</p>
        </div>

        <div class="section" id="openai-questions">
            <h2 class="section-title">6. Asking Questions to the OpenAI Model</h2>
            <p class="content-line"><strong>Goal</strong>: Create a REST endpoint to send prompts to OpenAI and get responses.</p>

            <h3 class="subsection-title">Steps</h3>
            <ol>
                <li class="content-line">Create a controller to handle HTTP requests.</li>
                <li class="content-line">Use <code>ChatModel</code> to interact with OpenAI.</li>
                <li class="content-line">Test with a tool like Insomnia or Postman.</li>
            </ol>

            <h3 class="subsection-title">Code Example: <span class="code-heading">OpenAIController.java</span></h3>
            <pre class="code-block">
<span class="keyword-highlight">package</span> com.telusko.SpringAICode.controller;

<span class="keyword-highlight">import</span> org.springframework.ai.chat.model.ChatModel;
<span class="keyword-highlight">import</span> org.springframework.http.ResponseEntity;
<span class="keyword-highlight">import</span> org.springframework.web.bind.annotation.GetMapping;
<span class="keyword-highlight">import</span> org.springframework.web.bind.annotation.PathVariable;
<span class="keyword-highlight">import</span> org.springframework.web.bind.annotation.RestController;

<span class="annotation-highlight">@RestController</span>
<span class="keyword-highlight">public class</span> <span class="class-highlight">OpenAIController</span> {

    <span class="keyword-highlight">private final</span> ChatModel chatModel;

    <span class="comment-highlight">// Constructor injection for ChatModel</span>
    <span class="keyword-highlight">public</span> <span class="class-highlight">OpenAIController</span>(ChatModel chatModel) {
        <span class="keyword-highlight">this</span>.chatModel = chatModel;
    }

    <span class="comment-highlight">// GET endpoint to send prompt and get response</span>
    <span class="annotation-highlight">@GetMapping</span>(<span class="string-highlight">"/api/{message}"</span>)
    <span class="keyword-highlight">public</span> ResponseEntity&lt;String&gt; getAnswer(<span class="annotation-highlight">@PathVariable</span> String message) {
        <span class="comment-highlight">// Send prompt to OpenAI and get response</span>
        String response = chatModel.call(message);
        <span class="comment-highlight">// Return response wrapped in HTTP 200</span>
        <span class="keyword-highlight">return</span> ResponseEntity.ok(response);
    }
}
            </pre>
            <p class="content-line"><strong>Explanation</strong>:</p>
            <ul>
                <li class="content-line"><code>@RestController</code>: Marks the class as a REST controller.</li>
                <li class="content-line"><code>ChatModel</code>: Interface for interacting with LLMs (OpenAI in this case).</li>
                <li class="content-line"><code>@GetMapping("/api/{message}")</code>: Captures the prompt from the URL.</li>
                <li class="content-line"><code>chatModel.call(message)</code>: Sends the prompt to OpenAI and returns the response.</li>
                <li class="content-line"><code>ResponseEntity.ok()</code>: Wraps the response in an HTTP 200 status.</li>
            </ul>

            <p class="content-line"><strong>Output</strong>:</p>
            <p class="content-line">Request: <code>GET http://localhost:8080/api/What is Java?</code></p>
            <p class="content-line">Response:</p>
            <pre class="code-block">
Java is a high-level, object-oriented programming language developed by Sun Microsystems (now owned by Oracle) in 1995. It is widely used for building platform-independent applications, ranging from web and mobile apps to enterprise systems and embedded devices. Java's key features include:

- <span class="keyword-highlight">Platform Independence</span>: Java code is compiled into bytecode, which can run on any device with a Java Virtual Machine (JVM), making it <span class="string-highlight">"write once, run anywhere"</span>.
- <span class="keyword-highlight">Object-Oriented</span>: Java emphasizes modularity through classes and objects, supporting concepts like inheritance, polymorphism, and encapsulation.
- <span class="keyword-highlight">Robust and Secure</span>: It includes strong type-checking, exception handling, and security features to build reliable applications.
- <span class="keyword-highlight">Rich Ecosystem</span>: Java has a vast standard library, frameworks (e.g., Spring, Hibernate), and tools for various domains.

Java remains popular for enterprise applications, Android development, and large-scale systems due to its scalability and community support.
            </pre>

            <p class="content-line"><strong>Image</strong>:</p>
            <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABYSURBVGhD7cEBDQAAAMKg909tDjtwgIEBBmAgtr91dQECBARQIAFCBBAgQIAACRQgQIAACRQgQIAACRQgQIAACRQgQIAACRQgQIAACRQgQIAACRQgQIAAAW4B1QfUjZ7zAAAAAElFTkSuQmCC" alt="Insomnia Test" style="max-width: 100%;">
            <p class="content-line"><em>Caption</em>: Testing the OpenAI endpoint with Insomnia, sending “What is Java?” and receiving a response.</p>
        </div>

        <div class="section" id="chatclient">
            <h2 class="section-title">7. Working with ChatClient</h2>
            <h3 class="subsection-title">What is ChatClient?</h3>
            <ul>
                <li class="content-line">A more flexible API built on top of <code>ChatModel</code>.</li>
                <li class="content-line">Allows advanced features like prompt manipulation, metadata access, and streaming responses.</li>
            </ul>

            <h3 class="subsection-title">Steps</h3>
            <ol>
                <li class="content-line">Replace <code>ChatModel</code> with <code>ChatClient</code> in the controller.</li>
                <li class="content-line">Use the fluent API to send prompts.</li>
            </ol>

            <h3 class="subsection-title">Code Example: <span class="code-heading">OpenAIController.java (Updated)</span></h3>
            <pre class="code-block">
<span class="keyword-highlight">package</span> com.telusko.SpringAICode.controller;

<span class="keyword-highlight">import</span> org.springframework.ai.chat.client.ChatClient;
<span class="keyword-highlight">import</span> org.springframework.http.ResponseEntity;
<span class="keyword-highlight">import</span> org.springframework.web.bind.annotation.GetMapping;
<span class="keyword-highlight">import</span> org.springframework.web.bind.annotation.PathVariable;
<span class="keyword-highlight">import</span> org.springframework.web.bind.annotation.RestController;

<span class="annotation-highlight">@RestController</span>
<span class="keyword-highlight">public class</span> <span class="class-highlight">OpenAIController</span> {

    <span class="keyword-highlight">private final</span> ChatClient chatClient;

    <span class="comment-highlight">// Constructor injection for ChatClient</span>
    <span class="keyword-highlight">public</span> <span class="class-highlight">OpenAIController</span>(ChatClient.Builder builder) {
        <span class="keyword-highlight">this</span>.chatClient = builder.build();
    }

    <span class="comment-highlight">// GET endpoint to send prompt and get response</span>
    <span class="annotation-highlight">@GetMapping</span>(<span class="string-highlight">"/api/{message}"</span>)
    <span class="keyword-highlight">public</span> ResponseEntity&lt;String&gt; getAnswer(<span class="annotation-highlight">@PathVariable</span> String message) {
        <span class="comment-highlight">// Send prompt using ChatClient's fluent API</span>
        String response = chatClient.prompt(message).call().content();
        <span class="comment-highlight">// Return response wrapped in HTTP 200</span>
        <span class="keyword-highlight">return</span> ResponseEntity.ok(response);
    }
}
            </pre>
            <p class="content-line"><strong>Explanation</strong>:</p>
            <ul>
                <li class="content-line"><code>ChatClient.Builder</code>: Autoconfigured by Spring Boot to create a <code>ChatClient</code>.</li>
                <li class="content-line"><code>chatClient.prompt(message).call().content()</code>: Sends the prompt and extracts the response text.</li>
                <li class="content-line">More flexible than <code>ChatModel</code> for complex use cases (e.g., streaming or multimodal data).</li>
            </ul>

            <p class="content-line"><strong>Output</strong>:</p>
            <p class="content-line">Request: <code>GET http://localhost:8080/api/Tell me a tech joke</code></p>
            <p class="content-line">Response:</p>
            <pre class="code-block">
<span class="string-highlight">Why did the computer go to art school? Because it wanted to learn how to draw a better "byte"!</span>
            </pre>

            <p class="content-line"><strong>Image</strong>:</p>
            <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABYSURBVGhD7cEBDQAAAMKg909tDjtwgIEBBmAgtr91dQECBARQIAFCBBAgQIAACRQgQIAACRQgQIAACRQgQIAACRQgQIAACRQgQIAACRQgQIAACRQgQIAAAW4B1QfUjZ7zAAAAAElFTkSuQmCC" alt="ChatClient Test" style="max-width: 100%;">
            <p class="content-line"><em>Caption</em>: Using ChatClient to fetch a tech joke via the REST endpoint.</p>
        </div>

        <div class="section" id="chatresponse">
            <h2 class="section-title">8. ChatResponse and Metadata</h2>
            <h3 class="subsection-title">What is ChatResponse?</h3>
            <ul>
                <li class="content-line">A <code>ChatResponse</code> object contains the response text and metadata (e.g., model used, token usage).</li>
                <li class="content-line">Useful for debugging or monitoring API usage.</li>
            </ul>

            <h3 class="subsection-title">Steps</h3>
            <ol>
                <li class="content-line">Update the controller to return <code>ChatResponse</code>.</li>
                <li class="content-line">Extract text and log metadata.</li>
            </ol>

            <h3 class="subsection-title">Code Example: <span class="code-heading">OpenAIController.java (Updated)</span></h3>
            <pre class="code-block">
<span class="keyword-highlight">package</span> com.telusko.SpringAICode.controller;

<span class="keyword-highlight">import</span> org.springframework.ai.chat.client.ChatClient;
<span class="keyword-highlight">import</span> org.springframework.ai.chat.messages.Message;
<span class="keyword-highlight">import</span> org.springframework.ai.chat.model.ChatResponse;
<span class="keyword-highlight">import</span> org.springframework.http.ResponseEntity;
<span class="keyword-highlight">import</span> org.springframework.web.bind.annotation.GetMapping;
<span class="keyword-highlight">import</span> org.springframework.web.bind.annotation.PathVariable;
<span class="keyword-highlight">import</span> org.springframework.web.bind.annotation.RestController;

<span class="keyword-highlight">import</span> java.util.logging.Logger;

<span class="annotation-highlight">@RestController</span>
<span class="keyword-highlight">public class</span> <span class="class-highlight">OpenAIController</span> {

    <span class="keyword-highlight">private static final</span> Logger LOGGER = Logger.getLogger(<span class="class-highlight">OpenAIController</span>.class.getName());
    <span class="keyword-highlight">private final</span> ChatClient chatClient;

    <span class="comment-highlight">// Constructor injection for ChatClient</span>
    <span class="keyword-highlight">public</span> <span class="class-highlight">OpenAIController</span>(ChatClient.Builder builder) {
        <span class="keyword-highlight">this</span>.chatClient = builder.build();
    }

    <span class="comment-highlight">// GET endpoint to send prompt and get response with metadata</span>
    <span class="annotation-highlight">@GetMapping</span>(<span class="string-highlight">"/api/{message}"</span>)
    <span class="keyword-highlight">public</span> ResponseEntity&lt;String&gt; getAnswer(<span class="annotation-highlight">@PathVariable</span> String message) {
        <span class="comment-highlight">// Send prompt and get ChatResponse</span>
        ChatResponse chatResponse = chatClient.prompt(message).call().chatResponse();
        <span class="comment-highlight">// Extract response text</span>
        String responseText = chatResponse.getResult().getOutput().getContent();
        <span class="comment-highlight">// Log metadata</span>
        LOGGER.info(<span class="string-highlight">"Metadata: "</span> + chatResponse.getMetadata().toString());
        <span class="comment-highlight">// Return response wrapped in HTTP 200</span>
        <span class="keyword-highlight">return</span> ResponseEntity.ok(responseText);
    }
}
            </pre>
            <p class="content-line"><strong>Explanation</strong>:</p>
            <ul>
                <li class="content-line"><code>chatClient.prompt(message).call().chatResponse()</code>: Returns a <code>ChatResponse</code> object.</li>
                <li class="content-line"><code>getResult().getOutput().getContent()</code>: Extracts the response text.</li>
                <li class="content-line"><code>getMetadata()</code>: Provides details like model name (e.g., GPT-4o mini) and token usage.</li>
                <li class="content-line"><code>Logger</code>: Logs metadata to the console for debugging.</li>
            </ul>

            <p class="content-line"><strong>Output</strong>:</p>
            <p class="content-line">Request: <code>GET http://localhost:8080/api/What is Spring AI?</code></p>
            <p class="content-line">Response:</p>
            <pre class="code-block">
<span class="string-highlight">Spring AI is a framework that integrates artificial intelligence capabilities into Spring Boot applications. It simplifies the process of connecting to large language models (LLMs) like OpenAI, Anthropic, or Ollama, allowing developers to add features such as chatbots, text generation, and more using familiar Spring abstractions.</span>
            </pre>
            <p class="content-line">Console Log:</p>
            <pre class="code-block">
<span class="string-highlight">Metadata: {model=gpt-4o-mini, usage={promptTokens=10, generationTokens=50, totalTokens=60}}</span>
            </pre>

            <p class="content-line"><strong>Image</strong>:</p>
            <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABYSURBVGhD7cEBDQAAAMKg909tDjtwgIEBBmAgtr91dQECBARQIAFCBBAgQIAACRQgQIAACRQgQIAACRQgQIAACRQgQIAACRQgQIAACRQgQIAACRQgQIAAAW4B1QfUjZ7zAAAAAElFTkSuQmCC" alt="ChatResponse Metadata" style="max-width: 100%;">
            <p class="content-line"><em>Caption</em>: Console output showing metadata (model and token usage) from a ChatResponse.</p>
        </div>

        <div class="section" id="chatclient-builder">
            <h2 class="section-title">9. ChatClient Builder</h2>
            <h3 class="subsection-title">What is ChatClient Builder?</h3>
            <ul>
                <li class="content-line">A Spring Boot autoconfigured tool to create <code>ChatClient</code> instances.</li>
                <li class="content-line">Simplifies setup for single-model applications.</li>
            </ul>

            <h3 class="subsection-title">Steps</h3>
            <ol>
                <li class="content-line">Inject <code>ChatClient.Builder</code> into the controller.</li>
                <li class="content-line">Build <code>ChatClient</code> dynamically.</li>
            </ol>

            <p class="content-line"><strong>Code Example</strong>: Already shown in the <code>OpenAIController.java</code> above (uses <code>ChatClient.Builder</code>).</p>
            <p class="content-line"><strong>Explanation</strong>:</p>
            <ul>
                <li class="content-line"><code>ChatClient.Builder</code>: Automatically detects the model (e.g., OpenAI) if only one is configured.</li>
                <li class="content-line"><code>builder.build()</code>: Creates a <code>ChatClient</code> instance.</li>
                <li class="content-line"><strong>Note</strong>: With multiple models (e.g., OpenAI and Ollama), you may need manual configuration to avoid conflicts.</li>
            </ul>

            <p class="content-line"><strong>Output</strong>: Same as the <code>ChatClient</code> section (tech joke or other prompt responses).</p>
        </div>

        <div class="section" id="memory-advisor">
            <h2 class="section-title">10. Spring AI Memory Advisor</h2>
            <h3 class="subsection-title">Why Memory?</h3>
            <ul>
                <li class="content-line">LLMs are stateless by default (they don’t remember previous messages).</li>
                <li class="content-line">A memory advisor stores conversation history, enabling contextual responses.</li>
            </ul>

            <h3 class="subsection-title">Steps</h3>
            <ol>
                <li class="content-line">Add <code>MessageChatMemoryAdvisor</code> with <code>InMemoryChatMemory</code>.</li>
                <li class="content-line">Configure it in the <code>ChatClient</code> creation.</li>
            </ol>

            <h3 class="subsection-title">Code Example: <span class="code-heading">OpenAIController.java (Updated)</span></h3>
            <pre class="code-block">
<span class="keyword-highlight">package</span> com.telusko.SpringAICode.controller;

<span class="keyword-highlight">import</span> org.springframework.ai.chat.client.ChatClient;
<span class="keyword-highlight">import</span> org.springframework.ai.chat.client.advisor.MessageChatMemoryAdvisor;
<span class="keyword-highlight">import</span> org.springframework.ai.chat.memory.InMemoryChatMemory;
<span class="keyword-highlight">import</span> org.springframework.http.ResponseEntity;
<span class="keyword-highlight">import</span> org.springframework.web.bind.annotation.GetMapping;
<span class="keyword-highlight">import</span> org.springframework.web.bind.annotation.PathVariable;
<span class="keyword-highlight">import</span> org.springframework.web.bind.annotation.RestController;

<span class="annotation-highlight">@RestController</span>
<span class="keyword-highlight">public class</span> <span class="class-highlight">OpenAIController</span> {

    <span class="keyword-highlight">private final</span> ChatClient chatClient;

    <span class="comment-highlight">// Constructor injection with memory advisor</span>
    <span class="keyword-highlight">public</span> <span class="class-highlight">OpenAIController</span>(ChatClient.Builder builder) {
        <span class="keyword-highlight">this</span>.chatClient = builder
                .defaultAdvisors(<span class="keyword-highlight">new</span> MessageChatMemoryAdvisor(<span class="keyword-highlight">new</span> InMemoryChatMemory()))
                .build();
    }

    <span class="comment-highlight">// GET endpoint with conversation memory</span>
    <span class="annotation-highlight">@GetMapping</span>(<span class="string-highlight">"/api/{message}"</span>)
    <span class="keyword-highlight">public</span> ResponseEntity&lt;String&gt; getAnswer(<span class="annotation-highlight">@PathVariable</span> String message) {
        <span class="comment-highlight">// Send prompt and get response with memory</span>
        String response = chatClient.prompt(message).call().content();
        <span class="comment-highlight">// Return response wrapped in HTTP 200</span>
        <span class="keyword-highlight">return</span> ResponseEntity.ok(response);
    }
}
            </pre>
            <p class="content-line"><strong>Explanation</strong>:</p>
            <ul>
                <li class="content-line"><code>MessageChatMemoryAdvisor</code>: Intercepts prompts and responses to store them.</li>
                <li class="content-line"><code>InMemoryChatMemory</code>: Stores conversation history in memory (not persistent).</li>
                <li class="content-line"><code>defaultAdvisors</code>: Adds the advisor to the <code>ChatClient</code> pipeline.</li>
                <li class="content-line">Enables contextual responses (e.g., “more” after a joke refers to the previous joke).</li>
            </ul>

            <p class="content-line"><strong>Output</strong>:</p>
            <p class="content-line">Request 1: <code>GET http://localhost:8080/api/Tell me a tech joke</code></p>
            <p class="content-line">Response:</p>
            <pre class="code-block">
<span class="string-highlight">Why did the programmer prefer dark mode? Because the light attracts bugs.</span>
            </pre>
            <p class="content-line">Request 2: <code>GET http://localhost:8080/api/more</code></p>
            <p class="content-line">Response:</p>
            <pre class="code-block">
<span class="string-highlight">Why did the database go to therapy? It had too many "deep-rooted" issues!</span>
            </pre>

            <p class="content-line"><strong>Image</strong>:</p>
            <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABYSURBVGhD7cEBDQAAAMKg909tDjtwgIEBBmAgtr91dQECBARQIAFCBBAgQIAACRQgQIAACRQgQIAACRQgQIAACRQgQIAACRQgQIAACRQgQIAACRQgQIAAAW4B1QfUjZ7zAAAAAElFTkSuQmCC" alt="Memory Advisor" style="max-width: 100%;">
            <p class="content-line"><em>Caption</em>: Testing conversation memory with “Tell me a tech joke” followed by “more” in Insomnia.</p>
        </div>

        <div class="section" id="ollama-local">
            <h2 class="section-title">11. Running Models Locally with Ollama</h2>
            <h3 class="subsection-title">What is Ollama?</h3>
            <ul>
                <li class="content-line">A tool to run open-source LLMs (e.g., Llama, Mistral, DeepSeek) on your local machine.</li>
                <li class="content-line"><strong>Benefits</strong>:</li>
                <ul>
                    <li class="content-line">Free (no cloud costs).</li>
                    <li class="content-line">Private (data stays on your device).</li>
                    <li class="content-line">Works offline after model download.</li>
                </ul>
            </ul>

            <h3 class="subsection-title">Steps to Set Up</h3>
            <ol>
                <li class="content-line">Download Ollama from <a href="https://ollama.com">ollama.com</a>.</li>
                <li class="content-line">Install it (available for Windows, macOS, Linux).</li>
                <li class="content-line">Verify installation: Run <code>ollama</code> in a terminal.</li>
                <li class="content-line">Download a model: <code>ollama run mistral</code></li>
                <li class="content-line">Test locally: <code>ollama run mistral "What is Spring AI?"</code></li>
            </ol>

            <h3 class="subsection-title">Hardware Requirements</h3>
            <ul>
                <li class="content-line">Small models (e.g., Mistral 7B): 8GB RAM, basic CPU.</li>
                <li class="content-line">Large models (e.g., DeepSeek 32B): 16GB+ RAM, GPU recommended.</li>
            </ul>

            <p class="content-line"><strong>Output</strong>:</p>
            <p class="content-line">Command: <code>ollama run mistral "Tell me a joke"</code></p>
            <p class="content-line">Response:</p>
            <pre class="code-block">
<span class="string-highlight">Why did the computer go to therapy? It had an identity crisis after being asked if it was human one too many times!</span>
            </pre>

            <p class="content-line"><strong>Image</strong>:</p>
            <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABYSURBVGhD7cEBDQAAAMKg909tDjtwgIEBBmAgtr91dQECBARQIAFCBBAgQIAACRQgQIAACRQgQIAACRQgQIAACRQgQIAACRQgQIAACRQgQIAACRQgQIAAAW4B1QfUjZ7zAAAAAElFTkSuQmCC" alt="Ollama Terminal" style="max-width: 100%;">
            <p class="content-line"><em>Caption</em>: Running the Mistral model locally with Ollama and testing a prompt.</p>
        </div>

        <div class="section" id="ollama-spring-ai">
            <h2 class="section-title">12. Spring AI with Ollama</h2>
            <p class="content-line"><strong>Goal</strong>: Integrate Ollama with Spring AI to run local models.</p>

            <h3 class="subsection-title">Steps</h3>
            <ol>
                <li class="content-line">Add the Ollama dependency to <code>pom.xml</code> (already included above).</li>
                <li class="content-line">Configure the model in <code>application.properties</code>.</li>
                <li class="content-line">Create a controller for Ollama.</li>
                <li class="content-line">Comment out OpenAI configurations to avoid conflicts.</li>
            </ol>

            <h3 class="subsection-title">Code Example: <span class="code-heading">application.properties</span></h3>
            <pre class="code-block">
<span class="comment-highlight"># Ollama configuration</span>
spring.ai.ollama.base-url=<span class="string-highlight">http://localhost:11434</span>
spring.ai.ollama.chat.options.model=<span class="string-highlight">mistral</span>
            </pre>
            <p class="content-line"><strong>Explanation</strong>:</p>
            <ul>
                <li class="content-line"><code>base-url</code>: Points to Ollama’s local server (default port 11434).</li>
                <li class="content-line"><code>model</code>: Specifies the model (e.g., Mistral). Must be downloaded via <code>ollama run mistral</code>.</li>
            </ul>

            <h3 class="subsection-title">Code Example: <span class="code-heading">OllamaController.java</span></h3>
            <pre class="code-block">
<span class="keyword-highlight">package</span> com.telusko.SpringAICode.controller;

<span class="keyword-highlight">import</span> org.springframework.ai.chat.model.ChatModel;
<span class="keyword-highlight">import</span> org.springframework.http.ResponseEntity;
<span class="keyword-highlight">import</span> org.springframework.web.bind.annotation.GetMapping;
<span class="keyword-highlight">import</span> org.springframework.web.bind.annotation.PathVariable;
<span class="keyword-highlight">import</span> org.springframework.web.bind.annotation.RestController;

<span class="annotation-highlight">@RestController</span>
<span class="keyword-highlight">public class</span> <span class="class-highlight">OllamaController</span> {

    <span class="keyword-highlight">private final</span> ChatModel chatModel;

    <span class="comment-highlight">// Constructor injection for ChatModel (OllamaChatModel)</span>
    <span class="keyword-highlight">public</span> <span class="class-highlight">OllamaController</span>(ChatModel chatModel) {
        <span class="keyword-highlight">this</span>.chatModel = chatModel;
    }

    <span class="comment-highlight">// GET endpoint to send prompt to Ollama</span>
    <span class="annotation-highlight">@GetMapping</span>(<span class="string-highlight">"/ollama/{message}"</span>)
    <span class="keyword-highlight">public</span> ResponseEntity&lt;String&gt; getAnswer(<span class="annotation-highlight">@PathVariable</span> String message) {
        <span class="comment-highlight">// Send prompt to Ollama and get response</span>
        String response = chatModel.call(message);
        <span class="comment-highlight">// Return response wrapped in HTTP 200</span>
        <span class="keyword-highlight">return</span> ResponseEntity.ok(response);
    }
}
            </pre>
            <p class="content-line"><strong>Explanation</strong>:</p>
            <ul>
                <li class="content-line">Similar to <code>OpenAIController</code>, but uses <code>OllamaChatModel</code>.</li>
                <li class="content-line">No API key is needed since Ollama runs locally.</li>
                <li class="content-line"><code>@GetMapping("/ollama/{message}")</code>: Differentiates from OpenAI endpoint.</li>
            </ul>

            <p class="content-line"><strong>Output</strong>:</p>
            <p class="content-line">Request: <code>GET http://localhost:8080/ollama/Tell me a joke</code></p>
            <p class="content-line">Response:</p>
            <pre class="code-block">
<span class="string-highlight">Why did the scarecrow become a motivational speaker? Because he was outstanding in his field!</span>
            </pre>

            <p class="content-line"><strong>Image</strong>:</p>
            <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABYSURBVGhD7cEBDQAAAMKg909tDjtwgIEBBmAgtr91dQECBARQIAFCBBAgQIAACRQgQIAACRQgQIAACRQgQIAACRQgQIAACRQgQIAACRQgQIAACRQgQIAAAW4B1QfUjZ7zAAAAAElFTkSuQmCC" alt="Ollama Endpoint" style="max-width: 100%;">
            <p class="content-line"><em>Caption</em>: Testing the Ollama endpoint with Insomnia, receiving a joke from the Mistral model.</p>
        </div>

        <div class="section" id="tips">
            <h2 class="section-title">13. Tips for Beginners and Intermediate Learners</h2>
            <ul>
                <li class="content-line"><strong>Start Simple</strong>: Begin with OpenAI to understand the basics, then try Ollama for local models.</li>
                <li class="content-line"><strong>Test with Insomnia/Postman</strong>: Makes it easy to send prompts and see responses.</li>
                <li class="content-line"><strong>Check Hardware for Ollama</strong>: Ensure your machine has enough RAM/GPU for larger models.</li>
                <li class="content-line"><strong>Explore Documentation</strong>: Use the Spring AI docs for advanced features like RAG or function calling.</li>
                <li class="content-line"><strong>Experiment</strong>: Try different models (Mistral, Llama, DeepSeek) to compare performance.</li>
            </ul>
        </div>

        <div class="section" id="issues">
            <h2 class="section-title">14. Common Issues and Fixes</h2>
            <ul>
                <li class="content-line"><strong>OpenAI Error: “Invalid API Key”</strong>:</li>
                <ul>
                    <li class="content-line">Fix: Verify the key in <code>application.properties</code> matches the one from OpenAI.</li>
                </ul>
                <li class="content-line"><strong>Ollama Error: “Model Not Found”</strong>:</li>
                <ul>
                    <li class="content-line">Fix: Run <code>ollama run <model></code> to download the model (e.g., <code>ollama run mistral</code>).</li>
                </ul>
                <li class="content-line"><strong>App Fails to Start with Multiple Models</strong>:</li>
                <ul>
                    <li class="content-line">Fix: Comment out conflicting configurations (e.g., OpenAI when using Ollama).</li>
                </ul>
                <li class="content-line"><strong>Slow Responses with Ollama</strong>:</li>
                <ul>
                    <li class="content-line">Fix: Use a smaller model or upgrade hardware (add RAM or GPU).</li>
                </ul>
            </ul>
        </div>

        <div class="section" id="outputs">
            <h2 class="section-title">15. Outputs Summary</h2>
            <table>
                <tr>
                    <th>Feature</th>
                    <th>Request</th>
                    <th>Response</th>
                </tr>
                <tr>
                    <td>OpenAI ChatModel</td>
                    <td><code>What is Java?</code></td>
                    <td>Detailed explanation of Java as a programming language.</td>
                </tr>
                <tr>
                    <td>ChatClient</td>
                    <td><code>Tell me a tech joke</code></td>
                    <td><code>Why did the computer go to art school? Because it wanted to learn how to draw a better "byte"!</code></td>
                </tr>
                <tr>
                    <td>ChatResponse Metadata</td>
                    <td><code>What is Spring AI?</code></td>
                    <td>Response text + metadata (e.g., model: gpt-4o-mini, tokens used).</td>
                </tr>
                <tr>
                    <td>Memory Advisor</td>
                    <td><code>Tell me a tech joke</code>, then <code>more</code></td>
                    <td>Contextual jokes based on conversation history.</td>
                </tr>
                <tr>
                    <td>Ollama Local Model</td>
                    <td><code>Tell me a joke</code></td>
                    <td><code>Why did the scarecrow become a motivational speaker? ...</code></td>
                </tr>
            </table>
        </div>

        <div class="section" id="visual-aids">
            <h2 class="section-title">16. Visual Aids Summary</h2>
            <table>
                <tr>
                    <th>Image</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td>Spring Initializr Setup</td>
                    <td>Generating a Spring AI project with dependencies.</td>
                </tr>
                <tr>
                    <td>OpenAI API Key</td>
                    <td>Creating an API key in OpenAI’s dashboard.</td>
                </tr>
                <tr>
                    <td>Insomnia Test (OpenAI)</td>
                    <td>Sending a prompt to the OpenAI endpoint and viewing the response.</td>
                </tr>
                <tr>
                    <td>ChatClient Test</td>
                    <td>Testing a tech joke with ChatClient.</td>
                </tr>
                <tr>
                    <td>ChatResponse Metadata</td>
                    <td>Console output showing metadata from a ChatResponse.</td>
                </tr>
                <tr>
                    <td>Memory Advisor</td>
                    <td>Testing conversation memory with sequential prompts.</td>
                </tr>
                <tr>
                    <td>Ollama Terminal</td>
                    <td>Running and testing a model in Ollama via the terminal.</td>
                </tr>
                <tr>
                    <td>Ollama Endpoint</td>
                    <td>Testing the Ollama endpoint with Insomnia.</td>
                </tr>
            </table>
        </div>
    </div>

    <script>
        function switchBackground() {
            const select = document.getElementById('bg-select');
            const body = document.body;
            body.className = select.value;
        }
    </script>
</body>
</html>